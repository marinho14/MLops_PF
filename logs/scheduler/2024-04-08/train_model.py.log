[2024-04-08T01:54:48.660+0000] {processor.py:156} INFO - Started process (PID=49) to work on /opt/airflow/dags/train_model.py
[2024-04-08T01:54:48.664+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T01:54:48.665+0000] {logging_mixin.py:149} INFO - [2024-04-08T01:54:48.665+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T01:55:18.679+0000] {logging_mixin.py:149} INFO - [2024-04-08T01:55:18.673+0000] {timeout.py:68} ERROR - Process timed out, PID: 49
[2024-04-08T01:55:18.692+0000] {logging_mixin.py:149} INFO - [2024-04-08T01:55:18.683+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 49

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 49
[2024-04-08T01:55:18.694+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T01:55:18.725+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.074 seconds
[2024-04-08T01:55:48.969+0000] {processor.py:156} INFO - Started process (PID=87) to work on /opt/airflow/dags/train_model.py
[2024-04-08T01:55:48.971+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T01:55:48.972+0000] {logging_mixin.py:149} INFO - [2024-04-08T01:55:48.972+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T01:56:18.960+0000] {logging_mixin.py:149} INFO - [2024-04-08T01:56:18.954+0000] {timeout.py:68} ERROR - Process timed out, PID: 87
[2024-04-08T01:56:18.992+0000] {logging_mixin.py:149} INFO - [2024-04-08T01:56:18.977+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 87

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 87
[2024-04-08T01:56:18.995+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T01:56:19.034+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.094 seconds
[2024-04-08T01:56:49.420+0000] {processor.py:156} INFO - Started process (PID=119) to work on /opt/airflow/dags/train_model.py
[2024-04-08T01:56:49.422+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T01:56:49.423+0000] {logging_mixin.py:149} INFO - [2024-04-08T01:56:49.423+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T01:57:19.430+0000] {logging_mixin.py:149} INFO - [2024-04-08T01:57:19.429+0000] {timeout.py:68} ERROR - Process timed out, PID: 119
[2024-04-08T01:57:19.436+0000] {logging_mixin.py:149} INFO - [2024-04-08T01:57:19.432+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 119

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 119
[2024-04-08T01:57:19.437+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T01:57:19.454+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.042 seconds
[2024-04-08T01:57:49.657+0000] {processor.py:156} INFO - Started process (PID=151) to work on /opt/airflow/dags/train_model.py
[2024-04-08T01:57:49.659+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T01:57:49.660+0000] {logging_mixin.py:149} INFO - [2024-04-08T01:57:49.660+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T01:58:19.675+0000] {logging_mixin.py:149} INFO - [2024-04-08T01:58:19.670+0000] {timeout.py:68} ERROR - Process timed out, PID: 151
[2024-04-08T01:58:19.689+0000] {logging_mixin.py:149} INFO - [2024-04-08T01:58:19.680+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 151

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 151
[2024-04-08T01:58:19.691+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T01:58:19.729+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.079 seconds
[2024-04-08T01:58:50.285+0000] {processor.py:156} INFO - Started process (PID=183) to work on /opt/airflow/dags/train_model.py
[2024-04-08T01:58:50.287+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T01:58:50.288+0000] {logging_mixin.py:149} INFO - [2024-04-08T01:58:50.288+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T01:59:20.295+0000] {logging_mixin.py:149} INFO - [2024-04-08T01:59:20.292+0000] {timeout.py:68} ERROR - Process timed out, PID: 183
[2024-04-08T01:59:20.304+0000] {logging_mixin.py:149} INFO - [2024-04-08T01:59:20.298+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 183

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 183
[2024-04-08T01:59:20.305+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T01:59:20.332+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.053 seconds
[2024-04-08T01:59:50.515+0000] {processor.py:156} INFO - Started process (PID=215) to work on /opt/airflow/dags/train_model.py
[2024-04-08T01:59:50.517+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T01:59:50.518+0000] {logging_mixin.py:149} INFO - [2024-04-08T01:59:50.518+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:00:20.533+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:00:20.525+0000] {timeout.py:68} ERROR - Process timed out, PID: 215
[2024-04-08T02:00:20.549+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:00:20.539+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 215

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 215
[2024-04-08T02:00:20.552+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:00:20.590+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.080 seconds
[2024-04-08T02:00:50.927+0000] {processor.py:156} INFO - Started process (PID=247) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:00:50.929+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:00:50.930+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:00:50.930+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:01:20.936+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:01:20.933+0000] {timeout.py:68} ERROR - Process timed out, PID: 247
[2024-04-08T02:01:20.947+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:01:20.939+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 247

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 247
[2024-04-08T02:01:20.948+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:01:20.977+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.056 seconds
[2024-04-08T02:01:51.399+0000] {processor.py:156} INFO - Started process (PID=286) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:01:51.401+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:01:51.401+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:01:51.401+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:02:21.415+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:02:21.407+0000] {timeout.py:68} ERROR - Process timed out, PID: 286
[2024-04-08T02:02:21.433+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:02:21.422+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 286

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 286
[2024-04-08T02:02:21.436+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:02:21.474+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.082 seconds
[2024-04-08T02:02:51.624+0000] {processor.py:156} INFO - Started process (PID=318) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:02:51.626+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:02:51.627+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:02:51.627+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:03:21.646+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:03:21.638+0000] {timeout.py:68} ERROR - Process timed out, PID: 318
[2024-04-08T02:03:21.690+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:03:21.655+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 318

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 318
[2024-04-08T02:03:21.702+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:03:21.786+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.168 seconds
[2024-04-08T02:04:40.432+0000] {processor.py:156} INFO - Started process (PID=49) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:04:40.434+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:04:40.436+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:04:40.436+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:04:43.278+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:04:43.278+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff94838210>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:04:47.297+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:04:47.297+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff94838ed0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:04:55.323+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:04:55.321+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff947e4910>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:05:10.445+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:05:10.441+0000] {timeout.py:68} ERROR - Process timed out, PID: 49
[2024-04-08T02:05:10.455+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:05:10.447+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff947e4c90>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 49

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 49
[2024-04-08T02:05:10.456+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:05:10.485+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.058 seconds
[2024-04-08T02:05:40.834+0000] {processor.py:156} INFO - Started process (PID=81) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:05:40.835+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:05:40.836+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:05:40.836+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:05:41.905+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:05:41.905+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff947a3890>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:05:45.932+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:05:45.929+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff94743c10>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:05:53.962+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:05:53.961+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff94743310>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:06:09.998+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:06:09.997+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff9474b350>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:06:10.851+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:06:10.842+0000] {timeout.py:68} ERROR - Process timed out, PID: 81
[2024-04-08T02:06:10.874+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:06:10.854+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff9474b1d0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 81

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 81
[2024-04-08T02:06:10.876+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:06:10.914+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.085 seconds
[2024-04-08T02:06:41.041+0000] {processor.py:156} INFO - Started process (PID=113) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:06:41.043+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:06:41.044+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:06:41.044+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:06:41.932+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:06:41.932+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff95517450>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:06:45.968+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:06:45.968+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff947a3350>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:06:54.014+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:06:54.012+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff947a33d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:07:10.091+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:07:10.090+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff9473f310>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:07:11.053+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:07:11.049+0000] {timeout.py:68} ERROR - Process timed out, PID: 113
[2024-04-08T02:07:11.063+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:07:11.055+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff9473f210>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 113

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 113
[2024-04-08T02:07:11.064+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:07:11.086+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.053 seconds
[2024-04-08T02:07:41.461+0000] {processor.py:156} INFO - Started process (PID=145) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:07:41.464+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:07:41.465+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:07:41.465+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:07:42.184+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:07:42.184+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff947a8290>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:07:46.209+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:07:46.208+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff9473c3d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:07:54.258+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:07:54.253+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff9473cf90>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:08:10.357+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:08:10.350+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff94748410>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:08:11.484+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:08:11.473+0000] {timeout.py:68} ERROR - Process timed out, PID: 145
[2024-04-08T02:08:11.504+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:08:11.488+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff94748250>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 145

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 145
[2024-04-08T02:08:11.507+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:08:11.556+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.102 seconds
[2024-04-08T02:08:41.993+0000] {processor.py:156} INFO - Started process (PID=183) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:08:41.995+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:08:41.996+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:08:41.996+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:08:42.864+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:08:42.863+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff947c3790>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:08:46.884+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:08:46.883+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff947c3510>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:08:54.908+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:08:54.908+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff9475b610>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:09:10.946+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:09:10.940+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff9475b0d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:09:12.007+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:09:12.001+0000] {timeout.py:68} ERROR - Process timed out, PID: 183
[2024-04-08T02:09:12.026+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:09:12.011+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff947b7a90>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 183

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 183
[2024-04-08T02:09:12.028+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:09:12.082+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.094 seconds
[2024-04-08T02:09:42.562+0000] {processor.py:156} INFO - Started process (PID=215) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:09:42.570+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:09:42.576+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:09:42.576+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:09:43.361+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:09:43.360+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff9478e650>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:09:47.379+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:09:47.379+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff947b4050>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:09:55.458+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:09:55.457+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff947b4a90>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:10:11.492+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:10:11.488+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff9474c810>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:10:12.604+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:10:12.598+0000] {timeout.py:68} ERROR - Process timed out, PID: 215
[2024-04-08T02:10:12.623+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:10:12.608+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff9474c190>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 215

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_tracking_uri("http://localhost:8080")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 215
[2024-04-08T02:10:12.625+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:10:12.673+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.119 seconds
[2024-04-08T02:11:36.886+0000] {processor.py:156} INFO - Started process (PID=49) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:11:36.888+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:11:36.889+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:11:36.889+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:11:38.807+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:11:38.807+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e18a390>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:11:42.830+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:11:42.818+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e18a8d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:11:50.844+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:11:50.842+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e131690>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:12:06.872+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:12:06.866+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e1316d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:12:06.901+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:12:06.892+0000] {timeout.py:68} ERROR - Process timed out, PID: 49
[2024-04-08T02:12:06.927+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:12:06.905+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e191110>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 49

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 49
[2024-04-08T02:12:06.930+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:12:06.965+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.083 seconds
[2024-04-08T02:12:37.479+0000] {processor.py:156} INFO - Started process (PID=81) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:12:37.482+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:12:37.483+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:12:37.483+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:12:38.456+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:12:38.456+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e09cbd0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:12:42.464+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:12:42.463+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e036c50>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:12:50.474+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:12:50.473+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e036e90>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:13:06.525+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:13:06.522+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e03e110>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:13:07.500+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:13:07.491+0000] {timeout.py:68} ERROR - Process timed out, PID: 81
[2024-04-08T02:13:07.530+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:13:07.507+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e03e3d0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 81

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 81
[2024-04-08T02:13:07.532+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:13:07.594+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.116 seconds
[2024-04-08T02:13:37.876+0000] {processor.py:156} INFO - Started process (PID=113) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:13:37.879+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:13:37.880+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:13:37.880+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:13:38.609+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:13:38.608+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e093810>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:13:42.616+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:13:42.615+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e093ed0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:13:50.637+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:13:50.635+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e09d090>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:14:06.655+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:14:06.652+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e036850>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:14:07.890+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:14:07.884+0000] {timeout.py:68} ERROR - Process timed out, PID: 113
[2024-04-08T02:14:07.905+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:14:07.893+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e036e10>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 113

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 113
[2024-04-08T02:14:07.907+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:14:07.952+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.085 seconds
[2024-04-08T02:14:38.329+0000] {processor.py:156} INFO - Started process (PID=145) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:14:38.332+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:14:38.334+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:14:38.334+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:14:39.186+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:14:39.186+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e08a410>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:14:43.194+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:14:43.193+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e025310>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:14:51.207+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:14:51.207+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e025f50>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:15:07.243+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:15:07.235+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e02d650>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:15:08.354+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:15:08.343+0000] {timeout.py:68} ERROR - Process timed out, PID: 145
[2024-04-08T02:15:08.380+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:15:08.359+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e02d4d0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 145

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 145
[2024-04-08T02:15:08.382+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:15:08.448+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.129 seconds
[2024-04-08T02:15:38.697+0000] {processor.py:156} INFO - Started process (PID=177) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:15:38.700+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:15:38.701+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:15:38.701+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:15:39.489+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:15:39.489+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e09a050>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:15:43.497+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:15:43.496+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0357d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:15:51.513+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:15:51.510+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e035d10>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:16:07.531+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:16:07.529+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e03d090>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:16:08.716+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:16:08.708+0000] {timeout.py:68} ERROR - Process timed out, PID: 177
[2024-04-08T02:16:08.745+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:16:08.721+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e03d350>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 177

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 177
[2024-04-08T02:16:08.747+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:16:08.813+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.126 seconds
[2024-04-08T02:16:39.205+0000] {processor.py:156} INFO - Started process (PID=209) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:16:39.207+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:16:39.208+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:16:39.208+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:16:40.187+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:16:40.187+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e08f490>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:16:44.194+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:16:44.194+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e098e50>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:16:52.212+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:16:52.211+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e098510>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:17:08.244+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:17:08.239+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e27af90>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:17:09.226+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:17:09.218+0000] {timeout.py:68} ERROR - Process timed out, PID: 209
[2024-04-08T02:17:09.254+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:17:09.230+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e02e190>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 209

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 209
[2024-04-08T02:17:09.256+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:17:09.324+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.126 seconds
[2024-04-08T02:17:39.711+0000] {processor.py:156} INFO - Started process (PID=241) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:17:39.714+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:17:39.715+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:17:39.715+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:17:40.493+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:17:40.493+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0a1050>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:17:44.501+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:17:44.499+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e03b510>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:17:52.515+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:17:52.514+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e03be90>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:18:08.553+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:18:08.550+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e044610>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:18:09.724+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:18:09.719+0000] {timeout.py:68} ERROR - Process timed out, PID: 241
[2024-04-08T02:18:09.738+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:18:09.726+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e044490>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 241

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 241
[2024-04-08T02:18:09.740+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:18:09.788+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.083 seconds
[2024-04-08T02:18:40.084+0000] {processor.py:156} INFO - Started process (PID=273) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:18:40.086+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:18:40.087+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:18:40.087+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:18:41.082+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:18:41.082+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e09e210>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:18:45.093+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:18:45.091+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e037750>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:18:53.117+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:18:53.113+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e037e50>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:19:09.146+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:19:09.141+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e03f5d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:19:10.104+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:19:10.092+0000] {timeout.py:68} ERROR - Process timed out, PID: 273
[2024-04-08T02:19:10.126+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:19:10.108+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e03f450>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 273

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 273
[2024-04-08T02:19:10.128+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:19:10.173+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.092 seconds
[2024-04-08T02:19:40.670+0000] {processor.py:156} INFO - Started process (PID=305) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:19:40.673+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:19:40.674+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:19:40.674+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:19:41.451+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:19:41.450+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e075410>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:19:45.460+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:19:45.458+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e080690>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:19:53.474+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:19:53.473+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e080a50>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:20:09.485+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:20:09.483+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0372d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:20:10.685+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:20:10.682+0000] {timeout.py:68} ERROR - Process timed out, PID: 305
[2024-04-08T02:20:10.696+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:20:10.687+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e09ddd0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 305

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 305
[2024-04-08T02:20:10.698+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:20:10.731+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.069 seconds
[2024-04-08T02:20:41.187+0000] {processor.py:156} INFO - Started process (PID=336) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:20:41.191+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:20:41.192+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:20:41.192+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:20:41.972+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:20:41.972+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e07f210>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:20:45.986+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:20:45.984+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0182d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:20:54.002+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:20:53.997+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e018cd0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:21:10.040+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:21:10.038+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0200d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:21:11.207+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:21:11.199+0000] {timeout.py:68} ERROR - Process timed out, PID: 336
[2024-04-08T02:21:11.225+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:21:11.211+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e020310>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 336

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 336
[2024-04-08T02:21:11.228+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:21:11.307+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.127 seconds
[2024-04-08T02:21:41.591+0000] {processor.py:156} INFO - Started process (PID=368) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:21:41.592+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:21:41.592+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:21:41.592+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:21:42.279+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:21:42.279+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0485d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:21:46.288+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:21:46.285+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e048550>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:21:54.311+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:21:54.310+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e040550>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:22:10.338+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:22:10.336+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e040290>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:22:11.596+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:22:11.593+0000] {timeout.py:68} ERROR - Process timed out, PID: 368
[2024-04-08T02:22:11.609+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:22:11.598+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e0401d0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 368

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 368
[2024-04-08T02:22:11.612+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:22:11.649+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.061 seconds
[2024-04-08T02:22:42.192+0000] {processor.py:156} INFO - Started process (PID=400) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:22:42.196+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:22:42.197+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:22:42.197+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:22:43.072+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:22:43.072+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0a7210>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:22:47.083+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:22:47.081+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e040750>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:22:55.102+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:22:55.098+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e040e50>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:23:11.121+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:23:11.118+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0485d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:23:12.222+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:23:12.207+0000] {timeout.py:68} ERROR - Process timed out, PID: 400
[2024-04-08T02:23:12.231+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:23:12.223+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e048450>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 400
[2024-04-08T02:23:12.234+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:23:12.284+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.105 seconds
[2024-04-08T02:23:42.405+0000] {processor.py:156} INFO - Started process (PID=432) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:23:42.408+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:23:42.409+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:23:42.409+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:23:43.128+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:23:43.128+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0a4490>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:23:47.131+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:23:47.131+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e02f5d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:23:55.135+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:23:55.135+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e02fbd0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:24:11.176+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:24:11.160+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e088890>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:24:12.431+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:24:12.416+0000] {timeout.py:68} ERROR - Process timed out, PID: 432
[2024-04-08T02:24:12.456+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:24:12.436+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e088290>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 432

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 432
[2024-04-08T02:24:12.461+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:24:12.560+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.162 seconds
[2024-04-08T02:24:43.000+0000] {processor.py:156} INFO - Started process (PID=464) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:24:43.003+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:24:43.004+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:24:43.004+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:24:43.749+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:24:43.749+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e07e110>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:24:47.760+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:24:47.758+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0864d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:24:55.774+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:24:55.773+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e086150>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:25:11.800+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:25:11.795+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0402d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:25:13.016+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:25:13.010+0000] {timeout.py:68} ERROR - Process timed out, PID: 464
[2024-04-08T02:25:13.035+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:25:13.020+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e0a6cd0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 464

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 464
[2024-04-08T02:25:13.038+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:25:13.092+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.100 seconds
[2024-04-08T02:25:43.395+0000] {processor.py:156} INFO - Started process (PID=496) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:25:43.398+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:25:43.399+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:25:43.399+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:25:44.207+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:25:44.207+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e072410>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:25:48.215+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:25:48.215+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e00c1d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:25:56.225+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:25:56.224+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e00c590>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:26:12.257+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:26:12.250+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e015110>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:26:13.407+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:26:13.404+0000] {timeout.py:68} ERROR - Process timed out, PID: 496
[2024-04-08T02:26:13.416+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:26:13.408+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e015150>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 496

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 496
[2024-04-08T02:26:13.417+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:26:13.449+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.059 seconds
[2024-04-08T02:26:43.641+0000] {processor.py:156} INFO - Started process (PID=528) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:26:43.643+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:26:43.644+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:26:43.644+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:26:44.635+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:26:44.634+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e08e050>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:26:48.645+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:26:48.643+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e028510>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:26:56.667+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:26:56.666+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e028e90>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:27:12.694+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:27:12.693+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e030610>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:27:13.667+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:27:13.660+0000] {timeout.py:68} ERROR - Process timed out, PID: 528
[2024-04-08T02:27:13.689+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:27:13.670+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e030490>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 528

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 528
[2024-04-08T02:27:13.691+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:27:13.729+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-04-08T02:27:43.848+0000] {processor.py:156} INFO - Started process (PID=561) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:27:43.849+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:27:43.850+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:27:43.850+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:27:44.468+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:27:44.468+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e08d6d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:27:48.473+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:27:48.473+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e08ddd0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:27:56.487+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:27:56.485+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e098b50>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:28:12.497+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:28:12.496+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e070490>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:28:13.856+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:28:13.854+0000] {timeout.py:68} ERROR - Process timed out, PID: 561
[2024-04-08T02:28:13.866+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:28:13.857+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e031310>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 561

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 561
[2024-04-08T02:28:13.867+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:28:13.897+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.054 seconds
[2024-04-08T02:28:44.330+0000] {processor.py:156} INFO - Started process (PID=593) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:28:44.333+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:28:44.334+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:28:44.334+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:28:45.013+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:28:45.012+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e080890>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:28:49.020+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:28:49.019+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e080150>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:28:57.034+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:28:57.033+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e01a1d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:29:13.048+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:29:13.045+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e022190>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:29:14.342+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:29:14.340+0000] {timeout.py:68} ERROR - Process timed out, PID: 593
[2024-04-08T02:29:14.347+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:29:14.342+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e022590>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 593

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 593
[2024-04-08T02:29:14.348+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:29:14.366+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.045 seconds
[2024-04-08T02:29:44.587+0000] {processor.py:156} INFO - Started process (PID=625) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:29:44.588+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:29:44.589+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:29:44.589+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:29:45.207+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:29:45.207+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0b1410>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:29:49.211+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:29:49.210+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e04b310>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:29:57.220+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:29:57.219+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e04bf50>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:30:13.239+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:30:13.237+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e054650>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:30:14.600+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:30:14.595+0000] {timeout.py:68} ERROR - Process timed out, PID: 625
[2024-04-08T02:30:14.623+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:30:14.602+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e0544d0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 625

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 625
[2024-04-08T02:30:14.625+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:30:14.662+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.079 seconds
[2024-04-08T02:30:44.782+0000] {processor.py:156} INFO - Started process (PID=656) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:30:44.789+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:30:44.792+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:30:44.792+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:30:45.773+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:30:45.773+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0a84d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:30:49.777+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:30:49.776+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0b2090>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:30:57.787+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:30:57.785+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0b2590>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:31:13.812+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:31:13.809+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e293c90>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:31:14.806+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:31:14.804+0000] {timeout.py:68} ERROR - Process timed out, PID: 656
[2024-04-08T02:31:14.826+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:31:14.820+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e047490>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 656

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 656
[2024-04-08T02:31:14.827+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:31:14.858+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-04-08T02:31:45.524+0000] {processor.py:156} INFO - Started process (PID=688) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:31:45.525+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:31:45.526+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:31:45.526+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:31:46.132+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:31:46.131+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e080410>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:31:50.139+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:31:50.139+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e01ac10>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:31:58.158+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:31:58.157+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e01ae50>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:32:14.190+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:32:14.188+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0230d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:32:15.531+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:32:15.529+0000] {timeout.py:68} ERROR - Process timed out, PID: 688
[2024-04-08T02:32:15.550+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:32:15.533+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e023390>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 688

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 688
[2024-04-08T02:32:15.551+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:32:15.584+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.064 seconds
[2024-04-08T02:32:45.926+0000] {processor.py:156} INFO - Started process (PID=720) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:32:45.929+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:32:45.931+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:32:45.931+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:32:46.755+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:32:46.755+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e022050>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:32:50.780+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:32:50.779+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0229d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:32:58.788+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:32:58.786+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e016150>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:33:14.814+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:33:14.813+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e016510>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:33:15.939+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:33:15.936+0000] {timeout.py:68} ERROR - Process timed out, PID: 720
[2024-04-08T02:33:15.950+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:33:15.941+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e0168d0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 720

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8080/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 720
[2024-04-08T02:33:15.951+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:33:15.981+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.065 seconds
[2024-04-08T02:33:26.085+0000] {processor.py:156} INFO - Started process (PID=746) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:33:26.085+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:33:26.086+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:33:26.086+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:33:26.773+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:33:26.773+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0a93d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:33:30.783+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:33:30.783+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0b3290>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:33:38.809+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:33:38.808+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0b3190>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:33:54.824+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:33:54.822+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e294cd0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:33:56.090+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:33:56.088+0000] {timeout.py:68} ERROR - Process timed out, PID: 746
[2024-04-08T02:33:56.095+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:33:56.090+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e048e50>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 746

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 746
[2024-04-08T02:33:56.096+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:33:56.116+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.036 seconds
[2024-04-08T02:34:26.484+0000] {processor.py:156} INFO - Started process (PID=778) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:34:26.486+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:34:26.488+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:34:26.488+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:34:27.226+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:34:27.226+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e0b2050>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:34:31.235+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:34:31.234+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e04c510>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:34:39.251+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:34:39.250+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e04ce90>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:34:55.282+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:34:55.276+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5e055610>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:34:56.504+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:34:56.498+0000] {timeout.py:68} ERROR - Process timed out, PID: 778
[2024-04-08T02:34:56.519+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:34:56.507+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff5e055490>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 778

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 778
[2024-04-08T02:34:56.520+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:34:56.558+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.082 seconds
[2024-04-08T02:36:20.125+0000] {processor.py:156} INFO - Started process (PID=48) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:36:20.129+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:36:20.132+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:36:20.132+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:36:21.865+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:36:21.865+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75b28550>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:36:25.874+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:36:25.872+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75ac6110>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:36:33.895+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:36:33.893+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75ac6850>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:36:49.920+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:36:49.914+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75b16dd0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:36:50.150+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:36:50.140+0000] {timeout.py:68} ERROR - Process timed out, PID: 48
[2024-04-08T02:36:50.181+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:36:50.155+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff75b16350>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 48

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:5000/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 48
[2024-04-08T02:36:50.184+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:36:50.249+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.135 seconds
[2024-04-08T02:37:20.606+0000] {processor.py:156} INFO - Started process (PID=80) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:37:20.608+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:37:20.609+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:37:20.608+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:37:21.334+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:37:21.334+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a44590>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:37:25.343+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:37:25.341+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a44610>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:37:33.357+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:37:33.356+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a50dd0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:37:49.376+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:37:49.372+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff759e92d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:37:50.622+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:37:50.615+0000] {timeout.py:68} ERROR - Process timed out, PID: 80
[2024-04-08T02:37:50.643+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:37:50.626+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff759e9d90>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 80

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:5000/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 80
[2024-04-08T02:37:50.645+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:37:50.686+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.085 seconds
[2024-04-08T02:38:20.964+0000] {processor.py:156} INFO - Started process (PID=113) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:38:20.969+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:38:20.970+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:38:20.970+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:38:21.801+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:38:21.801+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a45810>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:38:25.810+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:38:25.810+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a45550>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:38:33.825+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:38:33.824+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a4f290>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:38:49.851+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:38:49.846+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75c2ffd0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:38:50.988+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:38:50.983+0000] {timeout.py:68} ERROR - Process timed out, PID: 113
[2024-04-08T02:38:51.014+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:38:50.990+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff759e8990>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 113

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:5000/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 113
[2024-04-08T02:38:51.016+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:38:51.069+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.117 seconds
[2024-04-08T02:39:21.330+0000] {processor.py:156} INFO - Started process (PID=145) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:39:21.332+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:39:21.333+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:39:21.332+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:39:22.010+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:39:22.010+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a4d050>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:39:26.013+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:39:26.012+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff759e87d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:39:34.029+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:39:34.024+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff759e8d10>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:39:50.066+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:39:50.060+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff759f0090>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:39:51.366+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:39:51.340+0000] {timeout.py:68} ERROR - Process timed out, PID: 145
[2024-04-08T02:39:51.380+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:39:51.369+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff759f0350>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 145

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:5000/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 145
[2024-04-08T02:39:51.382+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:39:51.448+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.124 seconds
[2024-04-08T02:40:21.688+0000] {processor.py:156} INFO - Started process (PID=177) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:40:21.692+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:40:21.693+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:40:21.693+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:40:22.544+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:40:22.544+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a43150>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:40:26.556+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:40:26.555+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a43710>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:40:34.569+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:40:34.567+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a4f750>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:40:50.606+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:40:50.600+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a4f090>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:40:51.715+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:40:51.701+0000] {timeout.py:68} ERROR - Process timed out, PID: 177
[2024-04-08T02:40:51.741+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:40:51.731+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff759e7a50>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 177

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:5000/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 177
[2024-04-08T02:40:51.742+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:40:51.805+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.125 seconds
[2024-04-08T02:41:22.119+0000] {processor.py:156} INFO - Started process (PID=209) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:41:22.121+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:41:22.121+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:41:22.121+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:41:22.797+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:41:22.797+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a43810>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:41:26.806+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:41:26.805+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a437d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:41:34.821+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:41:34.819+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a4d090>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:41:50.851+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:41:50.847+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75c2fe90>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:41:52.134+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:41:52.129+0000] {timeout.py:68} ERROR - Process timed out, PID: 209
[2024-04-08T02:41:52.158+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:41:52.137+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff759e6cd0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 209

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:5000/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 209
[2024-04-08T02:41:52.161+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:41:52.204+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.090 seconds
[2024-04-08T02:42:22.488+0000] {processor.py:156} INFO - Started process (PID=241) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:42:22.490+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:42:22.491+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:42:22.491+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:42:23.145+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:42:23.145+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a42150>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:42:27.155+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:42:27.153+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a42510>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:42:35.163+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:42:35.162+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a4d390>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:42:51.191+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:42:51.186+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff759e6450>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:42:52.503+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:42:52.497+0000] {timeout.py:68} ERROR - Process timed out, PID: 241
[2024-04-08T02:42:52.518+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:42:52.506+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff759e6dd0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 241

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:5000/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 241
[2024-04-08T02:42:52.521+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:42:52.562+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.082 seconds
[2024-04-08T02:43:22.945+0000] {processor.py:156} INFO - Started process (PID=273) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:43:22.947+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:43:22.948+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:43:22.948+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:43:23.606+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:43:23.606+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a4dbd0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:43:27.615+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:43:27.614+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff759e6210>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:43:35.642+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:43:35.641+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff759e6c90>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:43:51.660+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:43:51.657+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff759ed090>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:43:52.960+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:43:52.954+0000] {timeout.py:68} ERROR - Process timed out, PID: 273
[2024-04-08T02:43:52.977+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:43:52.963+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff759ed210>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 273

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:5000/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 273
[2024-04-08T02:43:52.980+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:43:53.028+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.089 seconds
[2024-04-08T02:44:23.414+0000] {processor.py:156} INFO - Started process (PID=306) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:44:23.416+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:44:23.417+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:44:23.417+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:44:24.106+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:44:24.106+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a03550>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:44:28.109+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:44:28.109+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a0e410>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:44:36.120+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:44:36.119+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a0e750>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:44:52.132+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:44:52.130+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff759c5090>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:44:53.436+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:44:53.423+0000] {timeout.py:68} ERROR - Process timed out, PID: 306
[2024-04-08T02:44:53.449+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:44:53.444+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff75a2a990>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 306

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://localhost:5000/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 306
[2024-04-08T02:44:53.450+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:44:53.479+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.071 seconds
[2024-04-08T02:45:23.649+0000] {processor.py:156} INFO - Started process (PID=338) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:45:23.651+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:45:23.652+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:45:23.652+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:45:24.354+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:45:24.354+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a42590>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:45:28.363+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:45:28.361+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a42c10>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:45:36.386+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:45:36.385+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff75a4edd0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:46:33.683+0000] {processor.py:156} INFO - Started process (PID=49) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:46:33.688+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:46:33.690+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:46:33.690+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:46:35.252+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:46:35.252+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff612dfe50>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:46:39.258+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:46:39.257+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff6127e5d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:46:47.271+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:46:47.269+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff6127e710>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:47:03.298+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:47:03.298+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff612d5110>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:47:03.707+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:47:03.699+0000] {timeout.py:68} ERROR - Process timed out, PID: 49
[2024-04-08T02:47:03.731+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:47:03.722+0000] {dagbag.py:350} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0xffff612d5550>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 175, in http_request
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 97, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 828, in urlopen
    **response_kw
  [Previous line repeated 1 more time]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    retries.sleep()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 432, in sleep
    self._sleep_backoff()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 416, in _sleep_backoff
    time.sleep(backoff)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 49

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 346, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 42, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/fluent.py", line 114, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/client.py", line 585, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py", line 241, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 332, in get_experiment_by_name
    raise e
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 319, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/store/tracking/rest_store.py", line 57, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 274, in call_endpoint
    host_creds=host_creds, endpoint=endpoint, method=method, params=json_body
  File "/home/airflow/.local/lib/python3.7/site-packages/mlflow/utils/rest_utils.py", line 184, in http_request
    raise MlflowException("API request to %s failed with exception %s" % (url, e))
mlflow.exceptions.MlflowException: API request to http://0.0.0.0:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.6.0/best-practices.html#reducing-dag-complexity, PID: 49
[2024-04-08T02:47:03.732+0000] {processor.py:811} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-04-08T02:47:03.792+0000] {processor.py:178} INFO - Processing /opt/airflow/dags/train_model.py took 30.110 seconds
[2024-04-08T02:47:33.907+0000] {processor.py:156} INFO - Started process (PID=80) to work on /opt/airflow/dags/train_model.py
[2024-04-08T02:47:33.908+0000] {processor.py:799} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-04-08T02:47:33.909+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:47:33.909+0000] {dagbag.py:541} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-04-08T02:47:34.684+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:47:34.684+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff61247210>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:47:38.688+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:47:38.686+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff611df390>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-04-08T02:47:46.704+0000] {logging_mixin.py:149} INFO - [2024-04-08T02:47:46.703+0000] {connectionpool.py:813} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff611dfd90>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
