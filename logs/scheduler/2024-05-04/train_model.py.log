[2024-05-04T05:10:39.835+0000] {processor.py:157} INFO - Started process (PID=52) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:10:39.842+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:10:39.847+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:10:39.846+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:11:09.864+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:11:09.855+0000] {timeout.py:68} ERROR - Process timed out, PID: 52
[2024-05-04T05:11:09.884+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:11:09.870+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 52

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 52
[2024-05-04T05:11:09.886+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:11:09.919+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.093 seconds
[2024-05-04T05:11:40.343+0000] {processor.py:157} INFO - Started process (PID=76) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:11:40.344+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:11:40.348+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:11:40.347+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:12:10.360+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:12:10.356+0000] {timeout.py:68} ERROR - Process timed out, PID: 76
[2024-05-04T05:12:10.377+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:12:10.366+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 76

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 76
[2024-05-04T05:12:10.379+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:12:10.414+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.076 seconds
[2024-05-04T05:12:40.867+0000] {processor.py:157} INFO - Started process (PID=100) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:12:40.869+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:12:40.873+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:12:40.872+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:13:10.883+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:13:10.880+0000] {timeout.py:68} ERROR - Process timed out, PID: 100
[2024-05-04T05:13:10.904+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:13:10.892+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 100

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 100
[2024-05-04T05:13:10.907+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:13:10.930+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.069 seconds
[2024-05-04T05:13:41.692+0000] {processor.py:157} INFO - Started process (PID=131) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:13:41.693+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:13:41.697+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:13:41.696+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:14:11.707+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:14:11.703+0000] {timeout.py:68} ERROR - Process timed out, PID: 131
[2024-05-04T05:14:11.726+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:14:11.713+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 131

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 131
[2024-05-04T05:14:11.729+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:14:11.762+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.079 seconds
[2024-05-04T05:14:41.890+0000] {processor.py:157} INFO - Started process (PID=156) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:14:41.891+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:14:41.895+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:14:41.894+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:15:11.905+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:15:11.902+0000] {timeout.py:68} ERROR - Process timed out, PID: 156
[2024-05-04T05:15:11.924+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:15:11.912+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 156

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 156
[2024-05-04T05:15:11.926+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:15:11.956+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.072 seconds
[2024-05-04T05:15:42.417+0000] {processor.py:157} INFO - Started process (PID=180) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:15:42.418+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:15:42.422+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:15:42.421+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:16:12.444+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:16:12.442+0000] {timeout.py:68} ERROR - Process timed out, PID: 180
[2024-05-04T05:16:12.452+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:16:12.447+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 180

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 180
[2024-05-04T05:16:12.453+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:16:12.472+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.047 seconds
[2024-05-04T05:16:42.759+0000] {processor.py:157} INFO - Started process (PID=203) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:16:42.760+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:16:42.762+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:16:42.761+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:17:12.781+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:17:12.769+0000] {timeout.py:68} ERROR - Process timed out, PID: 203
[2024-05-04T05:17:12.796+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:17:12.788+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 203

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 203
[2024-05-04T05:17:12.798+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:17:12.832+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.077 seconds
[2024-05-04T05:17:43.255+0000] {processor.py:157} INFO - Started process (PID=227) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:17:43.257+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:17:43.260+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:17:43.260+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:18:13.275+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:18:13.270+0000] {timeout.py:68} ERROR - Process timed out, PID: 227
[2024-05-04T05:18:13.293+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:18:13.279+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 227

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 227
[2024-05-04T05:18:13.295+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:18:13.321+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.071 seconds
[2024-05-04T05:18:43.618+0000] {processor.py:157} INFO - Started process (PID=251) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:18:43.620+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:18:43.624+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:18:43.624+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:19:13.643+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:19:13.631+0000] {timeout.py:68} ERROR - Process timed out, PID: 251
[2024-05-04T05:19:13.660+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:19:13.649+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 251

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 251
[2024-05-04T05:19:13.664+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:19:13.704+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.093 seconds
[2024-05-04T05:19:44.088+0000] {processor.py:157} INFO - Started process (PID=275) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:19:44.089+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:19:44.091+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:19:44.091+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:20:14.102+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:20:14.098+0000] {timeout.py:68} ERROR - Process timed out, PID: 275
[2024-05-04T05:20:14.117+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:20:14.108+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 275

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 275
[2024-05-04T05:20:14.120+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:20:14.157+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.073 seconds
[2024-05-04T05:20:45.035+0000] {processor.py:157} INFO - Started process (PID=299) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:20:45.036+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:20:45.040+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:20:45.039+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:21:15.070+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:21:15.050+0000] {timeout.py:68} ERROR - Process timed out, PID: 299
[2024-05-04T05:21:15.091+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:21:15.078+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 299

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 299
[2024-05-04T05:21:15.095+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:21:15.136+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.108 seconds
[2024-05-04T05:21:45.338+0000] {processor.py:157} INFO - Started process (PID=324) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:21:45.339+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:21:45.343+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:21:45.342+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:22:15.356+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:22:15.351+0000] {timeout.py:68} ERROR - Process timed out, PID: 324
[2024-05-04T05:22:15.367+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:22:15.361+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 324

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 324
[2024-05-04T05:22:15.369+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:22:15.398+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.066 seconds
[2024-05-04T05:22:45.823+0000] {processor.py:157} INFO - Started process (PID=348) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:22:45.825+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:22:45.830+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:22:45.829+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:23:15.850+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:23:15.842+0000] {timeout.py:68} ERROR - Process timed out, PID: 348
[2024-05-04T05:23:15.865+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:23:15.855+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 348

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 348
[2024-05-04T05:23:15.868+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:23:15.906+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.091 seconds
[2024-05-04T05:23:46.070+0000] {processor.py:157} INFO - Started process (PID=372) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:23:46.070+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:23:46.073+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:23:46.073+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:24:16.083+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:24:16.080+0000] {timeout.py:68} ERROR - Process timed out, PID: 372
[2024-05-04T05:24:16.094+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:24:16.087+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 372

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 372
[2024-05-04T05:24:16.095+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:24:16.112+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.045 seconds
[2024-05-04T05:24:46.793+0000] {processor.py:157} INFO - Started process (PID=396) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:24:46.794+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:24:46.797+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:24:46.797+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:25:16.819+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:25:16.810+0000] {timeout.py:68} ERROR - Process timed out, PID: 396
[2024-05-04T05:25:16.836+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:25:16.825+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 396

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 396
[2024-05-04T05:25:16.838+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:25:16.874+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-05-04T05:25:47.131+0000] {processor.py:157} INFO - Started process (PID=420) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:25:47.132+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:25:47.134+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:25:47.134+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:26:17.170+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:26:17.152+0000] {timeout.py:68} ERROR - Process timed out, PID: 420
[2024-05-04T05:26:17.193+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:26:17.180+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 420

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 420
[2024-05-04T05:26:17.197+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:26:17.234+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.106 seconds
[2024-05-04T05:26:47.476+0000] {processor.py:157} INFO - Started process (PID=444) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:26:47.478+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:26:47.481+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:26:47.480+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:27:17.496+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:27:17.489+0000] {timeout.py:68} ERROR - Process timed out, PID: 444
[2024-05-04T05:27:17.508+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:27:17.501+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 444

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 444
[2024-05-04T05:27:17.511+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:27:17.563+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.092 seconds
[2024-05-04T05:27:47.687+0000] {processor.py:157} INFO - Started process (PID=469) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:27:47.689+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:27:47.693+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:27:47.692+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:28:17.731+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:28:17.716+0000] {timeout.py:68} ERROR - Process timed out, PID: 469
[2024-05-04T05:28:17.754+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:28:17.738+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 469

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 469
[2024-05-04T05:28:17.758+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:28:17.814+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.130 seconds
[2024-05-04T05:28:48.045+0000] {processor.py:157} INFO - Started process (PID=493) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:28:48.046+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:28:48.050+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:28:48.049+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:29:18.071+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:29:18.060+0000] {timeout.py:68} ERROR - Process timed out, PID: 493
[2024-05-04T05:29:18.092+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:29:18.078+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 493

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 493
[2024-05-04T05:29:18.096+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:29:18.141+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.102 seconds
[2024-05-04T05:29:48.780+0000] {processor.py:157} INFO - Started process (PID=517) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:29:48.782+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:29:48.785+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:29:48.784+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:31:12.053+0000] {processor.py:157} INFO - Started process (PID=52) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:31:12.055+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:31:12.058+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:31:12.058+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:31:42.073+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:31:42.067+0000] {timeout.py:68} ERROR - Process timed out, PID: 52
[2024-05-04T05:31:42.085+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:31:42.077+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 52

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 52
[2024-05-04T05:31:42.088+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:31:42.125+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.076 seconds
[2024-05-04T05:32:12.738+0000] {processor.py:157} INFO - Started process (PID=76) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:32:12.740+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:32:12.745+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:32:12.744+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:32:42.791+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:32:42.766+0000] {timeout.py:68} ERROR - Process timed out, PID: 76
[2024-05-04T05:32:42.802+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:32:42.795+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 76

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 76
[2024-05-04T05:32:42.805+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:32:42.840+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.110 seconds
[2024-05-04T05:33:13.190+0000] {processor.py:157} INFO - Started process (PID=100) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:33:13.192+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:33:13.200+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:33:13.199+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:33:43.230+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:33:43.215+0000] {timeout.py:68} ERROR - Process timed out, PID: 100
[2024-05-04T05:33:43.243+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:33:43.235+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 100

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 100
[2024-05-04T05:33:43.246+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:33:43.297+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.114 seconds
[2024-05-04T05:34:13.672+0000] {processor.py:157} INFO - Started process (PID=124) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:34:13.674+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:34:13.677+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:34:13.677+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:34:43.709+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:34:43.692+0000] {timeout.py:68} ERROR - Process timed out, PID: 124
[2024-05-04T05:34:43.728+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:34:43.716+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 124

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 124
[2024-05-04T05:34:43.731+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:34:43.778+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.110 seconds
[2024-05-04T05:35:14.174+0000] {processor.py:157} INFO - Started process (PID=148) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:35:14.175+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:35:14.177+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:35:14.177+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:35:44.199+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:35:44.188+0000] {timeout.py:68} ERROR - Process timed out, PID: 148
[2024-05-04T05:35:44.217+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:35:44.206+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 148

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 148
[2024-05-04T05:35:44.221+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:35:44.256+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.085 seconds
[2024-05-04T05:36:14.681+0000] {processor.py:157} INFO - Started process (PID=172) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:36:14.682+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:36:14.686+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:36:14.686+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:36:44.699+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:36:44.696+0000] {timeout.py:68} ERROR - Process timed out, PID: 172
[2024-05-04T05:36:44.710+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:36:44.702+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 172

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 172
[2024-05-04T05:36:44.712+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:36:44.741+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.063 seconds
[2024-05-04T05:37:14.927+0000] {processor.py:157} INFO - Started process (PID=196) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:37:14.929+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:37:14.932+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:37:14.931+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:37:44.949+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:37:44.941+0000] {timeout.py:68} ERROR - Process timed out, PID: 196
[2024-05-04T05:37:44.962+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:37:44.954+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 196

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 196
[2024-05-04T05:37:44.965+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:37:44.996+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.073 seconds
[2024-05-04T05:38:15.672+0000] {processor.py:157} INFO - Started process (PID=220) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:38:15.673+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:38:15.675+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:38:15.675+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:38:45.699+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:38:45.684+0000] {timeout.py:68} ERROR - Process timed out, PID: 220
[2024-05-04T05:38:45.720+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:38:45.705+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 220

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 220
[2024-05-04T05:38:45.724+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:38:45.773+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.103 seconds
[2024-05-04T05:39:15.978+0000] {processor.py:157} INFO - Started process (PID=244) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:39:15.980+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:39:15.983+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:39:15.983+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:39:46.006+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:39:45.995+0000] {timeout.py:68} ERROR - Process timed out, PID: 244
[2024-05-04T05:39:46.020+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:39:46.013+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 244

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 244
[2024-05-04T05:39:46.022+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:39:46.080+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.108 seconds
[2024-05-04T05:40:16.185+0000] {processor.py:157} INFO - Started process (PID=268) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:40:16.186+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:40:16.189+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:40:16.189+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:40:46.195+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:40:46.194+0000] {timeout.py:68} ERROR - Process timed out, PID: 268
[2024-05-04T05:40:46.200+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:40:46.197+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 268

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 268
[2024-05-04T05:40:46.201+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:40:46.216+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.034 seconds
[2024-05-04T05:41:16.919+0000] {processor.py:157} INFO - Started process (PID=299) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:41:16.920+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:41:16.922+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:41:16.921+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:41:46.930+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:41:46.926+0000] {timeout.py:68} ERROR - Process timed out, PID: 299
[2024-05-04T05:41:46.936+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:41:46.932+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 299

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 299
[2024-05-04T05:41:46.937+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:41:46.967+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.050 seconds
[2024-05-04T05:42:17.130+0000] {processor.py:157} INFO - Started process (PID=323) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:42:17.131+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:42:17.133+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:42:17.132+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:42:47.138+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:42:47.136+0000] {timeout.py:68} ERROR - Process timed out, PID: 323
[2024-05-04T05:42:47.149+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:42:47.141+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 323

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 323
[2024-05-04T05:42:47.150+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:42:47.172+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.044 seconds
[2024-05-04T05:43:17.522+0000] {processor.py:157} INFO - Started process (PID=347) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:43:17.523+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:43:17.527+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:43:17.526+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:43:47.542+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:43:47.538+0000] {timeout.py:68} ERROR - Process timed out, PID: 347
[2024-05-04T05:43:47.551+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:43:47.544+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 347

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 347
[2024-05-04T05:43:47.552+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:43:47.587+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.070 seconds
[2024-05-04T05:44:17.797+0000] {processor.py:157} INFO - Started process (PID=371) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:44:17.798+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:44:17.804+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:44:17.803+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:44:47.833+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:44:47.815+0000] {timeout.py:68} ERROR - Process timed out, PID: 371
[2024-05-04T05:44:47.849+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:44:47.839+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 371

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 371
[2024-05-04T05:44:47.853+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:44:47.879+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.088 seconds
[2024-05-04T05:45:18.443+0000] {processor.py:157} INFO - Started process (PID=396) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:45:18.444+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:45:18.447+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:45:18.447+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:45:48.459+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:45:48.455+0000] {timeout.py:68} ERROR - Process timed out, PID: 396
[2024-05-04T05:45:48.468+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:45:48.463+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 396

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 396
[2024-05-04T05:45:48.469+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:45:48.494+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.054 seconds
[2024-05-04T05:46:18.727+0000] {processor.py:157} INFO - Started process (PID=420) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:46:18.729+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:46:18.733+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:46:18.732+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:46:48.752+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:46:48.741+0000] {timeout.py:68} ERROR - Process timed out, PID: 420
[2024-05-04T05:46:48.775+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:46:48.760+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 420

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 420
[2024-05-04T05:46:48.778+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:46:48.807+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.082 seconds
[2024-05-04T05:47:19.191+0000] {processor.py:157} INFO - Started process (PID=444) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:47:19.192+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:47:19.196+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:47:19.196+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:47:49.203+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:47:49.201+0000] {timeout.py:68} ERROR - Process timed out, PID: 444
[2024-05-04T05:47:49.212+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:47:49.205+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 444

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 444
[2024-05-04T05:47:49.213+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:47:49.243+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.056 seconds
[2024-05-04T05:48:19.425+0000] {processor.py:157} INFO - Started process (PID=468) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:48:19.426+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:48:19.431+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:48:19.431+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:48:49.457+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:48:49.443+0000] {timeout.py:68} ERROR - Process timed out, PID: 468
[2024-05-04T05:48:49.480+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:48:49.465+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 468

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 468
[2024-05-04T05:48:49.483+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:48:49.527+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.109 seconds
[2024-05-04T05:49:20.191+0000] {processor.py:157} INFO - Started process (PID=492) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:49:20.192+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:49:20.198+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:49:20.197+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:49:50.224+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:49:50.210+0000] {timeout.py:68} ERROR - Process timed out, PID: 492
[2024-05-04T05:49:50.248+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:49:50.233+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 492

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 492
[2024-05-04T05:49:50.253+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:49:50.307+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.125 seconds
[2024-05-04T05:50:20.372+0000] {processor.py:157} INFO - Started process (PID=516) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:50:20.372+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:50:20.375+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:50:20.374+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:50:50.397+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:50:50.389+0000] {timeout.py:68} ERROR - Process timed out, PID: 516
[2024-05-04T05:50:50.413+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:50:50.403+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 516

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 516
[2024-05-04T05:50:50.416+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:50:50.458+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.087 seconds
[2024-05-04T05:51:20.673+0000] {processor.py:157} INFO - Started process (PID=540) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:51:20.674+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:51:20.679+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:51:20.678+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:51:50.695+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:51:50.687+0000] {timeout.py:68} ERROR - Process timed out, PID: 540
[2024-05-04T05:51:50.724+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:51:50.702+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 540

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 540
[2024-05-04T05:51:50.727+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:51:50.769+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.103 seconds
[2024-05-04T05:52:21.164+0000] {processor.py:157} INFO - Started process (PID=564) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:52:21.165+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:52:21.168+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:52:21.167+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:52:51.198+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:52:51.180+0000] {timeout.py:68} ERROR - Process timed out, PID: 564
[2024-05-04T05:52:51.222+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:52:51.208+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 564

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 564
[2024-05-04T05:52:51.226+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:52:51.272+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.111 seconds
[2024-05-04T05:53:21.576+0000] {processor.py:157} INFO - Started process (PID=588) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:53:21.578+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:53:21.585+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:53:21.584+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:53:51.604+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:53:51.593+0000] {timeout.py:68} ERROR - Process timed out, PID: 588
[2024-05-04T05:53:51.622+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:53:51.612+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 588

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 588
[2024-05-04T05:53:51.625+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:53:51.657+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.090 seconds
[2024-05-04T05:54:21.964+0000] {processor.py:157} INFO - Started process (PID=612) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:54:21.965+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:54:21.967+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:54:21.966+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:54:51.976+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:54:51.971+0000] {timeout.py:68} ERROR - Process timed out, PID: 612
[2024-05-04T05:54:51.988+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:54:51.981+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 612

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 612
[2024-05-04T05:54:51.990+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:54:52.023+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.060 seconds
[2024-05-04T05:55:22.413+0000] {processor.py:157} INFO - Started process (PID=636) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:55:22.414+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:55:22.419+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:55:22.418+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:55:52.436+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:55:52.429+0000] {timeout.py:68} ERROR - Process timed out, PID: 636
[2024-05-04T05:55:52.446+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:55:52.439+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 636

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 636
[2024-05-04T05:55:52.448+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:55:52.481+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.071 seconds
[2024-05-04T05:56:22.828+0000] {processor.py:157} INFO - Started process (PID=660) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:56:22.829+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:56:22.831+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:56:22.831+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:56:52.864+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:56:52.847+0000] {timeout.py:68} ERROR - Process timed out, PID: 660
[2024-05-04T05:56:52.887+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:56:52.874+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 660

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 660
[2024-05-04T05:56:52.892+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:56:52.937+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.113 seconds
[2024-05-04T05:57:23.359+0000] {processor.py:157} INFO - Started process (PID=684) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:57:23.360+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:57:23.364+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:57:23.364+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:57:53.386+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:57:53.372+0000] {timeout.py:68} ERROR - Process timed out, PID: 684
[2024-05-04T05:57:53.408+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:57:53.395+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 684

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 684
[2024-05-04T05:57:53.411+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:57:53.451+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.097 seconds
[2024-05-04T05:58:23.743+0000] {processor.py:157} INFO - Started process (PID=708) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:58:23.744+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:58:23.748+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:58:23.747+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:58:53.762+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:58:53.754+0000] {timeout.py:68} ERROR - Process timed out, PID: 708
[2024-05-04T05:58:53.781+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:58:53.769+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 708

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 708
[2024-05-04T05:58:53.784+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:58:53.814+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.073 seconds
[2024-05-04T05:59:24.055+0000] {processor.py:157} INFO - Started process (PID=732) to work on /opt/airflow/dags/train_model.py
[2024-05-04T05:59:24.056+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T05:59:24.060+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:59:24.060+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T05:59:54.082+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:59:54.073+0000] {timeout.py:68} ERROR - Process timed out, PID: 732
[2024-05-04T05:59:54.106+0000] {logging_mixin.py:151} INFO - [2024-05-04T05:59:54.090+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 732

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 732
[2024-05-04T05:59:54.109+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T05:59:54.144+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.094 seconds
[2024-05-04T06:00:24.797+0000] {processor.py:157} INFO - Started process (PID=756) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:00:24.798+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:00:24.802+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:00:24.802+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:00:54.816+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:00:54.810+0000] {timeout.py:68} ERROR - Process timed out, PID: 756
[2024-05-04T06:00:54.834+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:00:54.821+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 756

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 756
[2024-05-04T06:00:54.837+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:00:54.873+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.083 seconds
[2024-05-04T06:01:25.048+0000] {processor.py:157} INFO - Started process (PID=780) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:01:25.050+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:01:25.053+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:01:25.053+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:01:55.063+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:01:55.060+0000] {timeout.py:68} ERROR - Process timed out, PID: 780
[2024-05-04T06:01:55.068+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:01:55.064+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 780

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 780
[2024-05-04T06:01:55.069+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:01:55.084+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.039 seconds
[2024-05-04T06:02:25.180+0000] {processor.py:157} INFO - Started process (PID=804) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:02:25.181+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:02:25.183+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:02:25.182+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:02:55.192+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:02:55.187+0000] {timeout.py:68} ERROR - Process timed out, PID: 804
[2024-05-04T06:02:55.206+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:02:55.196+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 804

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 804
[2024-05-04T06:02:55.208+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:02:55.236+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.059 seconds
[2024-05-04T06:03:25.525+0000] {processor.py:157} INFO - Started process (PID=828) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:03:25.526+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:03:25.528+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:03:25.528+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:03:55.536+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:03:55.533+0000] {timeout.py:68} ERROR - Process timed out, PID: 828
[2024-05-04T06:03:55.552+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:03:55.541+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 828

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 828
[2024-05-04T06:03:55.554+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:03:55.583+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.060 seconds
[2024-05-04T06:04:26.004+0000] {processor.py:157} INFO - Started process (PID=852) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:04:26.006+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:04:26.009+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:04:26.009+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:04:56.037+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:04:56.023+0000] {timeout.py:68} ERROR - Process timed out, PID: 852
[2024-05-04T06:04:56.056+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:04:56.045+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 852

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 852
[2024-05-04T06:04:56.059+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:04:56.101+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.102 seconds
[2024-05-04T06:05:26.369+0000] {processor.py:157} INFO - Started process (PID=876) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:05:26.370+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:05:26.376+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:05:26.375+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:05:56.403+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:05:56.386+0000] {timeout.py:68} ERROR - Process timed out, PID: 876
[2024-05-04T06:05:56.422+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:05:56.409+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 876

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 876
[2024-05-04T06:05:56.426+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:05:56.463+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.101 seconds
[2024-05-04T06:06:26.963+0000] {processor.py:157} INFO - Started process (PID=900) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:06:26.963+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:06:26.965+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:06:26.964+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:06:56.970+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:06:56.968+0000] {timeout.py:68} ERROR - Process timed out, PID: 900
[2024-05-04T06:06:56.975+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:06:56.971+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 900

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 900
[2024-05-04T06:06:56.976+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:06:56.991+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.031 seconds
[2024-05-04T06:07:27.175+0000] {processor.py:157} INFO - Started process (PID=924) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:07:27.177+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:07:27.180+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:07:27.180+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:07:57.186+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:07:57.185+0000] {timeout.py:68} ERROR - Process timed out, PID: 924
[2024-05-04T06:07:57.195+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:07:57.189+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 924

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 924
[2024-05-04T06:07:57.197+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:07:57.219+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.048 seconds
[2024-05-04T06:08:27.559+0000] {processor.py:157} INFO - Started process (PID=948) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:08:27.560+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:08:27.563+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:08:27.562+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:08:57.570+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:08:57.567+0000] {timeout.py:68} ERROR - Process timed out, PID: 948
[2024-05-04T06:08:57.579+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:08:57.572+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 948

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 948
[2024-05-04T06:08:57.580+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:08:57.605+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.049 seconds
[2024-05-04T06:09:27.818+0000] {processor.py:157} INFO - Started process (PID=972) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:09:27.819+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:09:27.823+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:09:27.822+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:09:57.836+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:09:57.835+0000] {timeout.py:68} ERROR - Process timed out, PID: 972
[2024-05-04T06:09:57.841+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:09:57.837+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 972

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 972
[2024-05-04T06:09:57.841+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:09:57.856+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.036 seconds
[2024-05-04T06:10:28.232+0000] {processor.py:157} INFO - Started process (PID=996) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:10:28.233+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:10:28.235+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:10:28.235+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:10:58.239+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:10:58.238+0000] {timeout.py:68} ERROR - Process timed out, PID: 996
[2024-05-04T06:10:58.244+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:10:58.241+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 996

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 996
[2024-05-04T06:10:58.244+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:10:58.264+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.035 seconds
[2024-05-04T06:11:28.319+0000] {processor.py:157} INFO - Started process (PID=1020) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:11:28.321+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:11:28.324+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:11:28.324+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:11:58.335+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:11:58.330+0000] {timeout.py:68} ERROR - Process timed out, PID: 1020
[2024-05-04T06:11:58.350+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:11:58.339+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1020

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1020
[2024-05-04T06:11:58.351+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:11:58.381+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.068 seconds
[2024-05-04T06:12:29.198+0000] {processor.py:157} INFO - Started process (PID=1044) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:12:29.200+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:12:29.202+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:12:29.202+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:12:59.210+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:12:59.207+0000] {timeout.py:68} ERROR - Process timed out, PID: 1044
[2024-05-04T06:12:59.216+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:12:59.212+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1044

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1044
[2024-05-04T06:12:59.218+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:12:59.238+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.045 seconds
[2024-05-04T06:13:29.474+0000] {processor.py:157} INFO - Started process (PID=1067) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:13:29.475+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:13:29.478+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:13:29.477+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:13:59.491+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:13:59.486+0000] {timeout.py:68} ERROR - Process timed out, PID: 1067
[2024-05-04T06:13:59.507+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:13:59.495+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1067

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1067
[2024-05-04T06:13:59.509+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:13:59.537+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.068 seconds
[2024-05-04T06:14:30.206+0000] {processor.py:157} INFO - Started process (PID=1091) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:14:30.208+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:14:30.211+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:14:30.211+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:15:00.223+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:15:00.219+0000] {timeout.py:68} ERROR - Process timed out, PID: 1091
[2024-05-04T06:15:00.238+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:15:00.229+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1091

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1091
[2024-05-04T06:15:00.240+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:15:00.271+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.070 seconds
[2024-05-04T06:15:30.554+0000] {processor.py:157} INFO - Started process (PID=1115) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:15:30.555+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:15:30.556+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:15:30.556+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:16:00.562+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:16:00.559+0000] {timeout.py:68} ERROR - Process timed out, PID: 1115
[2024-05-04T06:16:00.570+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:16:00.565+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1115

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1115
[2024-05-04T06:16:00.572+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:16:00.603+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.050 seconds
[2024-05-04T06:16:31.322+0000] {processor.py:157} INFO - Started process (PID=1137) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:16:31.325+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:16:31.329+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:16:31.328+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:17:01.343+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:17:01.329+0000] {timeout.py:68} ERROR - Process timed out, PID: 1137
[2024-05-04T06:17:01.367+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:17:01.353+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1137

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1137
[2024-05-04T06:17:01.370+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:17:01.410+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.103 seconds
[2024-05-04T06:17:31.657+0000] {processor.py:157} INFO - Started process (PID=1161) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:17:31.659+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:17:31.663+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:17:31.662+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:18:01.671+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:18:01.668+0000] {timeout.py:68} ERROR - Process timed out, PID: 1161
[2024-05-04T06:18:01.693+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:18:01.685+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1161

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1161
[2024-05-04T06:18:01.694+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:18:01.722+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.072 seconds
[2024-05-04T06:18:32.127+0000] {processor.py:157} INFO - Started process (PID=1185) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:18:32.129+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:18:32.132+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:18:32.132+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:19:02.146+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:19:02.139+0000] {timeout.py:68} ERROR - Process timed out, PID: 1185
[2024-05-04T06:19:02.169+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:19:02.151+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1185

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1185
[2024-05-04T06:19:02.171+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:19:02.198+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.077 seconds
[2024-05-04T06:19:32.276+0000] {processor.py:157} INFO - Started process (PID=1209) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:19:32.277+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:19:32.280+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:19:32.280+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:20:02.286+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:20:02.284+0000] {timeout.py:68} ERROR - Process timed out, PID: 1209
[2024-05-04T06:20:02.291+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:20:02.287+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1209

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1209
[2024-05-04T06:20:02.291+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:20:02.307+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.035 seconds
[2024-05-04T06:20:33.057+0000] {processor.py:157} INFO - Started process (PID=1233) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:20:33.058+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:20:33.063+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:20:33.062+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:21:03.072+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:21:03.069+0000] {timeout.py:68} ERROR - Process timed out, PID: 1233
[2024-05-04T06:21:03.097+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:21:03.086+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1233

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1233
[2024-05-04T06:21:03.099+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:21:03.124+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.073 seconds
[2024-05-04T06:21:33.242+0000] {processor.py:157} INFO - Started process (PID=1257) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:21:33.244+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:21:33.251+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:21:33.250+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:22:03.267+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:22:03.260+0000] {timeout.py:68} ERROR - Process timed out, PID: 1257
[2024-05-04T06:22:03.280+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:22:03.271+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1257

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1257
[2024-05-04T06:22:03.282+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:22:03.314+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.079 seconds
[2024-05-04T06:22:33.699+0000] {processor.py:157} INFO - Started process (PID=1281) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:22:33.701+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:22:33.707+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:22:33.706+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:23:03.715+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:23:03.714+0000] {timeout.py:68} ERROR - Process timed out, PID: 1281
[2024-05-04T06:23:03.720+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:23:03.716+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1281

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1281
[2024-05-04T06:23:03.721+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:23:03.744+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.055 seconds
[2024-05-04T06:23:33.864+0000] {processor.py:157} INFO - Started process (PID=1305) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:23:33.865+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:23:33.871+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:23:33.870+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:24:03.884+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:24:03.878+0000] {timeout.py:68} ERROR - Process timed out, PID: 1305
[2024-05-04T06:24:03.908+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:24:03.890+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1305

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1305
[2024-05-04T06:24:03.911+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:24:03.934+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.078 seconds
[2024-05-04T06:24:34.586+0000] {processor.py:157} INFO - Started process (PID=1329) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:24:34.588+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:24:34.593+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:24:34.592+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:25:04.625+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:25:04.606+0000] {timeout.py:68} ERROR - Process timed out, PID: 1329
[2024-05-04T06:25:04.646+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:25:04.633+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1329

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1329
[2024-05-04T06:25:04.651+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:25:04.693+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.111 seconds
[2024-05-04T06:25:35.136+0000] {processor.py:157} INFO - Started process (PID=1353) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:25:35.137+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:25:35.143+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:25:35.142+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:26:05.178+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:26:05.157+0000] {timeout.py:68} ERROR - Process timed out, PID: 1353
[2024-05-04T06:26:05.204+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:26:05.189+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1353

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1353
[2024-05-04T06:26:05.208+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:26:05.249+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.119 seconds
[2024-05-04T06:26:35.471+0000] {processor.py:157} INFO - Started process (PID=1377) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:26:35.473+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:26:35.478+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:26:35.478+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:27:05.516+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:27:05.496+0000] {timeout.py:68} ERROR - Process timed out, PID: 1377
[2024-05-04T06:27:05.547+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:27:05.527+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1377

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1377
[2024-05-04T06:27:05.552+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:27:05.600+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.133 seconds
[2024-05-04T06:27:36.080+0000] {processor.py:157} INFO - Started process (PID=1401) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:27:36.081+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:27:36.084+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:27:36.084+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:28:06.116+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:28:06.097+0000] {timeout.py:68} ERROR - Process timed out, PID: 1401
[2024-05-04T06:28:06.140+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:28:06.126+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1401

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1401
[2024-05-04T06:28:06.145+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:28:06.191+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.115 seconds
[2024-05-04T06:28:36.586+0000] {processor.py:157} INFO - Started process (PID=1425) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:28:36.587+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:28:36.591+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:28:36.590+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:29:06.619+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:29:06.601+0000] {timeout.py:68} ERROR - Process timed out, PID: 1425
[2024-05-04T06:29:06.643+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:29:06.629+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1425

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1425
[2024-05-04T06:29:06.647+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:29:06.690+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.110 seconds
[2024-05-04T06:29:36.941+0000] {processor.py:157} INFO - Started process (PID=1449) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:29:36.942+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:29:36.945+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:29:36.945+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:30:06.982+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:30:06.963+0000] {timeout.py:68} ERROR - Process timed out, PID: 1449
[2024-05-04T06:30:07.005+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:30:06.992+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1449

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1449
[2024-05-04T06:30:07.009+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:30:07.056+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.116 seconds
[2024-05-04T06:30:37.449+0000] {processor.py:157} INFO - Started process (PID=1473) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:30:37.451+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:30:37.454+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:30:37.454+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:31:07.480+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:31:07.464+0000] {timeout.py:68} ERROR - Process timed out, PID: 1473
[2024-05-04T06:31:07.500+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:31:07.487+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1473

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1473
[2024-05-04T06:31:07.503+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:31:07.543+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.099 seconds
[2024-05-04T06:31:37.857+0000] {processor.py:157} INFO - Started process (PID=1497) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:31:37.858+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:31:37.860+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:31:37.859+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:32:07.871+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:32:07.865+0000] {timeout.py:68} ERROR - Process timed out, PID: 1497
[2024-05-04T06:32:07.881+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:32:07.875+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1497

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1497
[2024-05-04T06:32:07.883+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:32:07.928+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.073 seconds
[2024-05-04T06:32:38.257+0000] {processor.py:157} INFO - Started process (PID=1521) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:32:38.258+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:32:38.263+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:32:38.263+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:33:08.297+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:33:08.290+0000] {timeout.py:68} ERROR - Process timed out, PID: 1521
[2024-05-04T06:33:08.311+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:33:08.302+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1521

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1521
[2024-05-04T06:33:08.314+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:33:08.341+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.090 seconds
[2024-05-04T06:33:38.733+0000] {processor.py:157} INFO - Started process (PID=1545) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:33:38.734+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:33:38.739+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:33:38.738+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:34:08.768+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:34:08.756+0000] {timeout.py:68} ERROR - Process timed out, PID: 1545
[2024-05-04T06:34:08.783+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:34:08.772+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1545

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1545
[2024-05-04T06:34:08.787+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:34:08.822+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.095 seconds
[2024-05-04T06:34:39.115+0000] {processor.py:157} INFO - Started process (PID=1569) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:34:39.116+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:34:39.120+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:34:39.119+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:35:09.136+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:35:09.129+0000] {timeout.py:68} ERROR - Process timed out, PID: 1569
[2024-05-04T06:35:09.148+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:35:09.140+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1569

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1569
[2024-05-04T06:35:09.151+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:35:09.185+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.076 seconds
[2024-05-04T06:35:39.535+0000] {processor.py:157} INFO - Started process (PID=1593) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:35:39.536+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:35:39.538+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:35:39.538+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:36:09.583+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:36:09.543+0000] {timeout.py:68} ERROR - Process timed out, PID: 1593
[2024-05-04T06:36:09.614+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:36:09.602+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1593

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1593
[2024-05-04T06:36:09.616+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:36:09.649+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.118 seconds
[2024-05-04T06:36:39.868+0000] {processor.py:157} INFO - Started process (PID=1617) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:36:39.869+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:36:39.873+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:36:39.872+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:37:09.886+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:37:09.880+0000] {timeout.py:68} ERROR - Process timed out, PID: 1617
[2024-05-04T06:37:09.898+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:37:09.890+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1617

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1617
[2024-05-04T06:37:09.900+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:37:09.928+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.063 seconds
[2024-05-04T06:37:40.252+0000] {processor.py:157} INFO - Started process (PID=1641) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:37:40.253+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:37:40.256+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:37:40.256+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:38:10.270+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:38:10.261+0000] {timeout.py:68} ERROR - Process timed out, PID: 1641
[2024-05-04T06:38:10.283+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:38:10.274+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1641

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1641
[2024-05-04T06:38:10.287+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:38:10.347+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.098 seconds
[2024-05-04T06:38:40.595+0000] {processor.py:157} INFO - Started process (PID=1665) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:38:40.596+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:38:40.599+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:38:40.598+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:39:10.617+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:39:10.609+0000] {timeout.py:68} ERROR - Process timed out, PID: 1665
[2024-05-04T06:39:10.648+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:39:10.623+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1665

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1665
[2024-05-04T06:39:10.653+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:39:10.705+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.114 seconds
[2024-05-04T06:39:41.115+0000] {processor.py:157} INFO - Started process (PID=1689) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:39:41.116+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:39:41.118+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:39:41.118+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:40:11.161+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:40:11.137+0000] {timeout.py:68} ERROR - Process timed out, PID: 1689
[2024-05-04T06:40:11.190+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:40:11.171+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1689

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1689
[2024-05-04T06:40:11.195+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:40:11.255+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.142 seconds
[2024-05-04T06:40:41.482+0000] {processor.py:157} INFO - Started process (PID=1713) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:40:41.483+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:40:41.487+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:40:41.486+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:41:11.509+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:41:11.498+0000] {timeout.py:68} ERROR - Process timed out, PID: 1713
[2024-05-04T06:41:11.531+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:41:11.516+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1713

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1713
[2024-05-04T06:41:11.535+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:41:11.582+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.102 seconds
[2024-05-04T06:41:41.791+0000] {processor.py:157} INFO - Started process (PID=1737) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:41:41.792+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:41:41.796+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:41:41.795+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:42:11.821+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:42:11.804+0000] {timeout.py:68} ERROR - Process timed out, PID: 1737
[2024-05-04T06:42:11.845+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:42:11.828+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1737

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1737
[2024-05-04T06:42:11.850+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:42:11.935+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.152 seconds
[2024-05-04T06:42:42.423+0000] {processor.py:157} INFO - Started process (PID=1761) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:42:42.424+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:42:42.431+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:42:42.429+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:43:12.451+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:43:12.446+0000] {timeout.py:68} ERROR - Process timed out, PID: 1761
[2024-05-04T06:43:12.463+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:43:12.455+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1761

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1761
[2024-05-04T06:43:12.465+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:43:12.494+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.076 seconds
[2024-05-04T06:43:42.733+0000] {processor.py:157} INFO - Started process (PID=1785) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:43:42.734+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:43:42.737+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:43:42.737+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:44:12.763+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:44:12.749+0000] {timeout.py:68} ERROR - Process timed out, PID: 1785
[2024-05-04T06:44:12.786+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:44:12.772+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1785

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1785
[2024-05-04T06:44:12.791+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:44:12.834+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.106 seconds
[2024-05-04T06:44:43.063+0000] {processor.py:157} INFO - Started process (PID=1809) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:44:43.064+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:44:43.068+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:44:43.067+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:45:13.085+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:45:13.077+0000] {timeout.py:68} ERROR - Process timed out, PID: 1809
[2024-05-04T06:45:13.094+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:45:13.088+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1809

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1809
[2024-05-04T06:45:13.096+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:45:13.137+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.080 seconds
[2024-05-04T06:45:43.420+0000] {processor.py:157} INFO - Started process (PID=1833) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:45:43.421+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:45:43.424+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:45:43.424+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:46:13.458+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:46:13.435+0000] {timeout.py:68} ERROR - Process timed out, PID: 1833
[2024-05-04T06:46:13.485+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:46:13.468+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1833

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1833
[2024-05-04T06:46:13.490+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:46:13.548+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.132 seconds
[2024-05-04T06:46:43.993+0000] {processor.py:157} INFO - Started process (PID=1857) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:46:43.994+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:46:43.998+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:46:43.998+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:47:14.034+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:47:14.011+0000] {timeout.py:68} ERROR - Process timed out, PID: 1857
[2024-05-04T06:47:14.054+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:47:14.042+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1857

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1857
[2024-05-04T06:47:14.058+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:47:14.114+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.130 seconds
[2024-05-04T06:47:44.423+0000] {processor.py:157} INFO - Started process (PID=1881) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:47:44.425+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:47:44.430+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:47:44.429+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:48:14.460+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:48:14.444+0000] {timeout.py:68} ERROR - Process timed out, PID: 1881
[2024-05-04T06:48:14.483+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:48:14.469+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1881

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1881
[2024-05-04T06:48:14.486+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:48:14.524+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.108 seconds
[2024-05-04T06:48:44.921+0000] {processor.py:157} INFO - Started process (PID=1905) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:48:44.922+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:48:44.926+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:48:44.925+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:49:14.968+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:49:14.945+0000] {timeout.py:68} ERROR - Process timed out, PID: 1905
[2024-05-04T06:49:14.989+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:49:14.982+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1905

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1905
[2024-05-04T06:49:14.991+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:49:15.037+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.124 seconds
[2024-05-04T06:49:45.315+0000] {processor.py:157} INFO - Started process (PID=1929) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:49:45.316+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:49:45.319+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:49:45.318+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:50:15.332+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:50:15.325+0000] {timeout.py:68} ERROR - Process timed out, PID: 1929
[2024-05-04T06:50:15.344+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:50:15.336+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1929

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1929
[2024-05-04T06:50:15.346+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:50:15.388+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.077 seconds
[2024-05-04T06:50:45.925+0000] {processor.py:157} INFO - Started process (PID=1953) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:50:45.927+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:50:45.931+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:50:45.930+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:51:15.939+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:51:15.936+0000] {timeout.py:68} ERROR - Process timed out, PID: 1953
[2024-05-04T06:51:15.945+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:51:15.941+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1953

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1953
[2024-05-04T06:51:15.946+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:51:15.967+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.048 seconds
[2024-05-04T06:51:46.321+0000] {processor.py:157} INFO - Started process (PID=1977) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:51:46.323+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:51:46.327+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:51:46.327+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:52:16.360+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:52:16.340+0000] {timeout.py:68} ERROR - Process timed out, PID: 1977
[2024-05-04T06:52:16.383+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:52:16.369+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1977

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1977
[2024-05-04T06:52:16.388+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:52:16.425+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.112 seconds
[2024-05-04T06:52:46.751+0000] {processor.py:157} INFO - Started process (PID=2001) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:52:46.753+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:52:46.757+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:52:46.756+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:53:16.786+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:53:16.769+0000] {timeout.py:68} ERROR - Process timed out, PID: 2001
[2024-05-04T06:53:16.816+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:53:16.794+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2001

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2001
[2024-05-04T06:53:16.819+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:53:16.849+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.104 seconds
[2024-05-04T06:53:47.085+0000] {processor.py:157} INFO - Started process (PID=2025) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:53:47.086+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:53:47.090+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:53:47.089+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:54:17.126+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:54:17.102+0000] {timeout.py:68} ERROR - Process timed out, PID: 2025
[2024-05-04T06:54:17.142+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:54:17.131+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2025

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2025
[2024-05-04T06:54:17.144+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:54:17.171+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.093 seconds
[2024-05-04T06:54:47.924+0000] {processor.py:157} INFO - Started process (PID=2049) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:54:47.926+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:54:47.929+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:54:47.929+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:55:17.958+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:55:17.940+0000] {timeout.py:68} ERROR - Process timed out, PID: 2049
[2024-05-04T06:55:17.976+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:55:17.964+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2049

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2049
[2024-05-04T06:55:17.979+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:55:18.021+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.103 seconds
[2024-05-04T06:55:48.325+0000] {processor.py:157} INFO - Started process (PID=2073) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:55:48.326+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:55:48.329+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:55:48.329+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:56:18.354+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:56:18.339+0000] {timeout.py:68} ERROR - Process timed out, PID: 2073
[2024-05-04T06:56:18.375+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:56:18.362+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2073

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2073
[2024-05-04T06:56:18.379+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:56:18.420+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.101 seconds
[2024-05-04T06:56:49.163+0000] {processor.py:157} INFO - Started process (PID=2098) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:56:49.165+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:56:49.168+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:56:49.168+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:57:19.188+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:57:19.179+0000] {timeout.py:68} ERROR - Process timed out, PID: 2098
[2024-05-04T06:57:19.205+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:57:19.194+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2098

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2098
[2024-05-04T06:57:19.208+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:57:19.239+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.082 seconds
[2024-05-04T06:57:49.466+0000] {processor.py:157} INFO - Started process (PID=2122) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:57:49.466+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:57:49.468+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:57:49.468+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:58:19.496+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:58:19.478+0000] {timeout.py:68} ERROR - Process timed out, PID: 2122
[2024-05-04T06:58:19.515+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:58:19.505+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2122

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2122
[2024-05-04T06:58:19.519+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:58:19.589+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.125 seconds
[2024-05-04T06:58:50.031+0000] {processor.py:157} INFO - Started process (PID=2144) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:58:50.032+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:58:50.041+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:58:50.039+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T06:59:20.067+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:59:20.058+0000] {timeout.py:68} ERROR - Process timed out, PID: 2144
[2024-05-04T06:59:20.084+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:59:20.072+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2144

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2144
[2024-05-04T06:59:20.087+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T06:59:20.130+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.107 seconds
[2024-05-04T06:59:50.531+0000] {processor.py:157} INFO - Started process (PID=2168) to work on /opt/airflow/dags/train_model.py
[2024-05-04T06:59:50.532+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T06:59:50.539+0000] {logging_mixin.py:151} INFO - [2024-05-04T06:59:50.537+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:00:20.576+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:00:20.560+0000] {timeout.py:68} ERROR - Process timed out, PID: 2168
[2024-05-04T07:00:20.607+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:00:20.587+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2168

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2168
[2024-05-04T07:00:20.610+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:00:20.646+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.124 seconds
[2024-05-04T07:00:50.950+0000] {processor.py:157} INFO - Started process (PID=2192) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:00:50.951+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:00:50.959+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:00:50.958+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:01:20.977+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:01:20.968+0000] {timeout.py:68} ERROR - Process timed out, PID: 2192
[2024-05-04T07:01:20.991+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:01:20.982+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2192

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2192
[2024-05-04T07:01:20.995+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:01:21.033+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.092 seconds
[2024-05-04T07:01:51.229+0000] {processor.py:157} INFO - Started process (PID=2216) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:01:51.231+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:01:51.237+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:01:51.236+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:02:21.226+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:02:21.216+0000] {timeout.py:68} ERROR - Process timed out, PID: 2216
[2024-05-04T07:02:21.245+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:02:21.234+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2216

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2216
[2024-05-04T07:02:21.250+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:02:21.294+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.109 seconds
[2024-05-04T07:02:51.646+0000] {processor.py:157} INFO - Started process (PID=2239) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:02:51.647+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:02:51.652+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:02:51.652+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:03:21.677+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:03:21.662+0000] {timeout.py:68} ERROR - Process timed out, PID: 2239
[2024-05-04T07:03:21.700+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:03:21.685+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2239

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2239
[2024-05-04T07:03:21.702+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:03:21.761+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.124 seconds
[2024-05-04T07:03:51.937+0000] {processor.py:157} INFO - Started process (PID=2263) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:03:51.938+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:03:51.940+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:03:51.940+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:04:21.953+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:04:21.947+0000] {timeout.py:68} ERROR - Process timed out, PID: 2263
[2024-05-04T07:04:21.963+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:04:21.956+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2263

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2263
[2024-05-04T07:04:21.965+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:04:22.011+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.077 seconds
[2024-05-04T07:04:52.507+0000] {processor.py:157} INFO - Started process (PID=2287) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:04:52.508+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:04:52.519+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:04:52.515+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:05:22.564+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:05:22.541+0000] {timeout.py:68} ERROR - Process timed out, PID: 2287
[2024-05-04T07:05:22.601+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:05:22.575+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2287

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2287
[2024-05-04T07:05:22.605+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:05:22.657+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.156 seconds
[2024-05-04T07:05:53.026+0000] {processor.py:157} INFO - Started process (PID=2311) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:05:53.028+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:05:53.035+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:05:53.034+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:06:23.054+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:06:23.048+0000] {timeout.py:68} ERROR - Process timed out, PID: 2311
[2024-05-04T07:06:23.066+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:06:23.060+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2311

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2311
[2024-05-04T07:06:23.068+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:06:23.094+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.072 seconds
[2024-05-04T07:06:53.429+0000] {processor.py:157} INFO - Started process (PID=2359) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:06:53.430+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:06:53.432+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:06:53.431+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:07:23.448+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:07:23.439+0000] {timeout.py:68} ERROR - Process timed out, PID: 2359
[2024-05-04T07:07:23.465+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:07:23.455+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2359

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2359
[2024-05-04T07:07:23.468+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:07:23.505+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.079 seconds
[2024-05-04T07:07:53.899+0000] {processor.py:157} INFO - Started process (PID=2402) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:07:53.900+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:07:53.902+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:07:53.901+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:08:23.930+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:08:23.907+0000] {timeout.py:68} ERROR - Process timed out, PID: 2402
[2024-05-04T07:08:23.945+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:08:23.939+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2402

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2402
[2024-05-04T07:08:23.948+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:08:23.978+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.085 seconds
[2024-05-04T07:08:54.297+0000] {processor.py:157} INFO - Started process (PID=2448) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:08:54.298+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:08:54.301+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:08:54.301+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:09:24.317+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:09:24.313+0000] {timeout.py:68} ERROR - Process timed out, PID: 2448
[2024-05-04T07:09:24.326+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:09:24.320+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2448

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2448
[2024-05-04T07:09:24.328+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:09:24.351+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.053 seconds
[2024-05-04T07:09:54.749+0000] {processor.py:157} INFO - Started process (PID=2494) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:09:54.750+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:09:54.753+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:09:54.752+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:10:24.777+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:10:24.766+0000] {timeout.py:68} ERROR - Process timed out, PID: 2494
[2024-05-04T07:10:24.795+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:10:24.782+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2494

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2494
[2024-05-04T07:10:24.798+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:10:24.843+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.099 seconds
[2024-05-04T07:10:55.301+0000] {processor.py:157} INFO - Started process (PID=2541) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:10:55.303+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:10:55.308+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:10:55.307+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:11:25.343+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:11:25.325+0000] {timeout.py:68} ERROR - Process timed out, PID: 2541
[2024-05-04T07:11:25.368+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:11:25.354+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2541

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2541
[2024-05-04T07:11:25.374+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:11:25.411+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.116 seconds
[2024-05-04T07:11:55.551+0000] {processor.py:157} INFO - Started process (PID=2601) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:11:55.553+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:11:55.557+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:11:55.557+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:12:25.594+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:12:25.570+0000] {timeout.py:68} ERROR - Process timed out, PID: 2601
[2024-05-04T07:12:25.627+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:12:25.604+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2601

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2601
[2024-05-04T07:12:25.633+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:12:25.718+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.173 seconds
[2024-05-04T07:12:56.276+0000] {processor.py:157} INFO - Started process (PID=2667) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:12:56.279+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:12:56.281+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:12:56.281+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:13:26.309+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:13:26.297+0000] {timeout.py:68} ERROR - Process timed out, PID: 2667
[2024-05-04T07:13:26.330+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:13:26.316+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2667

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2667
[2024-05-04T07:13:26.335+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:13:26.374+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.106 seconds
[2024-05-04T07:13:56.586+0000] {processor.py:157} INFO - Started process (PID=2727) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:13:56.587+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:13:56.588+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:13:56.588+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:14:26.616+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:14:26.601+0000] {timeout.py:68} ERROR - Process timed out, PID: 2727
[2024-05-04T07:14:26.636+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:14:26.623+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2727

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2727
[2024-05-04T07:14:26.641+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:14:26.694+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.111 seconds
[2024-05-04T07:14:57.365+0000] {processor.py:157} INFO - Started process (PID=2780) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:14:57.365+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:14:57.367+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:14:57.367+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:15:27.420+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:15:27.412+0000] {timeout.py:68} ERROR - Process timed out, PID: 2780
[2024-05-04T07:15:27.434+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:15:27.425+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2780

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2780
[2024-05-04T07:15:27.440+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:15:27.501+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.139 seconds
[2024-05-04T07:15:58.287+0000] {processor.py:157} INFO - Started process (PID=2846) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:15:58.289+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:15:58.291+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:15:58.290+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:16:28.327+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:16:28.306+0000] {timeout.py:68} ERROR - Process timed out, PID: 2846
[2024-05-04T07:16:28.350+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:16:28.337+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2846

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2846
[2024-05-04T07:16:28.356+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:16:28.395+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.113 seconds
[2024-05-04T07:16:58.545+0000] {processor.py:157} INFO - Started process (PID=2882) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:16:58.546+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:16:58.547+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:16:58.547+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:17:28.559+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:17:28.551+0000] {timeout.py:68} ERROR - Process timed out, PID: 2882
[2024-05-04T07:17:28.574+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:17:28.564+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2882

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2882
[2024-05-04T07:17:28.578+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:17:28.608+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.075 seconds
[2024-05-04T07:17:59.306+0000] {processor.py:157} INFO - Started process (PID=2918) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:17:59.308+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:17:59.310+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:17:59.309+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:18:29.339+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:18:29.321+0000] {timeout.py:68} ERROR - Process timed out, PID: 2918
[2024-05-04T07:18:29.397+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:18:29.361+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2918

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2918
[2024-05-04T07:18:29.399+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:18:29.433+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.133 seconds
[2024-05-04T07:19:00.011+0000] {processor.py:157} INFO - Started process (PID=2953) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:19:00.013+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:19:00.014+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:19:00.013+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:19:30.033+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:19:30.018+0000] {timeout.py:68} ERROR - Process timed out, PID: 2953
[2024-05-04T07:19:30.064+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:19:30.051+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2953

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2953
[2024-05-04T07:19:30.067+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:19:30.102+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.100 seconds
[2024-05-04T07:20:00.419+0000] {processor.py:157} INFO - Started process (PID=2989) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:20:00.421+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:20:00.423+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:20:00.422+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:20:30.441+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:20:30.433+0000] {timeout.py:68} ERROR - Process timed out, PID: 2989
[2024-05-04T07:20:30.459+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:20:30.447+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2989

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2989
[2024-05-04T07:20:30.464+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:20:30.524+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.115 seconds
[2024-05-04T07:21:00.679+0000] {processor.py:157} INFO - Started process (PID=3025) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:21:00.681+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:21:00.682+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:21:00.682+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:21:30.700+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:21:30.691+0000] {timeout.py:68} ERROR - Process timed out, PID: 3025
[2024-05-04T07:21:30.712+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:21:30.705+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3025

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3025
[2024-05-04T07:21:30.715+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:21:30.747+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.075 seconds
[2024-05-04T07:22:00.880+0000] {processor.py:157} INFO - Started process (PID=3061) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:22:00.882+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:22:00.884+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:22:00.883+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:22:30.896+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:22:30.890+0000] {timeout.py:68} ERROR - Process timed out, PID: 3061
[2024-05-04T07:22:30.929+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:22:30.914+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3061

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3061
[2024-05-04T07:22:30.934+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:22:30.969+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.097 seconds
[2024-05-04T07:23:01.105+0000] {processor.py:157} INFO - Started process (PID=3097) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:23:01.107+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:23:01.110+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:23:01.109+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:23:31.151+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:23:31.137+0000] {timeout.py:68} ERROR - Process timed out, PID: 3097
[2024-05-04T07:23:31.173+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:23:31.161+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3097

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3097
[2024-05-04T07:23:31.177+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:23:31.225+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.125 seconds
[2024-05-04T07:24:02.047+0000] {processor.py:157} INFO - Started process (PID=3133) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:24:02.048+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:24:02.050+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:24:02.049+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:24:32.074+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:24:32.068+0000] {timeout.py:68} ERROR - Process timed out, PID: 3133
[2024-05-04T07:24:32.083+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:24:32.078+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3133

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3133
[2024-05-04T07:24:32.085+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:24:32.120+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.082 seconds
[2024-05-04T07:25:02.795+0000] {processor.py:157} INFO - Started process (PID=3169) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:25:02.796+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:25:02.797+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:25:02.797+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:25:32.818+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:25:32.808+0000] {timeout.py:68} ERROR - Process timed out, PID: 3169
[2024-05-04T07:25:32.830+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:25:32.823+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3169

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3169
[2024-05-04T07:25:32.833+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:25:32.865+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.076 seconds
[2024-05-04T07:26:03.174+0000] {processor.py:157} INFO - Started process (PID=3205) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:26:03.175+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:26:03.177+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:26:03.176+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:26:33.205+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:26:33.193+0000] {timeout.py:68} ERROR - Process timed out, PID: 3205
[2024-05-04T07:26:33.223+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:26:33.214+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3205

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3205
[2024-05-04T07:26:33.227+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:26:33.261+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.091 seconds
[2024-05-04T07:27:03.489+0000] {processor.py:157} INFO - Started process (PID=3241) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:27:03.492+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:27:03.493+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:27:03.493+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:27:33.504+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:27:33.500+0000] {timeout.py:68} ERROR - Process timed out, PID: 3241
[2024-05-04T07:27:33.512+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:27:33.507+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3241

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3241
[2024-05-04T07:27:33.513+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:27:33.535+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.051 seconds
[2024-05-04T07:28:03.883+0000] {processor.py:157} INFO - Started process (PID=3272) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:28:03.885+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:28:03.886+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:28:03.886+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:28:18.821+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:28:18.816+0000] {process_utils.py:259} INFO - Waiting up to 5 seconds for processes to exit...
[2024-05-04T07:29:48.264+0000] {processor.py:157} INFO - Started process (PID=61) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:29:48.266+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:29:48.268+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:29:48.267+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:30:18.279+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:30:18.270+0000] {timeout.py:68} ERROR - Process timed out, PID: 61
[2024-05-04T07:30:18.316+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:30:18.284+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 61

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 61
[2024-05-04T07:30:18.319+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:30:18.375+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.116 seconds
[2024-05-04T07:31:47.537+0000] {processor.py:157} INFO - Started process (PID=66) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:31:47.538+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:31:47.541+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:31:47.541+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:32:17.570+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:32:17.553+0000] {timeout.py:68} ERROR - Process timed out, PID: 66
[2024-05-04T07:32:17.590+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:32:17.578+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 66

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 66
[2024-05-04T07:32:17.596+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:32:17.649+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.118 seconds
[2024-05-04T07:32:48.336+0000] {processor.py:157} INFO - Started process (PID=95) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:32:48.338+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:32:48.341+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:32:48.340+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:33:18.374+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:33:18.358+0000] {timeout.py:68} ERROR - Process timed out, PID: 95
[2024-05-04T07:33:18.397+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:33:18.383+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 95

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 95
[2024-05-04T07:33:18.402+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:33:18.449+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.111 seconds
[2024-05-04T07:33:48.573+0000] {processor.py:157} INFO - Started process (PID=130) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:33:48.575+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:33:48.580+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:33:48.580+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:34:18.586+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:34:18.585+0000] {timeout.py:68} ERROR - Process timed out, PID: 130
[2024-05-04T07:34:18.591+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:34:18.587+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 130

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 130
[2024-05-04T07:34:18.593+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:34:18.616+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.052 seconds
[2024-05-04T07:34:49.225+0000] {processor.py:157} INFO - Started process (PID=166) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:34:49.226+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:34:49.227+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:34:49.227+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:35:19.256+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:35:19.242+0000] {timeout.py:68} ERROR - Process timed out, PID: 166
[2024-05-04T07:35:19.275+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:35:19.264+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 166

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 166
[2024-05-04T07:35:19.279+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:35:19.320+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.098 seconds
[2024-05-04T07:35:49.450+0000] {processor.py:157} INFO - Started process (PID=202) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:35:49.453+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:35:49.467+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:35:49.461+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:36:19.489+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:36:19.480+0000] {timeout.py:68} ERROR - Process timed out, PID: 202
[2024-05-04T07:36:19.505+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:36:19.495+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 202

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 202
[2024-05-04T07:36:19.508+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:36:19.551+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.116 seconds
[2024-05-04T07:36:50.033+0000] {processor.py:157} INFO - Started process (PID=239) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:36:50.035+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:36:50.041+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:36:50.040+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:37:20.065+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:37:20.053+0000] {timeout.py:68} ERROR - Process timed out, PID: 239
[2024-05-04T07:37:20.086+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:37:20.072+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 239

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 239
[2024-05-04T07:37:20.091+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:37:20.134+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.109 seconds
[2024-05-04T07:37:50.196+0000] {processor.py:157} INFO - Started process (PID=275) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:37:50.197+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:37:50.200+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:37:50.200+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:38:20.211+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:38:20.205+0000] {timeout.py:68} ERROR - Process timed out, PID: 275
[2024-05-04T07:38:20.232+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:38:20.225+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 275

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 275
[2024-05-04T07:38:20.235+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:38:20.266+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.075 seconds
[2024-05-04T07:38:50.631+0000] {processor.py:157} INFO - Started process (PID=311) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:38:50.633+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:38:50.638+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:38:50.637+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:39:20.658+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:39:20.651+0000] {timeout.py:68} ERROR - Process timed out, PID: 311
[2024-05-04T07:39:20.670+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:39:20.662+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 311

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 311
[2024-05-04T07:39:20.673+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:39:20.706+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.081 seconds
[2024-05-04T07:39:51.414+0000] {processor.py:157} INFO - Started process (PID=347) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:39:51.415+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:39:51.420+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:39:51.419+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:40:21.430+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:40:21.426+0000] {timeout.py:68} ERROR - Process timed out, PID: 347
[2024-05-04T07:40:21.447+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:40:21.436+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 347

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 347
[2024-05-04T07:40:21.450+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:40:21.484+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.078 seconds
[2024-05-04T07:40:52.000+0000] {processor.py:157} INFO - Started process (PID=383) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:40:52.002+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:40:52.010+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:40:52.009+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:41:22.047+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:41:22.029+0000] {timeout.py:68} ERROR - Process timed out, PID: 383
[2024-05-04T07:41:22.070+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:41:22.056+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 383

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 383
[2024-05-04T07:41:22.075+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:41:22.122+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.129 seconds
[2024-05-04T07:41:52.792+0000] {processor.py:157} INFO - Started process (PID=419) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:41:52.794+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:41:52.800+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:41:52.799+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:42:22.833+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:42:22.811+0000] {timeout.py:68} ERROR - Process timed out, PID: 419
[2024-05-04T07:42:22.859+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:42:22.845+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 419

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 419
[2024-05-04T07:42:22.864+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:42:22.916+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.131 seconds
[2024-05-04T07:42:53.345+0000] {processor.py:157} INFO - Started process (PID=455) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:42:53.346+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:42:53.350+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:42:53.349+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:43:23.373+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:43:23.359+0000] {timeout.py:68} ERROR - Process timed out, PID: 455
[2024-05-04T07:43:23.393+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:43:23.381+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 455

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 455
[2024-05-04T07:43:23.397+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:43:23.447+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.108 seconds
[2024-05-04T07:43:53.740+0000] {processor.py:157} INFO - Started process (PID=491) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:43:53.741+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:43:53.743+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:43:53.743+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:44:23.752+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:44:23.747+0000] {timeout.py:68} ERROR - Process timed out, PID: 491
[2024-05-04T07:44:23.759+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:44:23.754+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 491

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 491
[2024-05-04T07:44:23.760+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:44:23.782+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.045 seconds
[2024-05-04T07:44:54.448+0000] {processor.py:157} INFO - Started process (PID=527) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:44:54.450+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:44:54.453+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:44:54.452+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:45:24.481+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:45:24.464+0000] {timeout.py:68} ERROR - Process timed out, PID: 527
[2024-05-04T07:45:24.508+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:45:24.496+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 527

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 527
[2024-05-04T07:45:24.511+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:45:24.543+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.099 seconds
[2024-05-04T07:45:54.876+0000] {processor.py:157} INFO - Started process (PID=563) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:45:54.877+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:45:54.880+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:45:54.879+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:46:24.901+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:46:24.889+0000] {timeout.py:68} ERROR - Process timed out, PID: 563
[2024-05-04T07:46:24.916+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:46:24.907+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 563

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 563
[2024-05-04T07:46:24.920+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:46:24.960+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.087 seconds
[2024-05-04T07:46:55.150+0000] {processor.py:157} INFO - Started process (PID=599) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:46:55.152+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:46:55.156+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:46:55.155+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:47:25.179+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:47:25.166+0000] {timeout.py:68} ERROR - Process timed out, PID: 599
[2024-05-04T07:47:25.197+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:47:25.187+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 599

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 599
[2024-05-04T07:47:25.201+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:47:25.235+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.089 seconds
[2024-05-04T07:47:55.771+0000] {processor.py:157} INFO - Started process (PID=635) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:47:55.772+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:47:55.777+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:47:55.776+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:48:25.786+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:48:25.781+0000] {timeout.py:68} ERROR - Process timed out, PID: 635
[2024-05-04T07:48:25.803+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:48:25.792+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 635

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 635
[2024-05-04T07:48:25.806+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:48:25.846+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.080 seconds
[2024-05-04T07:48:56.004+0000] {processor.py:157} INFO - Started process (PID=671) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:48:56.005+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:48:56.008+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:48:56.008+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:49:25.991+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:49:25.988+0000] {timeout.py:68} ERROR - Process timed out, PID: 671
[2024-05-04T07:49:26.004+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:49:25.996+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 671

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 671
[2024-05-04T07:49:26.006+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:49:26.032+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.058 seconds
[2024-05-04T07:49:56.265+0000] {processor.py:157} INFO - Started process (PID=707) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:49:56.266+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:49:56.270+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:49:56.269+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:50:26.288+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:50:26.279+0000] {timeout.py:68} ERROR - Process timed out, PID: 707
[2024-05-04T07:50:26.306+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:50:26.294+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 707

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 707
[2024-05-04T07:50:26.309+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:50:26.347+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.088 seconds
[2024-05-04T07:50:56.494+0000] {processor.py:157} INFO - Started process (PID=743) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:50:56.495+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:50:56.498+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:50:56.497+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:51:26.520+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:51:26.505+0000] {timeout.py:68} ERROR - Process timed out, PID: 743
[2024-05-04T07:51:26.536+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:51:26.526+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 743

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 743
[2024-05-04T07:51:26.540+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:51:26.574+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.084 seconds
[2024-05-04T07:51:57.055+0000] {processor.py:157} INFO - Started process (PID=779) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:51:57.056+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:51:57.059+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:51:57.059+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:52:27.070+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:52:27.065+0000] {timeout.py:68} ERROR - Process timed out, PID: 779
[2024-05-04T07:52:27.077+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:52:27.072+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 779

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 779
[2024-05-04T07:52:27.080+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:52:27.120+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.070 seconds
[2024-05-04T07:52:57.252+0000] {processor.py:157} INFO - Started process (PID=815) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:52:57.252+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:52:57.254+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:52:57.254+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:53:27.275+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:53:27.266+0000] {timeout.py:68} ERROR - Process timed out, PID: 815
[2024-05-04T07:53:27.300+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:53:27.283+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 815

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 815
[2024-05-04T07:53:27.305+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:53:27.360+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.111 seconds
[2024-05-04T07:53:57.448+0000] {processor.py:157} INFO - Started process (PID=845) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:53:57.450+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:53:57.454+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:53:57.454+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:54:27.473+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:54:27.461+0000] {timeout.py:68} ERROR - Process timed out, PID: 845
[2024-05-04T07:54:27.486+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:54:27.477+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 845

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 845
[2024-05-04T07:54:27.488+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:54:27.522+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.077 seconds
[2024-05-04T07:54:57.600+0000] {processor.py:157} INFO - Started process (PID=881) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:54:57.601+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:54:57.604+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:54:57.603+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:55:27.636+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:55:27.617+0000] {timeout.py:68} ERROR - Process timed out, PID: 881
[2024-05-04T07:55:27.650+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:55:27.642+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 881

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 881
[2024-05-04T07:55:27.653+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:55:27.696+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.100 seconds
[2024-05-04T07:55:58.380+0000] {processor.py:157} INFO - Started process (PID=916) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:55:58.381+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:55:58.385+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:55:58.385+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:56:28.417+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:56:28.399+0000] {timeout.py:68} ERROR - Process timed out, PID: 916
[2024-05-04T07:56:28.440+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:56:28.426+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 916

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 916
[2024-05-04T07:56:28.445+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:56:28.487+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.113 seconds
[2024-05-04T07:56:58.741+0000] {processor.py:157} INFO - Started process (PID=952) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:56:58.743+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:56:58.746+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:56:58.745+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:57:28.767+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:57:28.756+0000] {timeout.py:68} ERROR - Process timed out, PID: 952
[2024-05-04T07:57:28.784+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:57:28.774+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 952

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 952
[2024-05-04T07:57:28.788+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:57:28.832+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.097 seconds
[2024-05-04T07:57:58.892+0000] {processor.py:157} INFO - Started process (PID=988) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:57:58.893+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:57:58.895+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:57:58.894+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:58:28.911+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:58:28.901+0000] {timeout.py:68} ERROR - Process timed out, PID: 988
[2024-05-04T07:58:28.928+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:58:28.916+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 988

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 988
[2024-05-04T07:58:28.932+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:58:28.970+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.080 seconds
[2024-05-04T07:58:59.637+0000] {processor.py:157} INFO - Started process (PID=1024) to work on /opt/airflow/dags/train_model.py
[2024-05-04T07:58:59.638+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T07:58:59.641+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:58:59.640+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T07:59:29.654+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:59:29.647+0000] {timeout.py:68} ERROR - Process timed out, PID: 1024
[2024-05-04T07:59:29.680+0000] {logging_mixin.py:151} INFO - [2024-05-04T07:59:29.665+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1024

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1024
[2024-05-04T07:59:29.684+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T07:59:29.718+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.087 seconds
[2024-05-04T08:00:00.025+0000] {processor.py:157} INFO - Started process (PID=1060) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:00:00.026+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:00:00.029+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:00:00.028+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:00:30.044+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:00:30.035+0000] {timeout.py:68} ERROR - Process timed out, PID: 1060
[2024-05-04T08:00:30.058+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:00:30.050+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1060

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1060
[2024-05-04T08:00:30.061+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:00:30.096+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.077 seconds
[2024-05-04T08:01:00.856+0000] {processor.py:157} INFO - Started process (PID=1096) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:01:00.857+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:01:00.860+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:01:00.859+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:01:30.879+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:01:30.870+0000] {timeout.py:68} ERROR - Process timed out, PID: 1096
[2024-05-04T08:01:30.897+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:01:30.885+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1096

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1096
[2024-05-04T08:01:30.900+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:01:30.937+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.085 seconds
[2024-05-04T08:02:01.242+0000] {processor.py:157} INFO - Started process (PID=1132) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:02:01.244+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:02:01.247+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:02:01.246+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:02:31.271+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:02:31.256+0000] {timeout.py:68} ERROR - Process timed out, PID: 1132
[2024-05-04T08:02:31.292+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:02:31.284+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1132

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1132
[2024-05-04T08:02:31.295+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:02:31.330+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.092 seconds
[2024-05-04T08:03:01.523+0000] {processor.py:157} INFO - Started process (PID=1168) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:03:01.525+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:03:01.527+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:03:01.527+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:03:31.546+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:03:31.537+0000] {timeout.py:68} ERROR - Process timed out, PID: 1168
[2024-05-04T08:03:31.562+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:03:31.551+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1168

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1168
[2024-05-04T08:03:31.566+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:03:31.603+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.084 seconds
[2024-05-04T08:04:01.663+0000] {processor.py:157} INFO - Started process (PID=1204) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:04:01.663+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:04:01.665+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:04:01.664+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:04:31.710+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:04:31.702+0000] {timeout.py:68} ERROR - Process timed out, PID: 1204
[2024-05-04T08:04:31.726+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:04:31.715+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1204

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1204
[2024-05-04T08:04:31.730+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:04:31.769+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.088 seconds
[2024-05-04T08:05:01.905+0000] {processor.py:157} INFO - Started process (PID=1238) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:05:01.906+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:05:01.911+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:05:01.910+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:05:31.938+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:05:31.931+0000] {timeout.py:68} ERROR - Process timed out, PID: 1238
[2024-05-04T08:05:31.949+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:05:31.943+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1238

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1238
[2024-05-04T08:05:31.951+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:05:31.985+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.089 seconds
[2024-05-04T08:06:02.421+0000] {processor.py:157} INFO - Started process (PID=1274) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:06:02.422+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:06:02.424+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:06:02.424+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:06:32.440+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:06:32.433+0000] {timeout.py:68} ERROR - Process timed out, PID: 1274
[2024-05-04T08:06:32.456+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:06:32.447+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1274

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1274
[2024-05-04T08:06:32.459+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:06:32.491+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.074 seconds
[2024-05-04T08:07:02.694+0000] {processor.py:157} INFO - Started process (PID=1310) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:07:02.695+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:07:02.698+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:07:02.698+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:07:32.713+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:07:32.705+0000] {timeout.py:68} ERROR - Process timed out, PID: 1310
[2024-05-04T08:07:32.726+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:07:32.717+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1310

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1310
[2024-05-04T08:07:32.730+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:07:32.770+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.082 seconds
[2024-05-04T08:08:03.165+0000] {processor.py:157} INFO - Started process (PID=1346) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:08:03.166+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:08:03.168+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:08:03.168+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:08:33.190+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:08:33.177+0000] {timeout.py:68} ERROR - Process timed out, PID: 1346
[2024-05-04T08:08:33.218+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:08:33.200+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1346

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1346
[2024-05-04T08:08:33.221+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:08:33.256+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.094 seconds
[2024-05-04T08:09:03.547+0000] {processor.py:157} INFO - Started process (PID=1382) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:09:03.549+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:09:03.551+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:09:03.551+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:09:33.564+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:09:33.561+0000] {timeout.py:68} ERROR - Process timed out, PID: 1382
[2024-05-04T08:09:33.569+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:09:33.566+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1382

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1382
[2024-05-04T08:09:33.570+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:09:33.588+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.043 seconds
[2024-05-04T08:10:03.959+0000] {processor.py:157} INFO - Started process (PID=1418) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:10:03.960+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:10:03.963+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:10:03.963+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:10:33.982+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:10:33.977+0000] {timeout.py:68} ERROR - Process timed out, PID: 1418
[2024-05-04T08:10:33.990+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:10:33.985+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1418

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1418
[2024-05-04T08:10:33.992+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:10:34.017+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.055 seconds
[2024-05-04T08:11:04.253+0000] {processor.py:157} INFO - Started process (PID=1454) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:11:04.254+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:11:04.255+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:11:04.255+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:11:34.262+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:11:34.260+0000] {timeout.py:68} ERROR - Process timed out, PID: 1454
[2024-05-04T08:11:34.267+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:11:34.264+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1454

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1454
[2024-05-04T08:11:34.268+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:11:34.287+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.037 seconds
[2024-05-04T08:12:04.911+0000] {processor.py:157} INFO - Started process (PID=1485) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:12:04.912+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:12:04.915+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:12:04.915+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:12:34.925+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:12:34.920+0000] {timeout.py:68} ERROR - Process timed out, PID: 1485
[2024-05-04T08:12:34.934+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:12:34.929+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1485

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1485
[2024-05-04T08:12:34.936+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:12:34.961+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.054 seconds
[2024-05-04T08:13:05.625+0000] {processor.py:157} INFO - Started process (PID=1520) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:13:05.626+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:13:05.630+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:13:05.629+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:13:35.657+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:13:35.640+0000] {timeout.py:68} ERROR - Process timed out, PID: 1520
[2024-05-04T08:13:35.680+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:13:35.666+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1520

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1520
[2024-05-04T08:13:35.685+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:13:35.734+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.114 seconds
[2024-05-04T08:14:05.921+0000] {processor.py:157} INFO - Started process (PID=1556) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:14:05.922+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:14:05.928+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:14:05.927+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:14:35.949+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:14:35.938+0000] {timeout.py:68} ERROR - Process timed out, PID: 1556
[2024-05-04T08:14:35.973+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:14:35.955+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1556

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1556
[2024-05-04T08:14:35.976+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:14:36.002+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.089 seconds
[2024-05-04T08:15:06.461+0000] {processor.py:157} INFO - Started process (PID=1592) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:15:06.463+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:15:06.467+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:15:06.467+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:15:36.482+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:15:36.476+0000] {timeout.py:68} ERROR - Process timed out, PID: 1592
[2024-05-04T08:15:36.494+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:15:36.486+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1592

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1592
[2024-05-04T08:15:36.497+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:15:36.531+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.077 seconds
[2024-05-04T08:16:06.591+0000] {processor.py:157} INFO - Started process (PID=1628) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:16:06.592+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:16:06.597+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:16:06.596+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:16:36.620+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:16:36.609+0000] {timeout.py:68} ERROR - Process timed out, PID: 1628
[2024-05-04T08:16:36.642+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:16:36.629+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1628

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1628
[2024-05-04T08:16:36.645+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:16:36.685+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.100 seconds
[2024-05-04T08:17:07.313+0000] {processor.py:157} INFO - Started process (PID=1664) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:17:07.314+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:17:07.317+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:17:07.316+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:17:37.337+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:17:37.324+0000] {timeout.py:68} ERROR - Process timed out, PID: 1664
[2024-05-04T08:17:37.356+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:17:37.344+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1664

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1664
[2024-05-04T08:17:37.360+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:17:37.395+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-05-04T08:18:07.627+0000] {processor.py:157} INFO - Started process (PID=1700) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:18:07.628+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:18:07.632+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:18:07.631+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:18:37.656+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:18:37.644+0000] {timeout.py:68} ERROR - Process timed out, PID: 1700
[2024-05-04T08:18:37.677+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:18:37.664+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1700

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1700
[2024-05-04T08:18:37.682+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:18:37.714+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.091 seconds
[2024-05-04T08:19:08.477+0000] {processor.py:157} INFO - Started process (PID=1736) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:19:08.478+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:19:08.482+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:19:08.482+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:19:38.494+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:19:38.488+0000] {timeout.py:68} ERROR - Process timed out, PID: 1736
[2024-05-04T08:19:38.503+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:19:38.497+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1736

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1736
[2024-05-04T08:19:38.505+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:19:38.532+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.061 seconds
[2024-05-04T08:20:09.251+0000] {processor.py:157} INFO - Started process (PID=1772) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:20:09.252+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:20:09.255+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:20:09.255+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:20:39.268+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:20:39.262+0000] {timeout.py:68} ERROR - Process timed out, PID: 1772
[2024-05-04T08:20:39.282+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:20:39.274+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1772

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1772
[2024-05-04T08:20:39.284+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:20:39.323+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.077 seconds
[2024-05-04T08:21:10.175+0000] {processor.py:157} INFO - Started process (PID=1808) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:21:10.177+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:21:10.183+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:21:10.182+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:21:40.192+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:21:40.189+0000] {timeout.py:68} ERROR - Process timed out, PID: 1808
[2024-05-04T08:21:40.199+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:21:40.195+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1808

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1808
[2024-05-04T08:21:40.201+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:21:40.223+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.055 seconds
[2024-05-04T08:22:10.309+0000] {processor.py:157} INFO - Started process (PID=1844) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:22:10.311+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:22:10.316+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:22:10.316+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:22:40.338+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:22:40.325+0000] {timeout.py:68} ERROR - Process timed out, PID: 1844
[2024-05-04T08:22:40.356+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:22:40.345+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1844

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1844
[2024-05-04T08:22:40.359+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:22:40.405+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.104 seconds
[2024-05-04T08:23:11.176+0000] {processor.py:157} INFO - Started process (PID=1880) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:23:11.177+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:23:11.181+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:23:11.180+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:23:41.196+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:23:41.191+0000] {timeout.py:68} ERROR - Process timed out, PID: 1880
[2024-05-04T08:23:41.206+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:23:41.199+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1880

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1880
[2024-05-04T08:23:41.209+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:23:41.255+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.084 seconds
[2024-05-04T08:24:11.342+0000] {processor.py:157} INFO - Started process (PID=1916) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:24:11.343+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:24:11.350+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:24:11.349+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:24:41.366+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:24:41.360+0000] {timeout.py:68} ERROR - Process timed out, PID: 1916
[2024-05-04T08:24:41.374+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:24:41.369+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1916

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1916
[2024-05-04T08:24:41.376+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:24:41.399+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.066 seconds
[2024-05-04T08:25:11.491+0000] {processor.py:157} INFO - Started process (PID=1952) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:25:11.493+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:25:11.497+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:25:11.496+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:25:41.516+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:25:41.507+0000] {timeout.py:68} ERROR - Process timed out, PID: 1952
[2024-05-04T08:25:41.537+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:25:41.522+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1952

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1952
[2024-05-04T08:25:41.542+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:25:41.592+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.109 seconds
[2024-05-04T08:26:11.676+0000] {processor.py:157} INFO - Started process (PID=1988) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:26:11.678+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:26:11.681+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:26:11.681+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:26:41.694+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:26:41.690+0000] {timeout.py:68} ERROR - Process timed out, PID: 1988
[2024-05-04T08:26:41.704+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:26:41.699+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1988

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1988
[2024-05-04T08:26:41.706+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:26:41.729+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.059 seconds
[2024-05-04T08:27:11.954+0000] {processor.py:157} INFO - Started process (PID=2024) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:27:11.955+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:27:11.961+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:27:11.960+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:27:41.974+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:27:41.968+0000] {timeout.py:68} ERROR - Process timed out, PID: 2024
[2024-05-04T08:27:41.988+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:27:41.979+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2024

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2024
[2024-05-04T08:27:41.991+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:27:42.032+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.088 seconds
[2024-05-04T08:28:12.491+0000] {processor.py:157} INFO - Started process (PID=2060) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:28:12.493+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:28:12.497+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:28:12.497+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:28:42.511+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:28:42.504+0000] {timeout.py:68} ERROR - Process timed out, PID: 2060
[2024-05-04T08:28:42.525+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:28:42.515+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2060

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2060
[2024-05-04T08:28:42.528+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:28:42.563+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.079 seconds
[2024-05-04T08:29:12.746+0000] {processor.py:157} INFO - Started process (PID=2096) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:29:12.746+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:29:12.749+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:29:12.748+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:29:42.776+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:29:42.765+0000] {timeout.py:68} ERROR - Process timed out, PID: 2096
[2024-05-04T08:29:42.786+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:29:42.780+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2096

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2096
[2024-05-04T08:29:42.788+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:29:42.819+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.077 seconds
[2024-05-04T08:30:13.225+0000] {processor.py:157} INFO - Started process (PID=2132) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:30:13.227+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:30:13.232+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:30:13.232+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:30:43.252+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:30:43.247+0000] {timeout.py:68} ERROR - Process timed out, PID: 2132
[2024-05-04T08:30:43.261+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:30:43.255+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2132

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2132
[2024-05-04T08:30:43.264+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:30:43.306+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.091 seconds
[2024-05-04T08:31:13.887+0000] {processor.py:157} INFO - Started process (PID=2169) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:31:13.889+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:31:13.893+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:31:13.893+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:31:43.909+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:31:43.905+0000] {timeout.py:68} ERROR - Process timed out, PID: 2169
[2024-05-04T08:31:43.916+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:31:43.911+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2169

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2169
[2024-05-04T08:31:43.917+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:31:43.940+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.058 seconds
[2024-05-04T08:32:14.512+0000] {processor.py:157} INFO - Started process (PID=2200) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:32:14.514+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:32:14.518+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:32:14.517+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:32:44.532+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:32:44.526+0000] {timeout.py:68} ERROR - Process timed out, PID: 2200
[2024-05-04T08:32:44.547+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:32:44.536+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2200

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2200
[2024-05-04T08:32:44.549+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:32:44.582+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.077 seconds
[2024-05-04T08:33:14.907+0000] {processor.py:157} INFO - Started process (PID=2235) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:33:14.908+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:33:14.912+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:33:14.911+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:33:44.929+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:33:44.924+0000] {timeout.py:68} ERROR - Process timed out, PID: 2235
[2024-05-04T08:33:44.940+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:33:44.932+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2235

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2235
[2024-05-04T08:33:44.942+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:33:44.970+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.071 seconds
[2024-05-04T08:34:15.384+0000] {processor.py:157} INFO - Started process (PID=2271) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:34:15.389+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:34:15.398+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:34:15.397+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:34:45.419+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:34:45.411+0000] {timeout.py:68} ERROR - Process timed out, PID: 2271
[2024-05-04T08:34:45.431+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:34:45.423+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2271

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2271
[2024-05-04T08:34:45.434+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:34:45.467+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.097 seconds
[2024-05-04T08:35:16.049+0000] {processor.py:157} INFO - Started process (PID=2307) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:35:16.051+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:35:16.055+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:35:16.054+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:35:46.075+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:35:46.062+0000] {timeout.py:68} ERROR - Process timed out, PID: 2307
[2024-05-04T08:35:46.091+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:35:46.081+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2307

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2307
[2024-05-04T08:35:46.095+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:35:46.134+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.090 seconds
[2024-05-04T08:36:16.453+0000] {processor.py:157} INFO - Started process (PID=2343) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:36:16.454+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:36:16.457+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:36:16.457+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:36:46.478+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:36:46.466+0000] {timeout.py:68} ERROR - Process timed out, PID: 2343
[2024-05-04T08:36:46.518+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:36:46.498+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2343

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2343
[2024-05-04T08:36:46.522+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:36:46.563+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.114 seconds
[2024-05-04T08:37:17.166+0000] {processor.py:157} INFO - Started process (PID=2380) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:37:17.168+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:37:17.171+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:37:17.171+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:37:47.184+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:37:47.179+0000] {timeout.py:68} ERROR - Process timed out, PID: 2380
[2024-05-04T08:37:47.194+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:37:47.187+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2380

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2380
[2024-05-04T08:37:47.197+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:37:47.230+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.068 seconds
[2024-05-04T08:38:17.621+0000] {processor.py:157} INFO - Started process (PID=2415) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:38:17.622+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:38:17.625+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:38:17.625+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:38:47.640+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:38:47.631+0000] {timeout.py:68} ERROR - Process timed out, PID: 2415
[2024-05-04T08:38:47.654+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:38:47.645+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2415

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2415
[2024-05-04T08:38:47.657+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:38:47.696+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.080 seconds
[2024-05-04T08:39:18.008+0000] {processor.py:157} INFO - Started process (PID=2450) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:39:18.009+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:39:18.014+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:39:18.014+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:39:48.031+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:39:48.022+0000] {timeout.py:68} ERROR - Process timed out, PID: 2450
[2024-05-04T08:39:48.050+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:39:48.039+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2450

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2450
[2024-05-04T08:39:48.053+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:39:48.090+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.090 seconds
[2024-05-04T08:40:18.288+0000] {processor.py:157} INFO - Started process (PID=2486) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:40:18.290+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:40:18.295+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:40:18.294+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:40:48.321+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:40:48.309+0000] {timeout.py:68} ERROR - Process timed out, PID: 2486
[2024-05-04T08:40:48.340+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:40:48.328+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2486

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2486
[2024-05-04T08:40:48.344+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:40:48.388+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.108 seconds
[2024-05-04T08:41:18.862+0000] {processor.py:157} INFO - Started process (PID=2524) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:41:18.863+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:41:18.866+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:41:18.866+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:41:48.888+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:41:48.876+0000] {timeout.py:68} ERROR - Process timed out, PID: 2524
[2024-05-04T08:41:48.905+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:41:48.895+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2524

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2524
[2024-05-04T08:41:48.909+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:41:48.950+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.094 seconds
[2024-05-04T08:42:19.331+0000] {processor.py:157} INFO - Started process (PID=2560) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:42:19.332+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:42:19.337+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:42:19.336+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:42:49.381+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:42:49.350+0000] {timeout.py:68} ERROR - Process timed out, PID: 2560
[2024-05-04T08:42:49.395+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:42:49.384+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2560

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2560
[2024-05-04T08:42:49.400+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:42:49.443+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.118 seconds
[2024-05-04T08:43:19.698+0000] {processor.py:157} INFO - Started process (PID=2596) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:43:19.699+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:43:19.702+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:43:19.702+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:43:49.712+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:43:49.710+0000] {timeout.py:68} ERROR - Process timed out, PID: 2596
[2024-05-04T08:43:49.718+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:43:49.714+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2596

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2596
[2024-05-04T08:43:49.719+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:43:49.737+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.044 seconds
[2024-05-04T08:44:20.112+0000] {processor.py:157} INFO - Started process (PID=2632) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:44:20.113+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:44:20.117+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:44:20.117+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:44:50.136+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:44:50.130+0000] {timeout.py:68} ERROR - Process timed out, PID: 2632
[2024-05-04T08:44:50.148+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:44:50.140+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2632

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2632
[2024-05-04T08:44:50.150+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:44:50.178+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.067 seconds
[2024-05-04T08:45:20.431+0000] {processor.py:157} INFO - Started process (PID=2668) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:45:20.432+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:45:20.437+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:45:20.436+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:45:50.454+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:45:50.444+0000] {timeout.py:68} ERROR - Process timed out, PID: 2668
[2024-05-04T08:45:50.472+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:45:50.461+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2668

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2668
[2024-05-04T08:45:50.476+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:45:50.519+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.092 seconds
[2024-05-04T08:46:21.061+0000] {processor.py:157} INFO - Started process (PID=2704) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:46:21.062+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:46:21.065+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:46:21.065+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:46:51.092+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:46:51.078+0000] {timeout.py:68} ERROR - Process timed out, PID: 2704
[2024-05-04T08:46:51.109+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:46:51.098+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2704

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2704
[2024-05-04T08:46:51.113+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:46:51.158+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.104 seconds
[2024-05-04T08:47:21.396+0000] {processor.py:157} INFO - Started process (PID=2740) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:47:21.397+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:47:21.401+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:47:21.400+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:47:51.424+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:47:51.413+0000] {timeout.py:68} ERROR - Process timed out, PID: 2740
[2024-05-04T08:47:51.441+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:47:51.430+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2740

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2740
[2024-05-04T08:47:51.446+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:47:51.485+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.096 seconds
[2024-05-04T08:48:21.672+0000] {processor.py:157} INFO - Started process (PID=2776) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:48:21.674+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:48:21.679+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:48:21.678+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:48:51.706+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:48:51.694+0000] {timeout.py:68} ERROR - Process timed out, PID: 2776
[2024-05-04T08:48:51.726+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:48:51.713+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2776

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2776
[2024-05-04T08:48:51.730+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:48:51.773+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.110 seconds
[2024-05-04T08:49:22.451+0000] {processor.py:157} INFO - Started process (PID=2812) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:49:22.453+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:49:22.457+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:49:22.457+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:49:52.483+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:49:52.475+0000] {timeout.py:68} ERROR - Process timed out, PID: 2812
[2024-05-04T08:49:52.501+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:49:52.489+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2812

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2812
[2024-05-04T08:49:52.504+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:49:52.543+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.099 seconds
[2024-05-04T08:50:22.717+0000] {processor.py:157} INFO - Started process (PID=2848) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:50:22.718+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:50:22.722+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:50:22.721+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:50:52.740+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:50:52.727+0000] {timeout.py:68} ERROR - Process timed out, PID: 2848
[2024-05-04T08:50:52.760+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:50:52.748+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2848

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2848
[2024-05-04T08:50:52.765+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:50:52.807+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.100 seconds
[2024-05-04T08:51:23.125+0000] {processor.py:157} INFO - Started process (PID=2884) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:51:23.127+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:51:23.131+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:51:23.130+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:51:53.144+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:51:53.139+0000] {timeout.py:68} ERROR - Process timed out, PID: 2884
[2024-05-04T08:51:53.160+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:51:53.148+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2884

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2884
[2024-05-04T08:51:53.163+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:51:53.201+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.081 seconds
[2024-05-04T08:52:23.285+0000] {processor.py:157} INFO - Started process (PID=2920) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:52:23.287+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:52:23.291+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:52:23.291+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:52:53.312+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:52:53.301+0000] {timeout.py:68} ERROR - Process timed out, PID: 2920
[2024-05-04T08:52:53.329+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:52:53.318+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2920

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2920
[2024-05-04T08:52:53.333+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:52:53.370+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.091 seconds
[2024-05-04T08:53:23.876+0000] {processor.py:157} INFO - Started process (PID=2956) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:53:23.878+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:53:23.882+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:53:23.881+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:53:53.900+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:53:53.893+0000] {timeout.py:68} ERROR - Process timed out, PID: 2956
[2024-05-04T08:53:53.927+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:53:53.907+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2956

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2956
[2024-05-04T08:53:53.929+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:53:53.956+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-05-04T08:54:24.662+0000] {processor.py:157} INFO - Started process (PID=2992) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:54:24.663+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:54:24.667+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:54:24.666+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:54:54.674+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:54:54.672+0000] {timeout.py:68} ERROR - Process timed out, PID: 2992
[2024-05-04T08:54:54.682+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:54:54.678+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2992

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2992
[2024-05-04T08:54:54.683+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:54:54.707+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.051 seconds
[2024-05-04T08:55:25.269+0000] {processor.py:157} INFO - Started process (PID=3023) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:55:25.270+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:55:25.273+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:55:25.272+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:55:55.289+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:55:55.284+0000] {timeout.py:68} ERROR - Process timed out, PID: 3023
[2024-05-04T08:55:55.300+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:55:55.291+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3023

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3023
[2024-05-04T08:55:55.302+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:55:55.334+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.069 seconds
[2024-05-04T08:56:26.023+0000] {processor.py:157} INFO - Started process (PID=3058) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:56:26.025+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:56:26.030+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:56:26.029+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:56:56.055+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:56:56.043+0000] {timeout.py:68} ERROR - Process timed out, PID: 3058
[2024-05-04T08:56:56.081+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:56:56.068+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3058

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3058
[2024-05-04T08:56:56.085+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:56:56.129+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.112 seconds
[2024-05-04T08:57:26.682+0000] {processor.py:157} INFO - Started process (PID=3101) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:57:26.683+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:57:26.687+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:57:26.686+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:57:56.715+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:57:56.709+0000] {timeout.py:68} ERROR - Process timed out, PID: 3101
[2024-05-04T08:57:56.725+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:57:56.719+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3101

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3101
[2024-05-04T08:57:56.727+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:57:56.752+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.075 seconds
[2024-05-04T08:58:27.289+0000] {processor.py:157} INFO - Started process (PID=3137) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:58:27.290+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:58:27.293+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:58:27.293+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:58:57.326+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:58:57.312+0000] {timeout.py:68} ERROR - Process timed out, PID: 3137
[2024-05-04T08:58:57.349+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:58:57.336+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3137

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3137
[2024-05-04T08:58:57.353+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:58:57.388+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.103 seconds
[2024-05-04T08:59:27.910+0000] {processor.py:157} INFO - Started process (PID=3173) to work on /opt/airflow/dags/train_model.py
[2024-05-04T08:59:27.911+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T08:59:27.912+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:59:27.912+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T08:59:57.917+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:59:57.916+0000] {timeout.py:68} ERROR - Process timed out, PID: 3173
[2024-05-04T08:59:57.925+0000] {logging_mixin.py:151} INFO - [2024-05-04T08:59:57.920+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3173

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3173
[2024-05-04T08:59:57.926+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T08:59:57.945+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.039 seconds
[2024-05-04T09:00:28.625+0000] {processor.py:157} INFO - Started process (PID=3209) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:00:28.626+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:00:28.630+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:00:28.630+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:00:58.653+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:00:58.645+0000] {timeout.py:68} ERROR - Process timed out, PID: 3209
[2024-05-04T09:00:58.665+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:00:58.657+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3209

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3209
[2024-05-04T09:00:58.667+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:00:58.703+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.085 seconds
[2024-05-04T09:01:29.268+0000] {processor.py:157} INFO - Started process (PID=3245) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:01:29.269+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:01:29.273+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:01:29.272+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:01:59.282+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:01:59.280+0000] {timeout.py:68} ERROR - Process timed out, PID: 3245
[2024-05-04T09:01:59.287+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:01:59.284+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3245

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3245
[2024-05-04T09:01:59.288+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:01:59.305+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.037 seconds
[2024-05-04T09:02:29.870+0000] {processor.py:157} INFO - Started process (PID=3281) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:02:29.871+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:02:29.873+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:02:29.873+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:02:59.880+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:02:59.879+0000] {timeout.py:68} ERROR - Process timed out, PID: 3281
[2024-05-04T09:02:59.885+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:02:59.882+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3281

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3281
[2024-05-04T09:02:59.886+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:02:59.902+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.034 seconds
[2024-05-04T09:03:30.243+0000] {processor.py:157} INFO - Started process (PID=3317) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:03:30.245+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:03:30.249+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:03:30.248+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:04:00.277+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:04:00.267+0000] {timeout.py:68} ERROR - Process timed out, PID: 3317
[2024-05-04T09:04:00.298+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:04:00.286+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3317

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3317
[2024-05-04T09:04:00.302+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:04:00.342+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.103 seconds
[2024-05-04T09:04:30.904+0000] {processor.py:157} INFO - Started process (PID=3353) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:04:30.905+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:04:30.909+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:04:30.908+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:05:00.938+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:05:00.925+0000] {timeout.py:68} ERROR - Process timed out, PID: 3353
[2024-05-04T09:05:00.957+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:05:00.945+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3353

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3353
[2024-05-04T09:05:00.960+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:05:00.999+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.102 seconds
[2024-05-04T09:05:31.538+0000] {processor.py:157} INFO - Started process (PID=3389) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:05:31.539+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:05:31.542+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:05:31.542+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:06:01.563+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:06:01.554+0000] {timeout.py:68} ERROR - Process timed out, PID: 3389
[2024-05-04T09:06:01.584+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:06:01.571+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3389

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3389
[2024-05-04T09:06:01.588+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:06:01.634+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.100 seconds
[2024-05-04T09:06:32.207+0000] {processor.py:157} INFO - Started process (PID=3425) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:06:32.208+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:06:32.212+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:06:32.212+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:07:02.236+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:07:02.223+0000] {timeout.py:68} ERROR - Process timed out, PID: 3425
[2024-05-04T09:07:02.257+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:07:02.243+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3425

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3425
[2024-05-04T09:07:02.261+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:07:02.303+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.105 seconds
[2024-05-04T09:07:32.966+0000] {processor.py:157} INFO - Started process (PID=3461) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:07:32.968+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:07:32.971+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:07:32.971+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:08:03.001+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:08:02.985+0000] {timeout.py:68} ERROR - Process timed out, PID: 3461
[2024-05-04T09:08:03.021+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:08:03.008+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3461

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3461
[2024-05-04T09:08:03.026+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:08:03.077+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.117 seconds
[2024-05-04T09:08:33.792+0000] {processor.py:157} INFO - Started process (PID=3497) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:08:33.794+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:08:33.797+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:08:33.797+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:09:03.813+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:09:03.808+0000] {timeout.py:68} ERROR - Process timed out, PID: 3497
[2024-05-04T09:09:03.822+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:09:03.816+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3497

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3497
[2024-05-04T09:09:03.824+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:09:03.851+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.065 seconds
[2024-05-04T09:09:34.185+0000] {processor.py:157} INFO - Started process (PID=3533) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:09:34.186+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:09:34.188+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:09:34.188+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:10:04.194+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:10:04.192+0000] {timeout.py:68} ERROR - Process timed out, PID: 3533
[2024-05-04T09:10:04.200+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:10:04.195+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3533

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3533
[2024-05-04T09:10:04.201+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:10:04.225+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.044 seconds
[2024-05-04T09:10:34.338+0000] {processor.py:157} INFO - Started process (PID=3569) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:10:34.339+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:10:34.340+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:10:34.340+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:11:04.358+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:11:04.354+0000] {timeout.py:68} ERROR - Process timed out, PID: 3569
[2024-05-04T09:11:04.369+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:11:04.362+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3569

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3569
[2024-05-04T09:11:04.371+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:11:04.407+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.070 seconds
[2024-05-04T09:11:34.581+0000] {processor.py:157} INFO - Started process (PID=3603) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:11:34.583+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:11:34.589+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:11:34.588+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:12:04.603+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:12:04.599+0000] {timeout.py:68} ERROR - Process timed out, PID: 3603
[2024-05-04T09:12:04.609+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:12:04.605+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3603

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3603
[2024-05-04T09:12:04.610+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:12:04.629+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.056 seconds
[2024-05-04T09:12:34.998+0000] {processor.py:157} INFO - Started process (PID=3639) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:12:34.999+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:12:35.002+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:12:35.001+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:13:05.021+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:13:05.011+0000] {timeout.py:68} ERROR - Process timed out, PID: 3639
[2024-05-04T09:13:05.039+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:13:05.028+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3639

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3639
[2024-05-04T09:13:05.041+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:13:05.076+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.082 seconds
[2024-05-04T09:13:35.497+0000] {processor.py:157} INFO - Started process (PID=3675) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:13:35.498+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:13:35.501+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:13:35.501+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:14:05.516+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:14:05.508+0000] {timeout.py:68} ERROR - Process timed out, PID: 3675
[2024-05-04T09:14:05.528+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:14:05.520+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3675

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3675
[2024-05-04T09:14:05.530+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:14:05.565+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.070 seconds
[2024-05-04T09:14:35.685+0000] {processor.py:157} INFO - Started process (PID=3711) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:14:35.687+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:14:35.690+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:14:35.690+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:15:05.702+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:15:05.697+0000] {timeout.py:68} ERROR - Process timed out, PID: 3711
[2024-05-04T09:15:05.714+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:15:05.705+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3711

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3711
[2024-05-04T09:15:05.716+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:15:05.751+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.072 seconds
[2024-05-04T09:15:36.008+0000] {processor.py:157} INFO - Started process (PID=3747) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:15:36.009+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:15:36.012+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:15:36.012+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:16:06.020+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:16:06.017+0000] {timeout.py:68} ERROR - Process timed out, PID: 3747
[2024-05-04T09:16:06.028+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:16:06.022+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3747

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3747
[2024-05-04T09:16:06.030+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:16:06.052+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.048 seconds
[2024-05-04T09:16:36.177+0000] {processor.py:157} INFO - Started process (PID=3783) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:16:36.178+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:16:36.183+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:16:36.182+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:17:06.203+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:17:06.196+0000] {timeout.py:68} ERROR - Process timed out, PID: 3783
[2024-05-04T09:17:06.216+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:17:06.208+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3783

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3783
[2024-05-04T09:17:06.219+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:17:06.258+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.088 seconds
[2024-05-04T09:17:36.651+0000] {processor.py:157} INFO - Started process (PID=3819) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:17:36.653+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:17:36.659+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:17:36.658+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:18:06.677+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:18:06.670+0000] {timeout.py:68} ERROR - Process timed out, PID: 3819
[2024-05-04T09:18:06.694+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:18:06.683+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3819

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3819
[2024-05-04T09:18:06.696+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:18:06.728+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.084 seconds
[2024-05-04T09:18:36.961+0000] {processor.py:157} INFO - Started process (PID=3855) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:18:36.962+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:18:36.965+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:18:36.965+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:19:06.974+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:19:06.972+0000] {timeout.py:68} ERROR - Process timed out, PID: 3855
[2024-05-04T09:19:06.979+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:19:06.975+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3855

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3855
[2024-05-04T09:19:06.980+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:19:06.998+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.039 seconds
[2024-05-04T09:19:37.511+0000] {processor.py:157} INFO - Started process (PID=3886) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:19:37.512+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:19:37.515+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:19:37.514+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:20:07.537+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:20:07.532+0000] {timeout.py:68} ERROR - Process timed out, PID: 3886
[2024-05-04T09:20:07.543+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:20:07.540+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3886

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3886
[2024-05-04T09:20:07.544+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:20:07.559+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.048 seconds
[2024-05-04T09:20:37.615+0000] {processor.py:157} INFO - Started process (PID=3921) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:20:37.616+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:20:37.621+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:20:37.620+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:21:07.645+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:21:07.635+0000] {timeout.py:68} ERROR - Process timed out, PID: 3921
[2024-05-04T09:21:07.660+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:21:07.655+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3921

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3921
[2024-05-04T09:21:07.662+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:21:07.685+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.070 seconds
[2024-05-04T09:21:38.172+0000] {processor.py:157} INFO - Started process (PID=3957) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:21:38.173+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:21:38.177+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:21:38.177+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:22:08.196+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:22:08.187+0000] {timeout.py:68} ERROR - Process timed out, PID: 3957
[2024-05-04T09:22:08.213+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:22:08.202+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3957

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3957
[2024-05-04T09:22:08.216+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:22:08.253+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.087 seconds
[2024-05-04T09:22:38.969+0000] {processor.py:157} INFO - Started process (PID=3993) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:22:38.970+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:22:38.973+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:22:38.972+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:23:09.010+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:23:08.983+0000] {timeout.py:68} ERROR - Process timed out, PID: 3993
[2024-05-04T09:23:09.025+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:23:09.016+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3993

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3993
[2024-05-04T09:23:09.028+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:23:09.058+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.093 seconds
[2024-05-04T09:23:39.471+0000] {processor.py:157} INFO - Started process (PID=4029) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:23:39.472+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:23:39.477+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:23:39.477+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:24:09.493+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:24:09.486+0000] {timeout.py:68} ERROR - Process timed out, PID: 4029
[2024-05-04T09:24:09.511+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:24:09.498+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4029

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4029
[2024-05-04T09:24:09.514+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:24:09.550+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.087 seconds
[2024-05-04T09:24:40.142+0000] {processor.py:157} INFO - Started process (PID=4065) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:24:40.143+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:24:40.147+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:24:40.147+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:25:10.167+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:25:10.156+0000] {timeout.py:68} ERROR - Process timed out, PID: 4065
[2024-05-04T09:25:10.199+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:25:10.174+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4065

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4065
[2024-05-04T09:25:10.210+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:25:10.250+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.115 seconds
[2024-05-04T09:25:40.415+0000] {processor.py:157} INFO - Started process (PID=4100) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:25:40.417+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:25:40.421+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:25:40.420+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:26:10.445+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:26:10.434+0000] {timeout.py:68} ERROR - Process timed out, PID: 4100
[2024-05-04T09:26:10.462+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:26:10.451+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4100

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4100
[2024-05-04T09:26:10.465+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:26:10.509+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.100 seconds
[2024-05-04T09:26:41.232+0000] {processor.py:157} INFO - Started process (PID=4136) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:26:41.234+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:26:41.238+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:26:41.238+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:27:11.255+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:27:11.247+0000] {timeout.py:68} ERROR - Process timed out, PID: 4136
[2024-05-04T09:27:11.268+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:27:11.259+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4136

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4136
[2024-05-04T09:27:11.271+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:27:11.305+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.080 seconds
[2024-05-04T09:27:41.926+0000] {processor.py:157} INFO - Started process (PID=4172) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:27:41.928+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:27:41.932+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:27:41.931+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:28:11.953+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:28:11.946+0000] {timeout.py:68} ERROR - Process timed out, PID: 4172
[2024-05-04T09:28:11.967+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:28:11.957+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4172

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4172
[2024-05-04T09:28:11.969+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:28:12.004+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.085 seconds
[2024-05-04T09:28:42.697+0000] {processor.py:157} INFO - Started process (PID=4208) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:28:42.699+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:28:42.705+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:28:42.704+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:29:12.735+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:29:12.720+0000] {timeout.py:68} ERROR - Process timed out, PID: 4208
[2024-05-04T09:29:12.753+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:29:12.743+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4208

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4208
[2024-05-04T09:29:12.756+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:29:12.789+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.100 seconds
[2024-05-04T09:29:43.584+0000] {processor.py:157} INFO - Started process (PID=4244) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:29:43.586+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:29:43.589+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:29:43.588+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:30:13.612+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:30:13.603+0000] {timeout.py:68} ERROR - Process timed out, PID: 4244
[2024-05-04T09:30:13.627+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:30:13.617+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4244

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4244
[2024-05-04T09:30:13.630+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:30:13.672+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.096 seconds
[2024-05-04T09:30:44.347+0000] {processor.py:157} INFO - Started process (PID=4280) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:30:44.349+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:30:44.354+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:30:44.353+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:31:14.383+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:31:14.372+0000] {timeout.py:68} ERROR - Process timed out, PID: 4280
[2024-05-04T09:31:14.403+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:31:14.390+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4280

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4280
[2024-05-04T09:31:14.406+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:31:14.443+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.103 seconds
[2024-05-04T09:31:45.035+0000] {processor.py:157} INFO - Started process (PID=4316) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:31:45.036+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:31:45.041+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:31:45.040+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:32:15.066+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:32:15.053+0000] {timeout.py:68} ERROR - Process timed out, PID: 4316
[2024-05-04T09:32:15.084+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:32:15.070+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4316

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4316
[2024-05-04T09:32:15.086+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:32:15.128+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.102 seconds
[2024-05-04T09:32:45.181+0000] {processor.py:157} INFO - Started process (PID=4352) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:32:45.182+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:32:45.185+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:32:45.185+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:33:15.204+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:33:15.195+0000] {timeout.py:68} ERROR - Process timed out, PID: 4352
[2024-05-04T09:33:15.218+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:33:15.209+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4352

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4352
[2024-05-04T09:33:15.222+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:33:15.262+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.085 seconds
[2024-05-04T09:33:45.812+0000] {processor.py:157} INFO - Started process (PID=4388) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:33:45.813+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:33:45.815+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:33:45.815+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:34:15.842+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:34:15.828+0000] {timeout.py:68} ERROR - Process timed out, PID: 4388
[2024-05-04T09:34:15.863+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:34:15.851+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4388

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4388
[2024-05-04T09:34:15.866+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:34:15.909+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.101 seconds
[2024-05-04T09:34:46.008+0000] {processor.py:157} INFO - Started process (PID=4424) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:34:46.009+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:34:46.014+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:34:46.013+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:35:16.031+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:35:16.023+0000] {timeout.py:68} ERROR - Process timed out, PID: 4424
[2024-05-04T09:35:16.046+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:35:16.037+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4424

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4424
[2024-05-04T09:35:16.048+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:35:16.083+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.080 seconds
[2024-05-04T09:35:46.562+0000] {processor.py:157} INFO - Started process (PID=4460) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:35:46.564+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:35:46.567+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:35:46.567+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:36:16.586+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:36:16.577+0000] {timeout.py:68} ERROR - Process timed out, PID: 4460
[2024-05-04T09:36:16.610+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:36:16.592+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4460

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4460
[2024-05-04T09:36:16.613+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:36:16.663+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.106 seconds
[2024-05-04T09:36:47.331+0000] {processor.py:157} INFO - Started process (PID=4496) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:36:47.332+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:36:47.335+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:36:47.334+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:37:17.357+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:37:17.342+0000] {timeout.py:68} ERROR - Process timed out, PID: 4496
[2024-05-04T09:37:17.378+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:37:17.365+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4496

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4496
[2024-05-04T09:37:17.382+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:37:17.424+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.097 seconds
[2024-05-04T09:37:47.847+0000] {processor.py:157} INFO - Started process (PID=4532) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:37:47.847+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:37:47.849+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:37:47.848+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:38:17.855+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:38:17.851+0000] {timeout.py:68} ERROR - Process timed out, PID: 4532
[2024-05-04T09:38:17.876+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:38:17.867+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4532

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4532
[2024-05-04T09:38:17.881+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:38:17.913+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.069 seconds
[2024-05-04T09:38:48.267+0000] {processor.py:157} INFO - Started process (PID=4568) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:38:48.267+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:38:48.269+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:38:48.269+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:39:18.285+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:39:18.277+0000] {timeout.py:68} ERROR - Process timed out, PID: 4568
[2024-05-04T09:39:18.299+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:39:18.290+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4568

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4568
[2024-05-04T09:39:18.302+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:39:18.337+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.073 seconds
[2024-05-04T09:39:48.595+0000] {processor.py:157} INFO - Started process (PID=4603) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:39:48.596+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:39:48.598+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:39:48.598+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:40:18.614+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:40:18.604+0000] {timeout.py:68} ERROR - Process timed out, PID: 4603
[2024-05-04T09:40:18.628+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:40:18.619+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4603

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4603
[2024-05-04T09:40:18.631+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:40:18.663+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.071 seconds
[2024-05-04T09:40:49.054+0000] {processor.py:157} INFO - Started process (PID=4639) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:40:49.055+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:40:49.056+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:40:49.056+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:41:19.066+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:41:19.059+0000] {timeout.py:68} ERROR - Process timed out, PID: 4639
[2024-05-04T09:41:19.077+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:41:19.070+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4639

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4639
[2024-05-04T09:41:19.080+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:41:19.105+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.055 seconds
[2024-05-04T09:41:49.426+0000] {processor.py:157} INFO - Started process (PID=4675) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:41:49.427+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:41:49.429+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:41:49.428+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:42:19.436+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:42:19.433+0000] {timeout.py:68} ERROR - Process timed out, PID: 4675
[2024-05-04T09:42:19.445+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:42:19.439+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4675

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4675
[2024-05-04T09:42:19.446+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:42:19.471+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.049 seconds
[2024-05-04T09:42:49.846+0000] {processor.py:157} INFO - Started process (PID=4711) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:42:49.848+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:42:49.851+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:42:49.851+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:43:19.857+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:43:19.856+0000] {timeout.py:68} ERROR - Process timed out, PID: 4711
[2024-05-04T09:43:19.862+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:43:19.858+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4711

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4711
[2024-05-04T09:43:19.863+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:43:19.879+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.039 seconds
[2024-05-04T09:43:50.231+0000] {processor.py:157} INFO - Started process (PID=4742) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:43:50.232+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:43:50.235+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:43:50.235+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:44:20.241+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:44:20.239+0000] {timeout.py:68} ERROR - Process timed out, PID: 4742
[2024-05-04T09:44:20.248+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:44:20.244+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4742

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4742
[2024-05-04T09:44:20.249+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:44:20.269+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.043 seconds
[2024-05-04T09:44:51.086+0000] {processor.py:157} INFO - Started process (PID=4777) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:44:51.087+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:44:51.089+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:44:51.089+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:45:21.099+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:45:21.094+0000] {timeout.py:68} ERROR - Process timed out, PID: 4777
[2024-05-04T09:45:21.110+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:45:21.103+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4777

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4777
[2024-05-04T09:45:21.111+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:45:21.146+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.064 seconds
[2024-05-04T09:45:51.432+0000] {processor.py:157} INFO - Started process (PID=4813) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:45:51.434+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:45:51.437+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:45:51.437+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:46:21.463+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:46:21.448+0000] {timeout.py:68} ERROR - Process timed out, PID: 4813
[2024-05-04T09:46:21.481+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:46:21.469+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4813

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4813
[2024-05-04T09:46:21.485+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:46:21.525+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.101 seconds
[2024-05-04T09:46:51.992+0000] {processor.py:157} INFO - Started process (PID=4848) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:46:51.993+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:46:51.995+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:46:51.995+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:47:22.010+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:47:22.003+0000] {timeout.py:68} ERROR - Process timed out, PID: 4848
[2024-05-04T09:47:22.023+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:47:22.014+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4848

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4848
[2024-05-04T09:47:22.026+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:47:22.057+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.068 seconds
[2024-05-04T09:47:52.635+0000] {processor.py:157} INFO - Started process (PID=4883) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:47:52.636+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:47:52.639+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:47:52.639+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:48:22.656+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:48:22.647+0000] {timeout.py:68} ERROR - Process timed out, PID: 4883
[2024-05-04T09:48:22.677+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:48:22.664+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4883

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4883
[2024-05-04T09:48:22.681+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:48:22.723+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.094 seconds
[2024-05-04T09:48:53.018+0000] {processor.py:157} INFO - Started process (PID=4919) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:48:53.019+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:48:53.025+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:48:53.024+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:49:23.045+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:49:23.036+0000] {timeout.py:68} ERROR - Process timed out, PID: 4919
[2024-05-04T09:49:23.065+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:49:23.051+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4919

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4919
[2024-05-04T09:49:23.068+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:49:23.111+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.101 seconds
[2024-05-04T09:49:53.349+0000] {processor.py:157} INFO - Started process (PID=4955) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:49:53.350+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:49:53.354+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:49:53.353+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:50:23.364+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:50:23.357+0000] {timeout.py:68} ERROR - Process timed out, PID: 4955
[2024-05-04T09:50:23.374+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:50:23.368+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4955

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4955
[2024-05-04T09:50:23.376+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:50:23.406+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.066 seconds
[2024-05-04T09:50:53.781+0000] {processor.py:157} INFO - Started process (PID=4991) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:50:53.782+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:50:53.789+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:50:53.788+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:51:23.807+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:51:23.798+0000] {timeout.py:68} ERROR - Process timed out, PID: 4991
[2024-05-04T09:51:23.826+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:51:23.812+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4991

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4991
[2024-05-04T09:51:23.829+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:51:23.870+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.100 seconds
[2024-05-04T09:51:54.532+0000] {processor.py:157} INFO - Started process (PID=5027) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:51:54.533+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:51:54.537+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:51:54.536+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:52:24.558+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:52:24.545+0000] {timeout.py:68} ERROR - Process timed out, PID: 5027
[2024-05-04T09:52:24.574+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:52:24.563+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5027

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5027
[2024-05-04T09:52:24.577+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:52:24.615+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.093 seconds
[2024-05-04T09:52:54.983+0000] {processor.py:157} INFO - Started process (PID=5063) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:52:54.985+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:52:54.992+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:52:54.991+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:53:25.026+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:53:25.010+0000] {timeout.py:68} ERROR - Process timed out, PID: 5063
[2024-05-04T09:53:25.047+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:53:25.034+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5063

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5063
[2024-05-04T09:53:25.051+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:53:25.099+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.124 seconds
[2024-05-04T09:53:55.888+0000] {processor.py:157} INFO - Started process (PID=5099) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:53:55.889+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:53:55.893+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:53:55.892+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:54:25.908+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:54:25.902+0000] {timeout.py:68} ERROR - Process timed out, PID: 5099
[2024-05-04T09:54:25.920+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:54:25.911+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5099

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5099
[2024-05-04T09:54:25.923+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:54:25.964+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.082 seconds
[2024-05-04T09:54:56.029+0000] {processor.py:157} INFO - Started process (PID=5135) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:54:56.030+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:54:56.034+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:54:56.033+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:55:26.069+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:55:26.059+0000] {timeout.py:68} ERROR - Process timed out, PID: 5135
[2024-05-04T09:55:26.078+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:55:26.072+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5135

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5135
[2024-05-04T09:55:26.081+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:55:26.115+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.091 seconds
[2024-05-04T09:55:56.395+0000] {processor.py:157} INFO - Started process (PID=5171) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:55:56.396+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:55:56.400+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:55:56.399+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:56:26.407+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:56:26.405+0000] {timeout.py:68} ERROR - Process timed out, PID: 5171
[2024-05-04T09:56:26.412+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:56:26.409+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5171

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5171
[2024-05-04T09:56:26.413+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:56:26.432+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.042 seconds
[2024-05-04T09:56:56.682+0000] {processor.py:157} INFO - Started process (PID=5207) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:56:56.683+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:56:56.688+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:56:56.688+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:57:26.705+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:57:26.697+0000] {timeout.py:68} ERROR - Process timed out, PID: 5207
[2024-05-04T09:57:26.720+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:57:26.709+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5207

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5207
[2024-05-04T09:57:26.723+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:57:26.754+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.078 seconds
[2024-05-04T09:57:57.264+0000] {processor.py:157} INFO - Started process (PID=5243) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:57:57.266+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:57:57.270+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:57:57.270+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:58:27.283+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:58:27.278+0000] {timeout.py:68} ERROR - Process timed out, PID: 5243
[2024-05-04T09:58:27.299+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:58:27.287+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5243

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5243
[2024-05-04T09:58:27.302+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:58:27.343+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-05-04T09:58:58.042+0000] {processor.py:157} INFO - Started process (PID=5279) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:58:58.044+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:58:58.046+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:58:58.046+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T09:59:28.076+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:59:28.066+0000] {timeout.py:68} ERROR - Process timed out, PID: 5279
[2024-05-04T09:59:28.093+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:59:28.081+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5279

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5279
[2024-05-04T09:59:28.096+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T09:59:28.137+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.098 seconds
[2024-05-04T09:59:58.569+0000] {processor.py:157} INFO - Started process (PID=5315) to work on /opt/airflow/dags/train_model.py
[2024-05-04T09:59:58.571+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T09:59:58.574+0000] {logging_mixin.py:151} INFO - [2024-05-04T09:59:58.573+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:00:28.594+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:00:28.588+0000] {timeout.py:68} ERROR - Process timed out, PID: 5315
[2024-05-04T10:00:28.618+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:00:28.599+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5315

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5315
[2024-05-04T10:00:28.620+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:00:28.650+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-05-04T10:00:59.303+0000] {processor.py:157} INFO - Started process (PID=5351) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:00:59.305+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:00:59.309+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:00:59.308+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:01:29.332+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:01:29.326+0000] {timeout.py:68} ERROR - Process timed out, PID: 5351
[2024-05-04T10:01:29.345+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:01:29.336+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5351

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5351
[2024-05-04T10:01:29.347+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:01:29.379+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.082 seconds
[2024-05-04T10:01:59.649+0000] {processor.py:157} INFO - Started process (PID=5387) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:01:59.650+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:01:59.655+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:01:59.654+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:02:29.667+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:02:29.662+0000] {timeout.py:68} ERROR - Process timed out, PID: 5387
[2024-05-04T10:02:29.676+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:02:29.670+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5387

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5387
[2024-05-04T10:02:29.678+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:02:29.704+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.061 seconds
[2024-05-04T10:02:59.995+0000] {processor.py:157} INFO - Started process (PID=5423) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:02:59.997+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:03:00.003+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:03:00.002+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:03:30.032+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:03:30.018+0000] {timeout.py:68} ERROR - Process timed out, PID: 5423
[2024-05-04T10:03:30.049+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:03:30.039+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5423

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5423
[2024-05-04T10:03:30.053+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:03:30.108+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.120 seconds
[2024-05-04T10:04:00.743+0000] {processor.py:157} INFO - Started process (PID=5459) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:04:00.745+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:04:00.750+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:04:00.750+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:04:30.779+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:04:30.765+0000] {timeout.py:68} ERROR - Process timed out, PID: 5459
[2024-05-04T10:04:30.800+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:04:30.788+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5459

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5459
[2024-05-04T10:04:30.804+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:04:30.841+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.104 seconds
[2024-05-04T10:05:01.253+0000] {processor.py:157} INFO - Started process (PID=5495) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:05:01.254+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:05:01.257+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:05:01.257+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:05:31.278+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:05:31.267+0000] {timeout.py:68} ERROR - Process timed out, PID: 5495
[2024-05-04T10:05:31.289+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:05:31.281+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5495

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5495
[2024-05-04T10:05:31.292+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:05:31.331+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.084 seconds
[2024-05-04T10:06:02.055+0000] {processor.py:157} INFO - Started process (PID=5531) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:06:02.056+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:06:02.059+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:06:02.059+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:06:32.083+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:06:32.078+0000] {timeout.py:68} ERROR - Process timed out, PID: 5531
[2024-05-04T10:06:32.093+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:06:32.086+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5531

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5531
[2024-05-04T10:06:32.095+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:06:32.124+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.064 seconds
[2024-05-04T10:07:02.483+0000] {processor.py:157} INFO - Started process (PID=5567) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:07:02.485+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:07:02.489+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:07:02.488+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:07:32.508+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:07:32.499+0000] {timeout.py:68} ERROR - Process timed out, PID: 5567
[2024-05-04T10:07:32.525+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:07:32.516+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5567

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5567
[2024-05-04T10:07:32.527+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:07:32.558+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.080 seconds
[2024-05-04T10:08:03.179+0000] {processor.py:157} INFO - Started process (PID=5603) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:08:03.180+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:08:03.182+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:08:03.182+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:08:33.218+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:08:33.203+0000] {timeout.py:68} ERROR - Process timed out, PID: 5603
[2024-05-04T10:08:33.240+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:08:33.227+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5603

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5603
[2024-05-04T10:08:33.244+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:08:33.288+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.108 seconds
[2024-05-04T10:09:03.647+0000] {processor.py:157} INFO - Started process (PID=5639) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:09:03.649+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:09:03.653+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:09:03.652+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:09:33.674+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:09:33.664+0000] {timeout.py:68} ERROR - Process timed out, PID: 5639
[2024-05-04T10:09:33.692+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:09:33.680+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5639

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5639
[2024-05-04T10:09:33.695+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:09:33.731+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.091 seconds
[2024-05-04T10:10:04.069+0000] {processor.py:157} INFO - Started process (PID=5675) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:10:04.071+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:10:04.075+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:10:04.074+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:10:34.090+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:10:34.085+0000] {timeout.py:68} ERROR - Process timed out, PID: 5675
[2024-05-04T10:10:34.106+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:10:34.095+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5675

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5675
[2024-05-04T10:10:34.110+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:10:34.146+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.083 seconds
[2024-05-04T10:11:04.559+0000] {processor.py:157} INFO - Started process (PID=5711) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:11:04.561+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:11:04.565+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:11:04.564+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:11:34.572+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:11:34.571+0000] {timeout.py:68} ERROR - Process timed out, PID: 5711
[2024-05-04T10:11:34.576+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:11:34.573+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5711

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5711
[2024-05-04T10:11:34.577+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:11:34.606+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.053 seconds
[2024-05-04T10:12:05.151+0000] {processor.py:157} INFO - Started process (PID=5742) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:12:05.152+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:12:05.154+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:12:05.154+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:12:35.162+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:12:35.160+0000] {timeout.py:68} ERROR - Process timed out, PID: 5742
[2024-05-04T10:12:35.170+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:12:35.165+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5742

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5742
[2024-05-04T10:12:35.171+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:12:35.200+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.053 seconds
[2024-05-04T10:13:05.962+0000] {processor.py:157} INFO - Started process (PID=5777) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:13:05.963+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:13:05.965+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:13:05.965+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:13:35.988+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:13:35.982+0000] {timeout.py:68} ERROR - Process timed out, PID: 5777
[2024-05-04T10:13:36.002+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:13:35.992+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5777

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5777
[2024-05-04T10:13:36.005+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:13:36.037+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.085 seconds
[2024-05-04T10:14:06.472+0000] {processor.py:157} INFO - Started process (PID=5813) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:14:06.473+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:14:06.477+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:14:06.476+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:14:36.488+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:14:36.483+0000] {timeout.py:68} ERROR - Process timed out, PID: 5813
[2024-05-04T10:14:36.504+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:14:36.495+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5813

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5813
[2024-05-04T10:14:36.507+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:14:36.538+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.071 seconds
[2024-05-04T10:15:06.991+0000] {processor.py:157} INFO - Started process (PID=5849) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:15:06.993+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:15:06.996+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:15:06.996+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:15:37.024+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:15:37.016+0000] {timeout.py:68} ERROR - Process timed out, PID: 5849
[2024-05-04T10:15:37.044+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:15:37.030+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5849

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5849
[2024-05-04T10:15:37.049+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:15:37.094+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.105 seconds
[2024-05-04T10:16:07.415+0000] {processor.py:157} INFO - Started process (PID=5885) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:16:07.416+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:16:07.417+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:16:07.417+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:16:37.440+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:16:37.430+0000] {timeout.py:68} ERROR - Process timed out, PID: 5885
[2024-05-04T10:16:37.460+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:16:37.446+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5885

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5885
[2024-05-04T10:16:37.465+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:16:37.502+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.089 seconds
[2024-05-04T10:17:08.115+0000] {processor.py:157} INFO - Started process (PID=5921) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:17:08.117+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:17:08.120+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:17:08.120+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:17:38.130+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:17:38.125+0000] {timeout.py:68} ERROR - Process timed out, PID: 5921
[2024-05-04T10:17:38.140+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:17:38.133+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5921

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5921
[2024-05-04T10:17:38.142+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:17:38.170+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.060 seconds
[2024-05-04T10:18:08.686+0000] {processor.py:157} INFO - Started process (PID=5957) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:18:08.688+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:18:08.691+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:18:08.691+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:18:38.701+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:18:38.698+0000] {timeout.py:68} ERROR - Process timed out, PID: 5957
[2024-05-04T10:18:38.707+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:18:38.703+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5957

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5957
[2024-05-04T10:18:38.708+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:18:38.727+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.046 seconds
[2024-05-04T10:19:09.182+0000] {processor.py:157} INFO - Started process (PID=5992) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:19:09.183+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:19:09.186+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:19:09.186+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:19:39.203+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:19:39.195+0000] {timeout.py:68} ERROR - Process timed out, PID: 5992
[2024-05-04T10:19:39.218+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:19:39.208+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5992

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 5992
[2024-05-04T10:19:39.220+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:19:39.254+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.076 seconds
[2024-05-04T10:20:09.527+0000] {processor.py:157} INFO - Started process (PID=6027) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:20:09.529+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:20:09.534+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:20:09.533+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:20:39.552+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:20:39.545+0000] {timeout.py:68} ERROR - Process timed out, PID: 6027
[2024-05-04T10:20:39.569+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:20:39.557+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6027

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6027
[2024-05-04T10:20:39.572+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:20:39.609+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.090 seconds
[2024-05-04T10:21:10.085+0000] {processor.py:157} INFO - Started process (PID=6063) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:21:10.087+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:21:10.092+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:21:10.092+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:21:40.122+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:21:40.112+0000] {timeout.py:68} ERROR - Process timed out, PID: 6063
[2024-05-04T10:21:40.141+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:21:40.128+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6063

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6063
[2024-05-04T10:21:40.145+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:21:40.185+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.107 seconds
[2024-05-04T10:22:10.385+0000] {processor.py:157} INFO - Started process (PID=6099) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:22:10.386+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:22:10.391+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:22:10.390+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:22:40.434+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:22:40.409+0000] {timeout.py:68} ERROR - Process timed out, PID: 6099
[2024-05-04T10:22:40.457+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:22:40.443+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6099

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6099
[2024-05-04T10:22:40.463+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:22:40.497+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.117 seconds
[2024-05-04T10:23:10.679+0000] {processor.py:157} INFO - Started process (PID=6142) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:23:10.679+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:23:10.682+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:23:10.681+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:23:40.688+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:23:40.685+0000] {timeout.py:68} ERROR - Process timed out, PID: 6142
[2024-05-04T10:23:40.694+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:23:40.690+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6142

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6142
[2024-05-04T10:23:40.695+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:23:40.722+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.046 seconds
[2024-05-04T10:24:11.003+0000] {processor.py:157} INFO - Started process (PID=6178) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:24:11.004+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:24:11.006+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:24:11.006+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:24:41.018+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:24:41.014+0000] {timeout.py:68} ERROR - Process timed out, PID: 6178
[2024-05-04T10:24:41.026+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:24:41.020+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6178

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6178
[2024-05-04T10:24:41.028+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:24:41.056+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.056 seconds
[2024-05-04T10:25:11.522+0000] {processor.py:157} INFO - Started process (PID=6214) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:25:11.524+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:25:11.528+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:25:11.527+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:25:41.541+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:25:41.536+0000] {timeout.py:68} ERROR - Process timed out, PID: 6214
[2024-05-04T10:25:41.559+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:25:41.547+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6214

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6214
[2024-05-04T10:25:41.561+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:25:41.599+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-05-04T10:26:11.985+0000] {processor.py:157} INFO - Started process (PID=6250) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:26:11.986+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:26:11.989+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:26:11.989+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:26:41.991+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:26:41.988+0000] {timeout.py:68} ERROR - Process timed out, PID: 6250
[2024-05-04T10:26:42.001+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:26:41.994+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6250

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6250
[2024-05-04T10:26:42.003+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:26:42.033+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.060 seconds
[2024-05-04T10:27:12.091+0000] {processor.py:157} INFO - Started process (PID=6286) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:27:12.091+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:27:12.093+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:27:12.093+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:27:42.116+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:27:42.104+0000] {timeout.py:68} ERROR - Process timed out, PID: 6286
[2024-05-04T10:27:42.132+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:27:42.124+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6286

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6286
[2024-05-04T10:27:42.135+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:27:42.170+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.083 seconds
[2024-05-04T10:28:12.734+0000] {processor.py:157} INFO - Started process (PID=6322) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:28:12.734+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:28:12.737+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:28:12.736+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:28:42.758+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:28:42.747+0000] {timeout.py:68} ERROR - Process timed out, PID: 6322
[2024-05-04T10:28:42.776+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:28:42.765+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6322

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6322
[2024-05-04T10:28:42.779+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:28:42.820+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.091 seconds
[2024-05-04T10:29:13.207+0000] {processor.py:157} INFO - Started process (PID=6358) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:29:13.208+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:29:13.210+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:29:13.210+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:29:43.232+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:29:43.220+0000] {timeout.py:68} ERROR - Process timed out, PID: 6358
[2024-05-04T10:29:43.253+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:29:43.239+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6358

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6358
[2024-05-04T10:29:43.256+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:29:43.299+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.094 seconds
[2024-05-04T10:30:13.721+0000] {processor.py:157} INFO - Started process (PID=6394) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:30:13.722+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:30:13.724+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:30:13.724+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:30:43.742+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:30:43.738+0000] {timeout.py:68} ERROR - Process timed out, PID: 6394
[2024-05-04T10:30:43.754+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:30:43.745+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6394

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6394
[2024-05-04T10:30:43.756+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:30:43.782+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.065 seconds
[2024-05-04T10:31:14.317+0000] {processor.py:157} INFO - Started process (PID=6430) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:31:14.318+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:31:14.319+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:31:14.319+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:31:44.328+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:31:44.323+0000] {timeout.py:68} ERROR - Process timed out, PID: 6430
[2024-05-04T10:31:44.356+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:31:44.332+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6430

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6430
[2024-05-04T10:31:44.358+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:31:44.380+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.066 seconds
[2024-05-04T10:32:14.905+0000] {processor.py:157} INFO - Started process (PID=6465) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:32:14.906+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:32:14.909+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:32:14.909+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:32:44.916+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:32:44.914+0000] {timeout.py:68} ERROR - Process timed out, PID: 6465
[2024-05-04T10:32:44.922+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:32:44.918+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6465

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6465
[2024-05-04T10:32:44.924+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:32:44.944+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.044 seconds
[2024-05-04T10:33:15.547+0000] {processor.py:157} INFO - Started process (PID=6501) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:33:15.548+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:33:15.550+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:33:15.549+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:33:45.558+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:33:45.556+0000] {timeout.py:68} ERROR - Process timed out, PID: 6501
[2024-05-04T10:33:45.564+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:33:45.560+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6501

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6501
[2024-05-04T10:33:45.565+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:33:45.584+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.039 seconds
[2024-05-04T10:34:16.165+0000] {processor.py:157} INFO - Started process (PID=6537) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:34:16.167+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:34:16.172+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:34:16.171+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:34:46.183+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:34:46.181+0000] {timeout.py:68} ERROR - Process timed out, PID: 6537
[2024-05-04T10:34:46.190+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:34:46.185+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6537

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6537
[2024-05-04T10:34:46.191+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:34:46.210+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.053 seconds
[2024-05-04T10:35:16.660+0000] {processor.py:157} INFO - Started process (PID=6573) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:35:16.661+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:35:16.665+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:35:16.664+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:35:46.674+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:35:46.670+0000] {timeout.py:68} ERROR - Process timed out, PID: 6573
[2024-05-04T10:35:46.684+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:35:46.678+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6573

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6573
[2024-05-04T10:35:46.685+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:35:46.706+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.052 seconds
[2024-05-04T10:36:17.094+0000] {processor.py:157} INFO - Started process (PID=6609) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:36:17.094+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:36:17.096+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:36:17.095+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:36:47.126+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:36:47.109+0000] {timeout.py:68} ERROR - Process timed out, PID: 6609
[2024-05-04T10:36:47.149+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:36:47.134+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6609

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6609
[2024-05-04T10:36:47.153+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:36:47.203+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.113 seconds
[2024-05-04T10:37:17.517+0000] {processor.py:157} INFO - Started process (PID=6645) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:37:17.518+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:37:17.521+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:37:17.521+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:37:47.548+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:37:47.537+0000] {timeout.py:68} ERROR - Process timed out, PID: 6645
[2024-05-04T10:37:47.612+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:37:47.597+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6645

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6645
[2024-05-04T10:37:47.616+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:37:47.667+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.154 seconds
[2024-05-04T10:38:18.235+0000] {processor.py:157} INFO - Started process (PID=6675) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:38:18.236+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:38:18.238+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:38:18.237+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:38:48.255+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:38:48.247+0000] {timeout.py:68} ERROR - Process timed out, PID: 6675
[2024-05-04T10:38:48.271+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:38:48.260+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6675

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6675
[2024-05-04T10:38:48.274+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:38:48.311+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.079 seconds
[2024-05-04T10:39:18.472+0000] {processor.py:157} INFO - Started process (PID=6711) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:39:18.474+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:39:18.478+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:39:18.478+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:39:48.485+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:39:48.483+0000] {timeout.py:68} ERROR - Process timed out, PID: 6711
[2024-05-04T10:39:48.492+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:39:48.488+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6711

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6711
[2024-05-04T10:39:48.493+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:39:48.521+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.056 seconds
[2024-05-04T10:40:19.342+0000] {processor.py:157} INFO - Started process (PID=6747) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:40:19.343+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:40:19.347+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:40:19.346+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:40:49.360+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:40:49.355+0000] {timeout.py:68} ERROR - Process timed out, PID: 6747
[2024-05-04T10:40:49.372+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:40:49.363+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6747

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6747
[2024-05-04T10:40:49.377+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:40:49.418+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.079 seconds
[2024-05-04T10:41:19.537+0000] {processor.py:157} INFO - Started process (PID=6783) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:41:19.539+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:41:19.543+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:41:19.542+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:41:49.553+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:41:49.550+0000] {timeout.py:68} ERROR - Process timed out, PID: 6783
[2024-05-04T10:41:49.560+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:41:49.555+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6783

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6783
[2024-05-04T10:41:49.562+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:41:49.605+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.075 seconds
[2024-05-04T10:42:20.148+0000] {processor.py:157} INFO - Started process (PID=6819) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:42:20.149+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:42:20.153+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:42:20.152+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:42:50.164+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:42:50.158+0000] {timeout.py:68} ERROR - Process timed out, PID: 6819
[2024-05-04T10:42:50.176+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:42:50.168+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6819

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6819
[2024-05-04T10:42:50.178+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:42:50.220+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.077 seconds
[2024-05-04T10:43:20.284+0000] {processor.py:157} INFO - Started process (PID=6855) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:43:20.285+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:43:20.289+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:43:20.288+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:43:50.310+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:43:50.300+0000] {timeout.py:68} ERROR - Process timed out, PID: 6855
[2024-05-04T10:43:50.327+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:43:50.316+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6855

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6855
[2024-05-04T10:43:50.331+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:43:50.367+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.090 seconds
[2024-05-04T10:44:20.619+0000] {processor.py:157} INFO - Started process (PID=6891) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:44:20.621+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:44:20.625+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:44:20.624+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:44:50.650+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:44:50.637+0000] {timeout.py:68} ERROR - Process timed out, PID: 6891
[2024-05-04T10:44:50.666+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:44:50.658+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6891

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6891
[2024-05-04T10:44:50.668+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:44:50.697+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.084 seconds
[2024-05-04T10:45:20.814+0000] {processor.py:157} INFO - Started process (PID=6927) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:45:20.815+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:45:20.817+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:45:20.816+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:45:50.833+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:45:50.825+0000] {timeout.py:68} ERROR - Process timed out, PID: 6927
[2024-05-04T10:45:50.852+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:45:50.841+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6927

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6927
[2024-05-04T10:45:50.855+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:45:50.894+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-05-04T10:46:21.458+0000] {processor.py:157} INFO - Started process (PID=6963) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:46:21.459+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:46:21.462+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:46:21.461+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:46:51.478+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:46:51.471+0000] {timeout.py:68} ERROR - Process timed out, PID: 6963
[2024-05-04T10:46:51.495+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:46:51.485+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6963

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 6963
[2024-05-04T10:46:51.497+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:46:51.531+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.078 seconds
[2024-05-04T10:47:21.868+0000] {processor.py:157} INFO - Started process (PID=7000) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:47:21.868+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:47:21.870+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:47:21.870+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:47:51.874+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:47:51.872+0000] {timeout.py:68} ERROR - Process timed out, PID: 7000
[2024-05-04T10:47:51.879+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:47:51.876+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7000

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7000
[2024-05-04T10:47:51.880+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:47:51.896+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.031 seconds
[2024-05-04T10:48:22.033+0000] {processor.py:157} INFO - Started process (PID=7036) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:48:22.034+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:48:22.037+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:48:22.037+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:48:52.051+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:48:52.044+0000] {timeout.py:68} ERROR - Process timed out, PID: 7036
[2024-05-04T10:48:52.063+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:48:52.055+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7036

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7036
[2024-05-04T10:48:52.066+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:48:52.099+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.070 seconds
[2024-05-04T10:49:22.228+0000] {processor.py:157} INFO - Started process (PID=7072) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:49:22.229+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:49:22.231+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:49:22.231+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:49:52.247+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:49:52.244+0000] {timeout.py:68} ERROR - Process timed out, PID: 7072
[2024-05-04T10:49:52.253+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:49:52.249+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7072

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7072
[2024-05-04T10:49:52.255+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:49:52.289+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.063 seconds
[2024-05-04T10:50:22.574+0000] {processor.py:157} INFO - Started process (PID=7106) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:50:22.574+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:50:22.576+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:50:22.576+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:50:52.583+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:50:52.580+0000] {timeout.py:68} ERROR - Process timed out, PID: 7106
[2024-05-04T10:50:52.592+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:50:52.586+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7106

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7106
[2024-05-04T10:50:52.594+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:50:52.620+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.049 seconds
[2024-05-04T10:51:22.989+0000] {processor.py:157} INFO - Started process (PID=7142) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:51:22.990+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:51:22.991+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:51:22.991+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:51:53.013+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:51:53.009+0000] {timeout.py:68} ERROR - Process timed out, PID: 7142
[2024-05-04T10:51:53.021+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:51:53.016+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7142

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7142
[2024-05-04T10:51:53.023+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:51:53.046+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.049 seconds
[2024-05-04T10:52:23.475+0000] {processor.py:157} INFO - Started process (PID=7178) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:52:23.476+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:52:23.480+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:52:23.480+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:52:53.492+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:52:53.488+0000] {timeout.py:68} ERROR - Process timed out, PID: 7178
[2024-05-04T10:52:53.509+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:52:53.494+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7178

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7178
[2024-05-04T10:52:53.512+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:52:53.560+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.089 seconds
[2024-05-04T10:53:23.666+0000] {processor.py:157} INFO - Started process (PID=7214) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:53:23.668+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:53:23.672+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:53:23.671+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:53:53.690+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:53:53.685+0000] {timeout.py:68} ERROR - Process timed out, PID: 7214
[2024-05-04T10:53:53.712+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:53:53.700+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7214

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7214
[2024-05-04T10:53:53.714+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:53:53.748+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.087 seconds
[2024-05-04T10:54:24.172+0000] {processor.py:157} INFO - Started process (PID=7250) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:54:24.173+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:54:24.176+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:54:24.176+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:54:54.193+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:54:54.182+0000] {timeout.py:68} ERROR - Process timed out, PID: 7250
[2024-05-04T10:54:54.206+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:54:54.197+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7250

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7250
[2024-05-04T10:54:54.212+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:54:54.244+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.076 seconds
[2024-05-04T10:55:24.842+0000] {processor.py:157} INFO - Started process (PID=7286) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:55:24.843+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:55:24.847+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:55:24.846+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:55:54.871+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:55:54.866+0000] {timeout.py:68} ERROR - Process timed out, PID: 7286
[2024-05-04T10:55:54.878+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:55:54.874+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7286

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7286
[2024-05-04T10:55:54.880+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:55:54.902+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.060 seconds
[2024-05-04T10:56:25.675+0000] {processor.py:157} INFO - Started process (PID=7322) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:56:25.676+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:56:25.679+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:56:25.679+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:56:55.697+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:56:55.690+0000] {timeout.py:68} ERROR - Process timed out, PID: 7322
[2024-05-04T10:56:55.707+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:56:55.700+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7322

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7322
[2024-05-04T10:56:55.710+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:56:55.746+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.076 seconds
[2024-05-04T10:57:25.807+0000] {processor.py:157} INFO - Started process (PID=7358) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:57:25.808+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:57:25.811+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:57:25.810+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:57:55.823+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:57:55.821+0000] {timeout.py:68} ERROR - Process timed out, PID: 7358
[2024-05-04T10:57:55.827+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:57:55.824+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7358

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7358
[2024-05-04T10:57:55.828+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:57:55.846+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.045 seconds
[2024-05-04T10:58:26.286+0000] {processor.py:157} INFO - Started process (PID=7388) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:58:26.287+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:58:26.290+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:58:26.290+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:58:56.314+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:58:56.306+0000] {timeout.py:68} ERROR - Process timed out, PID: 7388
[2024-05-04T10:58:56.330+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:58:56.320+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7388

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7388
[2024-05-04T10:58:56.333+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:58:56.373+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.092 seconds
[2024-05-04T10:59:26.847+0000] {processor.py:157} INFO - Started process (PID=7423) to work on /opt/airflow/dags/train_model.py
[2024-05-04T10:59:26.849+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T10:59:26.856+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:59:26.855+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T10:59:56.869+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:59:56.863+0000] {timeout.py:68} ERROR - Process timed out, PID: 7423
[2024-05-04T10:59:56.888+0000] {logging_mixin.py:151} INFO - [2024-05-04T10:59:56.875+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7423

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7423
[2024-05-04T10:59:56.891+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T10:59:56.927+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.089 seconds
[2024-05-04T11:00:27.642+0000] {processor.py:157} INFO - Started process (PID=7459) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:00:27.644+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:00:27.650+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:00:27.649+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:00:57.685+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:00:57.672+0000] {timeout.py:68} ERROR - Process timed out, PID: 7459
[2024-05-04T11:00:57.703+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:00:57.691+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7459

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7459
[2024-05-04T11:00:57.707+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:00:57.747+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.113 seconds
[2024-05-04T11:01:28.438+0000] {processor.py:157} INFO - Started process (PID=7495) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:01:28.439+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:01:28.443+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:01:28.442+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:01:58.458+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:01:58.450+0000] {timeout.py:68} ERROR - Process timed out, PID: 7495
[2024-05-04T11:01:58.474+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:01:58.464+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7495

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7495
[2024-05-04T11:01:58.476+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:01:58.505+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.071 seconds
[2024-05-04T11:02:29.145+0000] {processor.py:157} INFO - Started process (PID=7532) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:02:29.146+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:02:29.150+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:02:29.150+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:02:59.166+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:02:59.159+0000] {timeout.py:68} ERROR - Process timed out, PID: 7532
[2024-05-04T11:02:59.180+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:02:59.170+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7532

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7532
[2024-05-04T11:02:59.183+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:02:59.225+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-05-04T11:03:29.414+0000] {processor.py:157} INFO - Started process (PID=7568) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:03:29.416+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:03:29.420+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:03:29.419+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:03:59.436+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:03:59.430+0000] {timeout.py:68} ERROR - Process timed out, PID: 7568
[2024-05-04T11:03:59.455+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:03:59.443+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7568

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7568
[2024-05-04T11:03:59.459+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:03:59.497+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.090 seconds
[2024-05-04T11:04:29.989+0000] {processor.py:157} INFO - Started process (PID=7604) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:04:29.991+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:04:29.995+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:04:29.994+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:05:00.028+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:05:00.022+0000] {timeout.py:68} ERROR - Process timed out, PID: 7604
[2024-05-04T11:05:00.037+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:05:00.031+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7604

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7604
[2024-05-04T11:05:00.038+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:05:00.069+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-05-04T11:05:30.349+0000] {processor.py:157} INFO - Started process (PID=7640) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:05:30.350+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:05:30.354+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:05:30.353+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:06:00.370+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:06:00.361+0000] {timeout.py:68} ERROR - Process timed out, PID: 7640
[2024-05-04T11:06:00.391+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:06:00.379+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7640

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7640
[2024-05-04T11:06:00.394+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:06:00.429+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-05-04T11:06:31.151+0000] {processor.py:157} INFO - Started process (PID=7676) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:06:31.152+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:06:31.156+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:06:31.156+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:07:01.183+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:07:01.172+0000] {timeout.py:68} ERROR - Process timed out, PID: 7676
[2024-05-04T11:07:01.198+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:07:01.189+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7676

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7676
[2024-05-04T11:07:01.202+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:07:01.243+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.095 seconds
[2024-05-04T11:07:31.583+0000] {processor.py:157} INFO - Started process (PID=7712) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:07:31.585+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:07:31.588+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:07:31.587+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:08:01.610+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:08:01.599+0000] {timeout.py:68} ERROR - Process timed out, PID: 7712
[2024-05-04T11:08:01.629+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:08:01.616+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7712

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7712
[2024-05-04T11:08:01.633+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:08:01.670+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.090 seconds
[2024-05-04T11:08:31.960+0000] {processor.py:157} INFO - Started process (PID=7748) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:08:31.962+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:08:31.965+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:08:31.964+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:09:01.975+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:09:01.969+0000] {timeout.py:68} ERROR - Process timed out, PID: 7748
[2024-05-04T11:09:01.981+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:09:01.977+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7748

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7748
[2024-05-04T11:09:01.983+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:09:02.009+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.053 seconds
[2024-05-04T11:09:32.122+0000] {processor.py:157} INFO - Started process (PID=7784) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:09:32.124+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:09:32.128+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:09:32.127+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:10:02.143+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:10:02.136+0000] {timeout.py:68} ERROR - Process timed out, PID: 7784
[2024-05-04T11:10:02.159+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:10:02.148+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7784

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7784
[2024-05-04T11:10:02.162+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:10:02.198+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.081 seconds
[2024-05-04T11:10:32.878+0000] {processor.py:157} INFO - Started process (PID=7820) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:10:32.879+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:10:32.881+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:10:32.881+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:11:02.900+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:11:02.890+0000] {timeout.py:68} ERROR - Process timed out, PID: 7820
[2024-05-04T11:11:02.914+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:11:02.908+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7820

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7820
[2024-05-04T11:11:02.916+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:11:02.946+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.072 seconds
[2024-05-04T11:11:33.292+0000] {processor.py:157} INFO - Started process (PID=7856) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:11:33.293+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:11:33.296+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:11:33.296+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:12:03.312+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:12:03.305+0000] {timeout.py:68} ERROR - Process timed out, PID: 7856
[2024-05-04T11:12:03.331+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:12:03.318+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7856

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7856
[2024-05-04T11:12:03.336+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:12:03.374+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.087 seconds
[2024-05-04T11:12:34.032+0000] {processor.py:157} INFO - Started process (PID=7892) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:12:34.033+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:12:34.039+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:12:34.037+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:13:04.057+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:13:04.046+0000] {timeout.py:68} ERROR - Process timed out, PID: 7892
[2024-05-04T11:13:04.075+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:13:04.064+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7892

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7892
[2024-05-04T11:13:04.078+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:13:04.119+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.094 seconds
[2024-05-04T11:13:34.806+0000] {processor.py:157} INFO - Started process (PID=7928) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:13:34.807+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:13:34.811+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:13:34.810+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:14:04.830+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:14:04.819+0000] {timeout.py:68} ERROR - Process timed out, PID: 7928
[2024-05-04T11:14:04.849+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:14:04.837+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7928

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7928
[2024-05-04T11:14:04.853+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:14:04.895+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.096 seconds
[2024-05-04T11:14:35.161+0000] {processor.py:157} INFO - Started process (PID=7964) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:14:35.162+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:14:35.164+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:14:35.164+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:15:05.183+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:15:05.172+0000] {timeout.py:68} ERROR - Process timed out, PID: 7964
[2024-05-04T11:15:05.198+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:15:05.188+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7964

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 7964
[2024-05-04T11:15:05.200+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:15:05.229+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.074 seconds
[2024-05-04T11:15:35.902+0000] {processor.py:157} INFO - Started process (PID=8000) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:15:35.903+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:15:35.906+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:15:35.905+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:16:05.918+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:16:05.913+0000] {timeout.py:68} ERROR - Process timed out, PID: 8000
[2024-05-04T11:16:05.930+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:16:05.921+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8000

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8000
[2024-05-04T11:16:05.932+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:16:05.964+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.066 seconds
[2024-05-04T11:16:36.681+0000] {processor.py:157} INFO - Started process (PID=8036) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:16:36.683+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:16:36.687+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:16:36.687+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:17:06.705+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:17:06.696+0000] {timeout.py:68} ERROR - Process timed out, PID: 8036
[2024-05-04T11:17:06.721+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:17:06.710+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8036

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8036
[2024-05-04T11:17:06.725+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:17:06.760+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.088 seconds
[2024-05-04T11:17:37.459+0000] {processor.py:157} INFO - Started process (PID=8072) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:17:37.461+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:17:37.465+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:17:37.464+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:18:07.478+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:18:07.471+0000] {timeout.py:68} ERROR - Process timed out, PID: 8072
[2024-05-04T11:18:07.491+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:18:07.482+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8072

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8072
[2024-05-04T11:18:07.493+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:18:07.524+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.070 seconds
[2024-05-04T11:18:38.240+0000] {processor.py:157} INFO - Started process (PID=8108) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:18:38.242+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:18:38.246+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:18:38.245+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:19:08.272+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:19:08.262+0000] {timeout.py:68} ERROR - Process timed out, PID: 8108
[2024-05-04T11:19:08.291+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:19:08.279+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8108

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8108
[2024-05-04T11:19:08.295+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:19:08.341+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.106 seconds
[2024-05-04T11:19:39.068+0000] {processor.py:157} INFO - Started process (PID=8144) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:19:39.069+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:19:39.073+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:19:39.072+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:20:09.091+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:20:09.084+0000] {timeout.py:68} ERROR - Process timed out, PID: 8144
[2024-05-04T11:20:09.111+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:20:09.096+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8144

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8144
[2024-05-04T11:20:09.113+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:20:09.162+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.099 seconds
[2024-05-04T11:20:39.814+0000] {processor.py:157} INFO - Started process (PID=8181) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:20:39.815+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:20:39.819+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:20:39.818+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:21:09.829+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:21:09.824+0000] {timeout.py:68} ERROR - Process timed out, PID: 8181
[2024-05-04T11:21:09.837+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:21:09.832+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8181

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8181
[2024-05-04T11:21:09.839+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:21:09.866+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.057 seconds
[2024-05-04T11:21:40.235+0000] {processor.py:157} INFO - Started process (PID=8210) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:21:40.235+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:21:40.238+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:21:40.238+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:22:10.247+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:22:10.241+0000] {timeout.py:68} ERROR - Process timed out, PID: 8210
[2024-05-04T11:22:10.257+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:22:10.250+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8210

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8210
[2024-05-04T11:22:10.259+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:22:10.284+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.058 seconds
[2024-05-04T11:22:41.113+0000] {processor.py:157} INFO - Started process (PID=8244) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:22:41.115+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:22:41.119+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:22:41.118+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:23:11.155+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:23:11.130+0000] {timeout.py:68} ERROR - Process timed out, PID: 8244
[2024-05-04T11:23:11.175+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:23:11.161+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8244

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8244
[2024-05-04T11:23:11.179+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:23:11.221+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.117 seconds
[2024-05-04T11:23:42.017+0000] {processor.py:157} INFO - Started process (PID=8281) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:23:42.019+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:23:42.022+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:23:42.022+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:24:12.043+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:24:12.033+0000] {timeout.py:68} ERROR - Process timed out, PID: 8281
[2024-05-04T11:24:12.058+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:24:12.049+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8281

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8281
[2024-05-04T11:24:12.062+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:24:12.102+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.090 seconds
[2024-05-04T11:24:42.824+0000] {processor.py:157} INFO - Started process (PID=8317) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:24:42.825+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:24:42.828+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:24:42.828+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:25:12.852+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:25:12.838+0000] {timeout.py:68} ERROR - Process timed out, PID: 8317
[2024-05-04T11:25:12.876+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:25:12.861+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8317

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8317
[2024-05-04T11:25:12.880+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:25:12.925+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.105 seconds
[2024-05-04T11:25:43.024+0000] {processor.py:157} INFO - Started process (PID=8353) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:25:43.025+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:25:43.029+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:25:43.028+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:26:13.045+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:26:13.035+0000] {timeout.py:68} ERROR - Process timed out, PID: 8353
[2024-05-04T11:26:13.068+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:26:13.053+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8353

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8353
[2024-05-04T11:26:13.071+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:26:13.112+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.094 seconds
[2024-05-04T11:26:43.858+0000] {processor.py:157} INFO - Started process (PID=8389) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:26:43.859+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:26:43.860+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:26:43.860+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:27:13.873+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:27:13.866+0000] {timeout.py:68} ERROR - Process timed out, PID: 8389
[2024-05-04T11:27:13.884+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:27:13.877+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8389

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8389
[2024-05-04T11:27:13.886+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:27:13.915+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.058 seconds
[2024-05-04T11:27:44.022+0000] {processor.py:157} INFO - Started process (PID=8425) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:27:44.023+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:27:44.027+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:27:44.026+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:28:14.035+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:28:14.032+0000] {timeout.py:68} ERROR - Process timed out, PID: 8425
[2024-05-04T11:28:14.042+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:28:14.038+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8425

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8425
[2024-05-04T11:28:14.043+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:28:14.063+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.046 seconds
[2024-05-04T11:28:44.139+0000] {processor.py:157} INFO - Started process (PID=8461) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:28:44.140+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:28:44.144+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:28:44.143+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:29:14.169+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:29:14.155+0000] {timeout.py:68} ERROR - Process timed out, PID: 8461
[2024-05-04T11:29:14.191+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:29:14.178+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8461

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8461
[2024-05-04T11:29:14.196+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:29:14.258+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.126 seconds
[2024-05-04T11:29:44.814+0000] {processor.py:157} INFO - Started process (PID=8497) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:29:44.815+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:29:44.819+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:29:44.818+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:30:14.843+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:30:14.830+0000] {timeout.py:68} ERROR - Process timed out, PID: 8497
[2024-05-04T11:30:14.867+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:30:14.851+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8497

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8497
[2024-05-04T11:30:14.870+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:30:14.910+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.102 seconds
[2024-05-04T11:30:45.823+0000] {processor.py:157} INFO - Started process (PID=8533) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:30:45.826+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:30:45.830+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:30:45.829+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:31:15.852+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:31:15.839+0000] {timeout.py:68} ERROR - Process timed out, PID: 8533
[2024-05-04T11:31:15.872+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:31:15.858+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8533

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8533
[2024-05-04T11:31:15.877+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:31:15.962+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.144 seconds
[2024-05-04T11:31:46.678+0000] {processor.py:157} INFO - Started process (PID=8569) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:31:46.678+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:31:46.681+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:31:46.680+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:32:16.688+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:32:16.684+0000] {timeout.py:68} ERROR - Process timed out, PID: 8569
[2024-05-04T11:32:16.696+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:32:16.691+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8569

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8569
[2024-05-04T11:32:16.698+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:32:16.720+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.045 seconds
[2024-05-04T11:32:46.802+0000] {processor.py:157} INFO - Started process (PID=8605) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:32:46.803+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:32:46.807+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:32:46.806+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:33:16.823+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:33:16.815+0000] {timeout.py:68} ERROR - Process timed out, PID: 8605
[2024-05-04T11:33:16.837+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:33:16.828+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8605

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8605
[2024-05-04T11:33:16.840+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:33:16.883+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.088 seconds
[2024-05-04T11:33:47.621+0000] {processor.py:157} INFO - Started process (PID=8641) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:33:47.621+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:33:47.623+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:33:47.623+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:34:17.661+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:34:17.641+0000] {timeout.py:68} ERROR - Process timed out, PID: 8641
[2024-05-04T11:34:17.680+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:34:17.667+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8641

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8641
[2024-05-04T11:34:17.685+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:34:17.739+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.120 seconds
[2024-05-04T11:34:48.559+0000] {processor.py:157} INFO - Started process (PID=8677) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:34:48.561+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:34:48.566+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:34:48.565+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:35:18.591+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:35:18.579+0000] {timeout.py:68} ERROR - Process timed out, PID: 8677
[2024-05-04T11:35:18.612+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:35:18.598+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8677

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8677
[2024-05-04T11:35:18.616+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:35:18.666+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.113 seconds
[2024-05-04T11:35:49.548+0000] {processor.py:157} INFO - Started process (PID=8713) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:35:49.549+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:35:49.553+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:35:49.553+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:36:19.564+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:36:19.559+0000] {timeout.py:68} ERROR - Process timed out, PID: 8713
[2024-05-04T11:36:19.573+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:36:19.567+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8713

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8713
[2024-05-04T11:36:19.575+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:36:19.602+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.062 seconds
[2024-05-04T11:36:50.406+0000] {processor.py:157} INFO - Started process (PID=8750) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:36:50.408+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:36:50.412+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:36:50.411+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:37:20.433+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:37:20.421+0000] {timeout.py:68} ERROR - Process timed out, PID: 8750
[2024-05-04T11:37:20.451+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:37:20.439+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8750

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8750
[2024-05-04T11:37:20.455+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:37:20.496+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.097 seconds
[2024-05-04T11:37:51.206+0000] {processor.py:157} INFO - Started process (PID=8786) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:37:51.208+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:37:51.213+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:37:51.212+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:38:21.240+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:38:21.225+0000] {timeout.py:68} ERROR - Process timed out, PID: 8786
[2024-05-04T11:38:21.262+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:38:21.247+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8786

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8786
[2024-05-04T11:38:21.267+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:38:21.333+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.136 seconds
[2024-05-04T11:38:52.148+0000] {processor.py:157} INFO - Started process (PID=8822) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:38:52.149+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:38:52.153+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:38:52.153+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:39:22.180+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:39:22.162+0000] {timeout.py:68} ERROR - Process timed out, PID: 8822
[2024-05-04T11:39:22.197+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:39:22.187+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8822

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8822
[2024-05-04T11:39:22.199+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:39:22.238+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.098 seconds
[2024-05-04T11:39:52.940+0000] {processor.py:157} INFO - Started process (PID=8858) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:39:52.941+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:39:52.945+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:39:52.944+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:40:22.958+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:40:22.953+0000] {timeout.py:68} ERROR - Process timed out, PID: 8858
[2024-05-04T11:40:22.975+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:40:22.962+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8858

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8858
[2024-05-04T11:40:22.978+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:40:23.013+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.080 seconds
[2024-05-04T11:40:53.670+0000] {processor.py:157} INFO - Started process (PID=8894) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:40:53.671+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:40:53.675+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:40:53.675+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:41:23.699+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:41:23.686+0000] {timeout.py:68} ERROR - Process timed out, PID: 8894
[2024-05-04T11:41:23.720+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:41:23.706+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8894

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8894
[2024-05-04T11:41:23.724+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:41:23.768+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.104 seconds
[2024-05-04T11:41:54.375+0000] {processor.py:157} INFO - Started process (PID=8937) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:41:54.376+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:41:54.378+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:41:54.377+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:42:24.392+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:42:24.385+0000] {timeout.py:68} ERROR - Process timed out, PID: 8937
[2024-05-04T11:42:24.405+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:42:24.396+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8937

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8937
[2024-05-04T11:42:24.407+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:42:24.442+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.069 seconds
[2024-05-04T11:42:55.244+0000] {processor.py:157} INFO - Started process (PID=8973) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:42:55.246+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:42:55.249+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:42:55.249+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:43:25.273+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:43:25.261+0000] {timeout.py:68} ERROR - Process timed out, PID: 8973
[2024-05-04T11:43:25.290+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:43:25.279+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8973

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 8973
[2024-05-04T11:43:25.305+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:43:25.368+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.129 seconds
[2024-05-04T11:43:56.061+0000] {processor.py:157} INFO - Started process (PID=9009) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:43:56.063+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:43:56.066+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:43:56.066+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:44:26.210+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:44:26.210+0000] {timeout.py:68} ERROR - Process timed out, PID: 9009
[2024-05-04T11:44:26.215+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:44:26.213+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9009

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9009
[2024-05-04T11:44:26.216+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:44:26.227+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.171 seconds
[2024-05-04T11:44:56.880+0000] {processor.py:157} INFO - Started process (PID=9045) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:44:56.881+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:44:56.886+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:44:56.885+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:45:26.907+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:45:26.898+0000] {timeout.py:68} ERROR - Process timed out, PID: 9045
[2024-05-04T11:45:26.925+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:45:26.914+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9045

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9045
[2024-05-04T11:45:26.928+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:45:26.968+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.095 seconds
[2024-05-04T11:45:57.751+0000] {processor.py:157} INFO - Started process (PID=9080) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:45:57.753+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:45:57.757+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:45:57.756+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:46:27.779+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:46:27.769+0000] {timeout.py:68} ERROR - Process timed out, PID: 9080
[2024-05-04T11:46:27.797+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:46:27.786+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9080

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9080
[2024-05-04T11:46:27.800+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:46:27.828+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.083 seconds
[2024-05-04T11:46:58.479+0000] {processor.py:157} INFO - Started process (PID=9117) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:46:58.480+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:46:58.483+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:46:58.483+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:47:28.493+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:47:28.489+0000] {timeout.py:68} ERROR - Process timed out, PID: 9117
[2024-05-04T11:47:28.500+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:47:28.495+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9117

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9117
[2024-05-04T11:47:28.501+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:47:28.523+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.050 seconds
[2024-05-04T11:47:58.939+0000] {processor.py:157} INFO - Started process (PID=9146) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:47:58.940+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:47:58.942+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:47:58.942+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:48:28.939+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:48:28.936+0000] {timeout.py:68} ERROR - Process timed out, PID: 9146
[2024-05-04T11:48:28.944+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:48:28.941+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9146

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9146
[2024-05-04T11:48:28.946+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:48:28.965+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.040 seconds
[2024-05-04T11:48:59.638+0000] {processor.py:157} INFO - Started process (PID=9181) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:48:59.639+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:48:59.641+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:48:59.641+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:49:29.907+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:49:29.906+0000] {timeout.py:68} ERROR - Process timed out, PID: 9181
[2024-05-04T11:49:29.913+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:49:29.908+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9181

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9181
[2024-05-04T11:49:29.913+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:49:29.931+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.296 seconds
[2024-05-04T11:50:00.602+0000] {processor.py:157} INFO - Started process (PID=9217) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:50:00.604+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:50:00.608+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:50:00.608+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:50:30.631+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:50:30.619+0000] {timeout.py:68} ERROR - Process timed out, PID: 9217
[2024-05-04T11:50:30.652+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:50:30.639+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9217

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9217
[2024-05-04T11:50:30.655+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:50:30.706+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.111 seconds
[2024-05-04T11:51:01.509+0000] {processor.py:157} INFO - Started process (PID=9253) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:51:01.510+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:51:01.515+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:51:01.514+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:51:31.548+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:51:31.522+0000] {timeout.py:68} ERROR - Process timed out, PID: 9253
[2024-05-04T11:51:31.558+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:51:31.551+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9253

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9253
[2024-05-04T11:51:31.560+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:51:31.600+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.098 seconds
[2024-05-04T11:52:01.838+0000] {processor.py:157} INFO - Started process (PID=9289) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:52:01.839+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:52:01.844+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:52:01.843+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:52:31.870+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:52:31.853+0000] {timeout.py:68} ERROR - Process timed out, PID: 9289
[2024-05-04T11:52:31.891+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:52:31.878+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9289

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9289
[2024-05-04T11:52:31.896+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:52:31.946+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.115 seconds
[2024-05-04T11:53:02.797+0000] {processor.py:157} INFO - Started process (PID=9325) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:53:02.799+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:53:02.805+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:53:02.804+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:53:32.811+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:53:32.799+0000] {timeout.py:68} ERROR - Process timed out, PID: 9325
[2024-05-04T11:53:32.833+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:53:32.820+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9325

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9325
[2024-05-04T11:53:32.836+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:53:32.875+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.111 seconds
[2024-05-04T11:54:03.688+0000] {processor.py:157} INFO - Started process (PID=9361) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:54:03.689+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:54:03.693+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:54:03.692+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:54:33.713+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:54:33.703+0000] {timeout.py:68} ERROR - Process timed out, PID: 9361
[2024-05-04T11:54:33.732+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:54:33.719+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9361

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9361
[2024-05-04T11:54:33.736+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:54:33.774+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.092 seconds
[2024-05-04T11:55:04.513+0000] {processor.py:157} INFO - Started process (PID=9397) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:55:04.515+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:55:04.520+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:55:04.519+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:55:34.552+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:55:34.536+0000] {timeout.py:68} ERROR - Process timed out, PID: 9397
[2024-05-04T11:55:34.574+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:55:34.561+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9397

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9397
[2024-05-04T11:55:34.578+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:55:34.628+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.122 seconds
[2024-05-04T11:56:05.397+0000] {processor.py:157} INFO - Started process (PID=9433) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:56:05.398+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:56:05.403+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:56:05.402+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:56:35.567+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:56:35.567+0000] {timeout.py:68} ERROR - Process timed out, PID: 9433
[2024-05-04T11:56:35.571+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:56:35.568+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9433

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9433
[2024-05-04T11:56:35.571+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:56:35.583+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.192 seconds
[2024-05-04T11:57:06.499+0000] {processor.py:157} INFO - Started process (PID=9469) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:57:06.500+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:57:06.505+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:57:06.504+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:57:36.531+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:57:36.518+0000] {timeout.py:68} ERROR - Process timed out, PID: 9469
[2024-05-04T11:57:36.555+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:57:36.540+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9469

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9469
[2024-05-04T11:57:36.559+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:57:36.601+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.109 seconds
[2024-05-04T11:58:07.433+0000] {processor.py:157} INFO - Started process (PID=9505) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:58:07.434+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:58:07.437+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:58:07.437+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:58:37.625+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:58:37.624+0000] {timeout.py:68} ERROR - Process timed out, PID: 9505
[2024-05-04T11:58:37.629+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:58:37.626+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9505

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9505
[2024-05-04T11:58:37.630+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:58:37.643+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.216 seconds
[2024-05-04T11:59:08.242+0000] {processor.py:157} INFO - Started process (PID=9541) to work on /opt/airflow/dags/train_model.py
[2024-05-04T11:59:08.244+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T11:59:08.249+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:59:08.248+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T11:59:38.281+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:59:38.265+0000] {timeout.py:68} ERROR - Process timed out, PID: 9541
[2024-05-04T11:59:38.297+0000] {logging_mixin.py:151} INFO - [2024-05-04T11:59:38.287+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9541

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9541
[2024-05-04T11:59:38.301+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T11:59:38.380+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.145 seconds
[2024-05-04T12:00:09.063+0000] {processor.py:157} INFO - Started process (PID=9577) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:00:09.065+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:00:09.069+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:00:09.068+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:00:39.185+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:00:39.185+0000] {timeout.py:68} ERROR - Process timed out, PID: 9577
[2024-05-04T12:00:39.188+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:00:39.186+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9577

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9577
[2024-05-04T12:00:39.189+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:00:39.201+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.145 seconds
[2024-05-04T12:01:09.986+0000] {processor.py:157} INFO - Started process (PID=9613) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:01:09.988+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:01:09.992+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:01:09.991+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:01:40.006+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:01:39.999+0000] {timeout.py:68} ERROR - Process timed out, PID: 9613
[2024-05-04T12:01:40.024+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:01:40.012+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9613

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9613
[2024-05-04T12:01:40.026+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:01:40.061+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.080 seconds
[2024-05-04T12:02:10.952+0000] {processor.py:157} INFO - Started process (PID=9649) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:02:10.954+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:02:10.957+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:02:10.956+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:02:40.981+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:02:40.967+0000] {timeout.py:68} ERROR - Process timed out, PID: 9649
[2024-05-04T12:02:41.001+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:02:40.990+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9649

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9649
[2024-05-04T12:02:41.004+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:02:41.047+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.098 seconds
[2024-05-04T12:03:11.861+0000] {processor.py:157} INFO - Started process (PID=9685) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:03:11.862+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:03:11.865+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:03:11.865+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:03:41.882+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:03:41.877+0000] {timeout.py:68} ERROR - Process timed out, PID: 9685
[2024-05-04T12:03:41.891+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:03:41.885+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9685

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9685
[2024-05-04T12:03:41.893+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:03:41.920+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.064 seconds
[2024-05-04T12:04:12.733+0000] {processor.py:157} INFO - Started process (PID=9721) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:04:12.735+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:04:12.739+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:04:12.739+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:04:42.766+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:04:42.749+0000] {timeout.py:68} ERROR - Process timed out, PID: 9721
[2024-05-04T12:04:42.789+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:04:42.775+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9721

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9721
[2024-05-04T12:04:42.793+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:04:42.830+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.105 seconds
[2024-05-04T12:05:13.546+0000] {processor.py:157} INFO - Started process (PID=9757) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:05:13.547+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:05:13.552+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:05:13.551+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:05:43.579+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:05:43.564+0000] {timeout.py:68} ERROR - Process timed out, PID: 9757
[2024-05-04T12:05:43.601+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:05:43.588+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9757

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9757
[2024-05-04T12:05:43.605+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:05:43.650+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.112 seconds
[2024-05-04T12:06:14.474+0000] {processor.py:157} INFO - Started process (PID=9793) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:06:14.476+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:06:14.480+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:06:14.479+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:06:44.507+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:06:44.491+0000] {timeout.py:68} ERROR - Process timed out, PID: 9793
[2024-05-04T12:06:44.527+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:06:44.514+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9793

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9793
[2024-05-04T12:06:44.531+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:06:44.579+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.111 seconds
[2024-05-04T12:07:15.359+0000] {processor.py:157} INFO - Started process (PID=9829) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:07:15.360+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:07:15.365+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:07:15.364+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:07:45.637+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:07:45.635+0000] {timeout.py:68} ERROR - Process timed out, PID: 9829
[2024-05-04T12:07:45.668+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:07:45.665+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9829

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9829
[2024-05-04T12:07:45.669+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:07:45.685+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.332 seconds
[2024-05-04T12:08:16.446+0000] {processor.py:157} INFO - Started process (PID=9865) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:08:16.448+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:08:16.452+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:08:16.452+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:08:46.478+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:08:46.465+0000] {timeout.py:68} ERROR - Process timed out, PID: 9865
[2024-05-04T12:08:46.498+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:08:46.484+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9865

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9865
[2024-05-04T12:08:46.501+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:08:46.542+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.100 seconds
[2024-05-04T12:09:16.631+0000] {processor.py:157} INFO - Started process (PID=9901) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:09:16.633+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:09:16.638+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:09:16.637+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:09:46.652+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:09:46.647+0000] {timeout.py:68} ERROR - Process timed out, PID: 9901
[2024-05-04T12:09:46.662+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:09:46.656+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9901

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9901
[2024-05-04T12:09:46.664+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:09:46.685+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.060 seconds
[2024-05-04T12:10:17.299+0000] {processor.py:157} INFO - Started process (PID=9937) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:10:17.301+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:10:17.305+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:10:17.304+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:10:47.311+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:10:47.309+0000] {timeout.py:68} ERROR - Process timed out, PID: 9937
[2024-05-04T12:10:47.317+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:10:47.313+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9937

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9937
[2024-05-04T12:10:47.318+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:10:47.338+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.046 seconds
[2024-05-04T12:11:18.039+0000] {processor.py:157} INFO - Started process (PID=9973) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:11:18.040+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:11:18.042+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:11:18.042+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:11:48.055+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:11:48.046+0000] {timeout.py:68} ERROR - Process timed out, PID: 9973
[2024-05-04T12:11:48.072+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:11:48.060+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9973

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 9973
[2024-05-04T12:11:48.074+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:11:48.111+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.076 seconds
[2024-05-04T12:12:18.962+0000] {processor.py:157} INFO - Started process (PID=10009) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:12:18.964+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:12:18.966+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:12:18.966+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:12:48.992+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:12:48.982+0000] {timeout.py:68} ERROR - Process timed out, PID: 10009
[2024-05-04T12:12:49.008+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:12:48.996+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10009

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10009
[2024-05-04T12:12:49.011+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:12:49.048+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.087 seconds
[2024-05-04T12:13:19.613+0000] {processor.py:157} INFO - Started process (PID=10045) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:13:19.615+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:13:19.620+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:13:19.619+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:13:49.644+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:13:49.634+0000] {timeout.py:68} ERROR - Process timed out, PID: 10045
[2024-05-04T12:13:49.664+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:13:49.650+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10045

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10045
[2024-05-04T12:13:49.668+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:13:49.708+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.103 seconds
[2024-05-04T12:14:20.354+0000] {processor.py:157} INFO - Started process (PID=10081) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:14:20.356+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:14:20.360+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:14:20.359+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:14:50.448+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:14:50.447+0000] {timeout.py:68} ERROR - Process timed out, PID: 10081
[2024-05-04T12:14:50.451+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:14:50.449+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10081

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10081
[2024-05-04T12:14:50.452+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:14:50.463+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.116 seconds
[2024-05-04T12:15:21.155+0000] {processor.py:157} INFO - Started process (PID=10117) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:15:21.157+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:15:21.161+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:15:21.160+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:15:51.170+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:15:51.166+0000] {timeout.py:68} ERROR - Process timed out, PID: 10117
[2024-05-04T12:15:51.176+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:15:51.172+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10117

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10117
[2024-05-04T12:15:51.177+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:15:51.196+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.046 seconds
[2024-05-04T12:16:22.049+0000] {processor.py:157} INFO - Started process (PID=10153) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:16:22.050+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:16:22.051+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:16:22.051+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:16:52.071+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:16:52.061+0000] {timeout.py:68} ERROR - Process timed out, PID: 10153
[2024-05-04T12:16:52.099+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:16:52.085+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10153

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10153
[2024-05-04T12:16:52.102+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:16:52.143+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.095 seconds
[2024-05-04T12:17:22.580+0000] {processor.py:157} INFO - Started process (PID=10181) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:17:22.582+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:17:22.586+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:17:22.585+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:17:52.613+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:17:52.598+0000] {timeout.py:68} ERROR - Process timed out, PID: 10181
[2024-05-04T12:17:52.637+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:17:52.623+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10181

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10181
[2024-05-04T12:17:52.641+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:17:52.687+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.113 seconds
[2024-05-04T12:18:23.054+0000] {processor.py:157} INFO - Started process (PID=10217) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:18:23.056+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:18:23.063+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:18:23.062+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:18:53.087+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:18:53.074+0000] {timeout.py:68} ERROR - Process timed out, PID: 10217
[2024-05-04T12:18:53.107+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:18:53.093+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10217

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10217
[2024-05-04T12:18:53.111+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:18:53.153+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.106 seconds
[2024-05-04T12:19:23.510+0000] {processor.py:157} INFO - Started process (PID=10253) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:19:23.512+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:19:23.518+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:19:23.517+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:19:53.559+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:19:53.540+0000] {timeout.py:68} ERROR - Process timed out, PID: 10253
[2024-05-04T12:19:53.574+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:19:53.565+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10253

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10253
[2024-05-04T12:19:53.577+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:19:53.619+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.110 seconds
[2024-05-04T12:20:24.040+0000] {processor.py:157} INFO - Started process (PID=10289) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:20:24.042+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:20:24.046+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:20:24.045+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:20:54.063+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:20:54.055+0000] {timeout.py:68} ERROR - Process timed out, PID: 10289
[2024-05-04T12:20:54.084+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:20:54.069+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10289

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10289
[2024-05-04T12:20:54.092+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:20:54.144+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.110 seconds
[2024-05-04T12:21:24.574+0000] {processor.py:157} INFO - Started process (PID=10325) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:21:24.575+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:21:24.579+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:21:24.578+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:21:54.593+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:21:54.585+0000] {timeout.py:68} ERROR - Process timed out, PID: 10325
[2024-05-04T12:21:54.607+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:21:54.598+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10325

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10325
[2024-05-04T12:21:54.610+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:21:54.644+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.076 seconds
[2024-05-04T12:22:25.099+0000] {processor.py:157} INFO - Started process (PID=10361) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:22:25.101+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:22:25.104+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:22:25.103+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:22:55.128+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:22:55.116+0000] {timeout.py:68} ERROR - Process timed out, PID: 10361
[2024-05-04T12:22:55.149+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:22:55.138+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10361

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10361
[2024-05-04T12:22:55.153+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:22:55.194+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.102 seconds
[2024-05-04T12:23:25.638+0000] {processor.py:157} INFO - Started process (PID=10397) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:23:25.639+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:23:25.640+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:23:25.640+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:23:55.652+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:23:55.645+0000] {timeout.py:68} ERROR - Process timed out, PID: 10397
[2024-05-04T12:23:55.667+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:23:55.657+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10397

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10397
[2024-05-04T12:23:55.670+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:23:55.705+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.069 seconds
[2024-05-04T12:24:26.497+0000] {processor.py:157} INFO - Started process (PID=10433) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:24:26.499+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:24:26.503+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:24:26.502+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:24:56.523+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:24:56.514+0000] {timeout.py:68} ERROR - Process timed out, PID: 10433
[2024-05-04T12:24:56.539+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:24:56.529+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10433

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10433
[2024-05-04T12:24:56.542+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:24:56.579+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.088 seconds
[2024-05-04T12:25:27.467+0000] {processor.py:157} INFO - Started process (PID=10469) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:25:27.469+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:25:27.475+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:25:27.475+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:25:57.491+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:25:57.482+0000] {timeout.py:68} ERROR - Process timed out, PID: 10469
[2024-05-04T12:25:57.505+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:25:57.495+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10469

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10469
[2024-05-04T12:25:57.509+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T12:25:57.552+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.092 seconds
[2024-05-04T12:26:28.188+0000] {processor.py:157} INFO - Started process (PID=10505) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:26:28.190+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:26:28.194+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:26:28.193+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:26:29.027+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:26:29.027+0000] {connectionpool.py:823} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff591cb8b0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-05-04T12:26:33.037+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:26:33.034+0000] {connectionpool.py:823} WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff591cbd30>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-05-04T12:26:41.066+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:26:41.061+0000] {connectionpool.py:823} WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff591cbbe0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-05-04T12:28:04.190+0000] {processor.py:157} INFO - Started process (PID=10541) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:28:04.192+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:28:04.198+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:28:04.197+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:44:27.968+0000] {processor.py:157} INFO - Started process (PID=10577) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:44:27.972+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:44:27.980+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:44:27.979+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T12:50:53.309+0000] {processor.py:157} INFO - Started process (PID=10614) to work on /opt/airflow/dags/train_model.py
[2024-05-04T12:50:53.312+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T12:50:53.316+0000] {logging_mixin.py:151} INFO - [2024-05-04T12:50:53.316+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T13:08:03.115+0000] {processor.py:157} INFO - Started process (PID=10650) to work on /opt/airflow/dags/train_model.py
[2024-05-04T13:08:03.117+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T13:08:03.124+0000] {logging_mixin.py:151} INFO - [2024-05-04T13:08:03.123+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T13:08:23.316+0000] {logging_mixin.py:151} INFO - [2024-05-04T13:08:23.313+0000] {connectionpool.py:823} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff58fe5490>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-05-04T13:25:03.168+0000] {processor.py:157} INFO - Started process (PID=10686) to work on /opt/airflow/dags/train_model.py
[2024-05-04T13:25:03.170+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T13:25:03.174+0000] {logging_mixin.py:151} INFO - [2024-05-04T13:25:03.174+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T13:25:23.167+0000] {logging_mixin.py:151} INFO - [2024-05-04T13:25:23.158+0000] {connectionpool.py:823} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff58fc2eb0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-05-04T13:41:52.150+0000] {processor.py:157} INFO - Started process (PID=10723) to work on /opt/airflow/dags/train_model.py
[2024-05-04T13:41:52.152+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T13:41:52.157+0000] {logging_mixin.py:151} INFO - [2024-05-04T13:41:52.156+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T13:57:56.085+0000] {processor.py:157} INFO - Started process (PID=10759) to work on /opt/airflow/dags/train_model.py
[2024-05-04T13:57:56.088+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T13:57:56.095+0000] {logging_mixin.py:151} INFO - [2024-05-04T13:57:56.094+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T13:58:07.984+0000] {logging_mixin.py:151} INFO - [2024-05-04T13:58:07.977+0000] {connectionpool.py:823} WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff591cb790>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=mlflow_tracking_examples
[2024-05-04T14:31:23.415+0000] {processor.py:157} INFO - Started process (PID=10803) to work on /opt/airflow/dags/train_model.py
[2024-05-04T14:31:23.416+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T14:31:23.419+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:31:23.419+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T14:31:53.463+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:31:53.443+0000] {timeout.py:68} ERROR - Process timed out, PID: 10803
[2024-05-04T14:31:53.484+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:31:53.470+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10803

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10803
[2024-05-04T14:31:53.489+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T14:31:53.540+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.123 seconds
[2024-05-04T14:49:52.447+0000] {processor.py:157} INFO - Started process (PID=10839) to work on /opt/airflow/dags/train_model.py
[2024-05-04T14:49:52.448+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T14:49:52.450+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:49:52.450+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T14:50:22.443+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:50:22.432+0000] {timeout.py:68} ERROR - Process timed out, PID: 10839
[2024-05-04T14:50:22.460+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:50:22.450+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10839

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10839
[2024-05-04T14:50:22.464+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T14:50:22.522+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.113 seconds
[2024-05-04T14:50:53.017+0000] {processor.py:157} INFO - Started process (PID=10867) to work on /opt/airflow/dags/train_model.py
[2024-05-04T14:50:53.019+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T14:50:53.027+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:50:53.026+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T14:51:23.049+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:51:23.037+0000] {timeout.py:68} ERROR - Process timed out, PID: 10867
[2024-05-04T14:51:23.065+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:51:23.059+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10867

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10867
[2024-05-04T14:51:23.067+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T14:51:23.094+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-05-04T14:51:53.479+0000] {processor.py:157} INFO - Started process (PID=10903) to work on /opt/airflow/dags/train_model.py
[2024-05-04T14:51:53.480+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T14:51:53.482+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:51:53.482+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T14:52:23.498+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:52:23.491+0000] {timeout.py:68} ERROR - Process timed out, PID: 10903
[2024-05-04T14:52:23.515+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:52:23.503+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10903

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10903
[2024-05-04T14:52:23.517+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T14:52:23.551+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.073 seconds
[2024-05-04T14:52:54.045+0000] {processor.py:157} INFO - Started process (PID=10939) to work on /opt/airflow/dags/train_model.py
[2024-05-04T14:52:54.047+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T14:52:54.051+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:52:54.050+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T14:53:24.080+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:53:24.064+0000] {timeout.py:68} ERROR - Process timed out, PID: 10939
[2024-05-04T14:53:24.097+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:53:24.086+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10939

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10939
[2024-05-04T14:53:24.101+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T14:53:24.146+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.106 seconds
[2024-05-04T14:53:54.827+0000] {processor.py:157} INFO - Started process (PID=10975) to work on /opt/airflow/dags/train_model.py
[2024-05-04T14:53:54.829+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T14:53:54.834+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:53:54.833+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T14:54:24.872+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:54:24.854+0000] {timeout.py:68} ERROR - Process timed out, PID: 10975
[2024-05-04T14:54:24.898+0000] {logging_mixin.py:151} INFO - [2024-05-04T14:54:24.880+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10975

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 10975
[2024-05-04T14:54:24.903+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T14:54:24.985+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.164 seconds
[2024-05-04T15:11:09.832+0000] {processor.py:157} INFO - Started process (PID=11019) to work on /opt/airflow/dags/train_model.py
[2024-05-04T15:11:09.833+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T15:11:09.835+0000] {logging_mixin.py:151} INFO - [2024-05-04T15:11:09.835+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T15:11:39.860+0000] {logging_mixin.py:151} INFO - [2024-05-04T15:11:39.838+0000] {timeout.py:68} ERROR - Process timed out, PID: 11019
[2024-05-04T15:11:39.883+0000] {logging_mixin.py:151} INFO - [2024-05-04T15:11:39.870+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 11019

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 11019
[2024-05-04T15:11:39.888+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T15:11:39.939+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.117 seconds
[2024-05-04T15:28:13.015+0000] {processor.py:157} INFO - Started process (PID=11055) to work on /opt/airflow/dags/train_model.py
[2024-05-04T15:28:13.026+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T15:28:13.033+0000] {logging_mixin.py:151} INFO - [2024-05-04T15:28:13.031+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T15:44:39.483+0000] {processor.py:157} INFO - Started process (PID=11083) to work on /opt/airflow/dags/train_model.py
[2024-05-04T15:44:39.484+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T15:44:39.492+0000] {logging_mixin.py:151} INFO - [2024-05-04T15:44:39.487+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T15:50:36.607+0000] {processor.py:157} INFO - Started process (PID=11119) to work on /opt/airflow/dags/train_model.py
[2024-05-04T15:50:36.608+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T15:50:36.612+0000] {logging_mixin.py:151} INFO - [2024-05-04T15:50:36.611+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T15:56:34.076+0000] {processor.py:157} INFO - Started process (PID=11155) to work on /opt/airflow/dags/train_model.py
[2024-05-04T15:56:34.078+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T15:56:34.085+0000] {logging_mixin.py:151} INFO - [2024-05-04T15:56:34.084+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:02:32.342+0000] {processor.py:157} INFO - Started process (PID=11191) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:02:32.345+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:02:32.352+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:02:32.351+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:03:02.370+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:03:02.353+0000] {timeout.py:68} ERROR - Process timed out, PID: 11191
[2024-05-04T16:03:02.395+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:03:02.379+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 11191

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 11191
[2024-05-04T16:03:02.401+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:03:02.469+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.150 seconds
[2024-05-04T16:20:43.893+0000] {processor.py:157} INFO - Started process (PID=11235) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:20:43.894+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:20:43.896+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:20:43.895+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:38:17.485+0000] {processor.py:157} INFO - Started process (PID=11263) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:38:17.488+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:38:17.505+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:38:17.503+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:42:06.404+0000] {processor.py:157} INFO - Started process (PID=11299) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:42:06.405+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:42:06.410+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:42:06.410+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:42:36.436+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:42:36.418+0000] {timeout.py:68} ERROR - Process timed out, PID: 11299
[2024-05-04T16:42:36.455+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:42:36.443+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 11299

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 11299
[2024-05-04T16:42:36.458+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:42:36.498+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.103 seconds
[2024-05-04T16:43:07.452+0000] {processor.py:157} INFO - Started process (PID=11335) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:43:07.454+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:43:07.461+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:43:07.460+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:43:37.520+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:43:37.499+0000] {timeout.py:68} ERROR - Process timed out, PID: 11335
[2024-05-04T16:43:37.550+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:43:37.526+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 11335

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 11335
[2024-05-04T16:43:37.554+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:43:37.636+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.178 seconds
[2024-05-04T16:44:08.441+0000] {processor.py:157} INFO - Started process (PID=11371) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:44:08.443+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:44:08.448+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:44:08.447+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:44:38.472+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:44:38.457+0000] {timeout.py:68} ERROR - Process timed out, PID: 11371
[2024-05-04T16:44:38.508+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:44:38.483+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 11371

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 11371
[2024-05-04T16:44:38.515+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:44:38.605+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.170 seconds
[2024-05-04T16:45:09.435+0000] {processor.py:157} INFO - Started process (PID=11407) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:45:09.437+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:45:09.444+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:45:09.443+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:45:39.470+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:45:39.456+0000] {timeout.py:68} ERROR - Process timed out, PID: 11407
[2024-05-04T16:45:39.506+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:45:39.479+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 11407

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 11407
[2024-05-04T16:45:39.511+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:45:39.599+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.173 seconds
[2024-05-04T16:46:10.467+0000] {processor.py:157} INFO - Started process (PID=11443) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:46:10.471+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:46:10.479+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:46:10.478+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:46:40.491+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:46:40.486+0000] {timeout.py:68} ERROR - Process timed out, PID: 11443
[2024-05-04T16:46:40.499+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:46:40.494+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 11443

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 11443
[2024-05-04T16:46:40.501+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:46:40.527+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.071 seconds
[2024-05-04T16:47:10.732+0000] {processor.py:157} INFO - Started process (PID=11479) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:47:10.734+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:47:10.741+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:47:10.741+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:47:40.752+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:47:40.747+0000] {timeout.py:68} ERROR - Process timed out, PID: 11479
[2024-05-04T16:47:40.766+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:47:40.756+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 11479

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 11479
[2024-05-04T16:47:40.768+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:47:40.804+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.084 seconds
[2024-05-04T16:49:00.968+0000] {processor.py:157} INFO - Started process (PID=60) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:49:00.969+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:49:00.972+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:49:00.971+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:49:30.984+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:49:30.978+0000] {timeout.py:68} ERROR - Process timed out, PID: 60
[2024-05-04T16:49:31.010+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:49:30.991+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 60

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 60
[2024-05-04T16:49:31.018+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:49:31.066+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.103 seconds
[2024-05-04T16:50:01.261+0000] {processor.py:157} INFO - Started process (PID=89) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:50:01.263+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:50:01.269+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:50:01.268+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:50:31.301+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:50:31.292+0000] {timeout.py:68} ERROR - Process timed out, PID: 89
[2024-05-04T16:50:31.316+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:50:31.306+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 89

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 89
[2024-05-04T16:50:31.319+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:50:31.381+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.134 seconds
[2024-05-04T16:51:01.683+0000] {processor.py:157} INFO - Started process (PID=125) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:51:01.684+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:51:01.688+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:51:01.688+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:51:31.703+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:51:31.695+0000] {timeout.py:68} ERROR - Process timed out, PID: 125
[2024-05-04T16:51:31.719+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:51:31.708+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 125

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 125
[2024-05-04T16:51:31.722+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:51:31.756+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.083 seconds
[2024-05-04T16:52:02.543+0000] {processor.py:157} INFO - Started process (PID=161) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:52:02.546+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:52:02.550+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:52:02.550+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:52:33.830+0000] {processor.py:157} INFO - Started process (PID=42) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:52:33.831+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:52:33.833+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:52:33.833+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:53:03.856+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:53:03.842+0000] {timeout.py:68} ERROR - Process timed out, PID: 42
[2024-05-04T16:53:03.882+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:53:03.870+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 42

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 42
[2024-05-04T16:53:03.886+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:53:03.927+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.100 seconds
[2024-05-04T16:53:34.350+0000] {processor.py:157} INFO - Started process (PID=70) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:53:34.351+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:53:34.355+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:53:34.354+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:54:04.379+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:54:04.364+0000] {timeout.py:68} ERROR - Process timed out, PID: 70
[2024-05-04T16:54:04.401+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:54:04.389+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 70

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 70
[2024-05-04T16:54:04.405+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:54:04.455+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.110 seconds
[2024-05-04T16:54:35.389+0000] {processor.py:157} INFO - Started process (PID=106) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:54:35.389+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:54:35.391+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:54:35.390+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:55:05.415+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:55:05.400+0000] {timeout.py:68} ERROR - Process timed out, PID: 106
[2024-05-04T16:55:05.441+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:55:05.425+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 106

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 106
[2024-05-04T16:55:05.447+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:55:05.514+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.126 seconds
[2024-05-04T16:55:36.077+0000] {processor.py:157} INFO - Started process (PID=142) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:55:36.079+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:55:36.082+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:55:36.082+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:56:06.095+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:56:06.088+0000] {timeout.py:68} ERROR - Process timed out, PID: 142
[2024-05-04T16:56:06.114+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:56:06.104+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 142

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 142
[2024-05-04T16:56:06.116+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:56:06.143+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.074 seconds
[2024-05-04T16:56:36.235+0000] {processor.py:157} INFO - Started process (PID=178) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:56:36.236+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:56:36.239+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:56:36.239+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:57:06.249+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:57:06.245+0000] {timeout.py:68} ERROR - Process timed out, PID: 178
[2024-05-04T16:57:06.265+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:57:06.254+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 178

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 178
[2024-05-04T16:57:06.267+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:57:06.302+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.071 seconds
[2024-05-04T16:57:36.665+0000] {processor.py:157} INFO - Started process (PID=214) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:57:36.666+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:57:36.668+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:57:36.668+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:58:06.682+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:58:06.674+0000] {timeout.py:68} ERROR - Process timed out, PID: 214
[2024-05-04T16:58:06.698+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:58:06.687+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 214

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 214
[2024-05-04T16:58:06.701+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:58:06.744+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.083 seconds
[2024-05-04T16:58:37.453+0000] {processor.py:157} INFO - Started process (PID=250) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:58:37.455+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:58:37.458+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:58:37.458+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T16:59:07.472+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:59:07.466+0000] {timeout.py:68} ERROR - Process timed out, PID: 250
[2024-05-04T16:59:07.489+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:59:07.478+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 250

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 250
[2024-05-04T16:59:07.492+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T16:59:07.528+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.080 seconds
[2024-05-04T16:59:38.111+0000] {processor.py:157} INFO - Started process (PID=286) to work on /opt/airflow/dags/train_model.py
[2024-05-04T16:59:38.112+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T16:59:38.116+0000] {logging_mixin.py:151} INFO - [2024-05-04T16:59:38.115+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:00:08.125+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:00:08.121+0000] {timeout.py:68} ERROR - Process timed out, PID: 286
[2024-05-04T17:00:08.141+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:00:08.130+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 286

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 286
[2024-05-04T17:00:08.144+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:00:08.177+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.072 seconds
[2024-05-04T17:00:38.740+0000] {processor.py:157} INFO - Started process (PID=322) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:00:38.742+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:00:38.746+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:00:38.745+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:01:08.761+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:01:08.753+0000] {timeout.py:68} ERROR - Process timed out, PID: 322
[2024-05-04T17:01:08.778+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:01:08.767+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 322

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 322
[2024-05-04T17:01:08.781+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:01:08.819+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-05-04T17:01:39.461+0000] {processor.py:157} INFO - Started process (PID=358) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:01:39.462+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:01:39.463+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:01:39.463+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:02:09.471+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:02:09.470+0000] {timeout.py:68} ERROR - Process timed out, PID: 358
[2024-05-04T17:02:09.477+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:02:09.473+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 358

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 358
[2024-05-04T17:02:09.477+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:02:09.494+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.035 seconds
[2024-05-04T17:02:40.277+0000] {processor.py:157} INFO - Started process (PID=394) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:02:40.278+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:02:40.281+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:02:40.281+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:03:10.288+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:03:10.285+0000] {timeout.py:68} ERROR - Process timed out, PID: 394
[2024-05-04T17:03:10.297+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:03:10.291+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 394

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 394
[2024-05-04T17:03:10.298+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:03:10.324+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.054 seconds
[2024-05-04T17:03:40.973+0000] {processor.py:157} INFO - Started process (PID=430) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:03:40.974+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:03:40.977+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:03:40.977+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:04:10.997+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:04:10.987+0000] {timeout.py:68} ERROR - Process timed out, PID: 430
[2024-05-04T17:04:11.018+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:04:11.006+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 430

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 430
[2024-05-04T17:04:11.021+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:04:11.059+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.093 seconds
[2024-05-04T17:04:41.610+0000] {processor.py:157} INFO - Started process (PID=466) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:04:41.611+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:04:41.614+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:04:41.613+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:05:11.619+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:05:11.617+0000] {timeout.py:68} ERROR - Process timed out, PID: 466
[2024-05-04T17:05:11.639+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:05:11.631+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 466

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 466
[2024-05-04T17:05:11.641+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:05:11.670+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.064 seconds
[2024-05-04T17:05:42.336+0000] {processor.py:157} INFO - Started process (PID=503) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:05:42.337+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:05:42.340+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:05:42.340+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:06:12.359+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:06:12.354+0000] {timeout.py:68} ERROR - Process timed out, PID: 503
[2024-05-04T17:06:12.373+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:06:12.364+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 503

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 503
[2024-05-04T17:06:12.375+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:06:12.409+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.079 seconds
[2024-05-04T17:06:43.200+0000] {processor.py:157} INFO - Started process (PID=538) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:06:43.203+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:06:43.208+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:06:43.207+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:07:13.220+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:07:13.216+0000] {timeout.py:68} ERROR - Process timed out, PID: 538
[2024-05-04T17:07:13.235+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:07:13.225+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 538

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 538
[2024-05-04T17:07:13.238+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:07:13.271+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.080 seconds
[2024-05-04T17:07:44.006+0000] {processor.py:157} INFO - Started process (PID=574) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:07:44.007+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:07:44.009+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:07:44.009+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:08:14.019+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:08:14.014+0000] {timeout.py:68} ERROR - Process timed out, PID: 574
[2024-05-04T17:08:14.047+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:08:14.029+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 574

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 574
[2024-05-04T17:08:14.050+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:08:14.084+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.081 seconds
[2024-05-04T17:08:44.424+0000] {processor.py:157} INFO - Started process (PID=610) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:08:44.425+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:08:44.428+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:08:44.428+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:09:14.450+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:09:14.440+0000] {timeout.py:68} ERROR - Process timed out, PID: 610
[2024-05-04T17:09:14.469+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:09:14.457+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 610

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 610
[2024-05-04T17:09:14.473+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:09:14.516+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.097 seconds
[2024-05-04T17:09:44.739+0000] {processor.py:157} INFO - Started process (PID=646) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:09:44.740+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:09:44.743+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:09:44.743+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:10:14.781+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:10:14.758+0000] {timeout.py:68} ERROR - Process timed out, PID: 646
[2024-05-04T17:10:14.824+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:10:14.790+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 646

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 646
[2024-05-04T17:10:14.829+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:10:14.881+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.149 seconds
[2024-05-04T17:10:45.069+0000] {processor.py:157} INFO - Started process (PID=681) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:10:45.072+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:10:45.086+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:10:45.084+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:11:15.129+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:11:15.115+0000] {timeout.py:68} ERROR - Process timed out, PID: 681
[2024-05-04T17:11:15.184+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:11:15.142+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 681

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 681
[2024-05-04T17:11:15.198+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:11:15.240+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.183 seconds
[2024-05-04T17:11:45.585+0000] {processor.py:157} INFO - Started process (PID=717) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:11:45.587+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:11:45.590+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:11:45.590+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:12:15.614+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:12:15.599+0000] {timeout.py:68} ERROR - Process timed out, PID: 717
[2024-05-04T17:12:15.636+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:12:15.623+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 717

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 717
[2024-05-04T17:12:15.639+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:12:15.682+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.102 seconds
[2024-05-04T17:12:46.230+0000] {processor.py:157} INFO - Started process (PID=752) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:12:46.232+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:12:46.235+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:12:46.235+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:13:16.258+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:13:16.243+0000] {timeout.py:68} ERROR - Process timed out, PID: 752
[2024-05-04T17:13:16.281+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:13:16.266+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 752

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 752
[2024-05-04T17:13:16.285+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:13:16.337+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.119 seconds
[2024-05-04T17:13:46.488+0000] {processor.py:157} INFO - Started process (PID=788) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:13:46.489+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:13:46.490+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:13:46.490+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:14:16.498+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:14:16.493+0000] {timeout.py:68} ERROR - Process timed out, PID: 788
[2024-05-04T17:14:16.525+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:14:16.506+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 788

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 788
[2024-05-04T17:14:16.526+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:14:16.553+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.069 seconds
[2024-05-04T17:14:46.874+0000] {processor.py:157} INFO - Started process (PID=825) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:14:46.875+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:14:46.879+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:14:46.878+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:15:16.905+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:15:16.890+0000] {timeout.py:68} ERROR - Process timed out, PID: 825
[2024-05-04T17:15:16.921+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:15:16.910+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 825

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 825
[2024-05-04T17:15:16.923+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:15:16.955+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.089 seconds
[2024-05-04T17:15:47.195+0000] {processor.py:157} INFO - Started process (PID=861) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:15:47.197+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:15:47.200+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:15:47.199+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:16:17.223+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:16:17.220+0000] {timeout.py:68} ERROR - Process timed out, PID: 861
[2024-05-04T17:16:17.230+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:16:17.226+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 861

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 861
[2024-05-04T17:16:17.231+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:16:17.251+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.046 seconds
[2024-05-04T17:16:47.554+0000] {processor.py:157} INFO - Started process (PID=896) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:16:47.555+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:16:47.556+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:16:47.556+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:17:17.561+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:17:17.560+0000] {timeout.py:68} ERROR - Process timed out, PID: 896
[2024-05-04T17:17:17.570+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:17:17.563+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 896

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 896
[2024-05-04T17:17:17.571+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:17:17.584+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.032 seconds
[2024-05-04T17:17:47.828+0000] {processor.py:157} INFO - Started process (PID=932) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:17:47.829+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:17:47.831+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:17:47.831+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:18:17.839+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:18:17.837+0000] {timeout.py:68} ERROR - Process timed out, PID: 932
[2024-05-04T17:18:17.847+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:18:17.841+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 932

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 932
[2024-05-04T17:18:17.848+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:18:17.870+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.044 seconds
[2024-05-04T17:18:48.311+0000] {processor.py:157} INFO - Started process (PID=963) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:18:48.313+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:18:48.316+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:18:48.315+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:19:18.323+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:19:18.321+0000] {timeout.py:68} ERROR - Process timed out, PID: 963
[2024-05-04T17:19:18.335+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:19:18.326+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 963

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 963
[2024-05-04T17:19:18.337+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:19:18.359+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.053 seconds
[2024-05-04T17:19:48.897+0000] {processor.py:157} INFO - Started process (PID=998) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:19:48.898+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:19:48.901+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:19:48.901+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:20:18.919+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:20:18.912+0000] {timeout.py:68} ERROR - Process timed out, PID: 998
[2024-05-04T17:20:18.942+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:20:18.934+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 998

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 998
[2024-05-04T17:20:18.945+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:20:18.976+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.082 seconds
[2024-05-04T17:20:49.589+0000] {processor.py:157} INFO - Started process (PID=1034) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:20:49.590+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:20:49.592+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:20:49.592+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:21:19.607+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:21:19.598+0000] {timeout.py:68} ERROR - Process timed out, PID: 1034
[2024-05-04T17:21:19.620+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:21:19.612+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1034

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1034
[2024-05-04T17:21:19.622+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:21:19.651+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.066 seconds
[2024-05-04T17:21:50.207+0000] {processor.py:157} INFO - Started process (PID=1070) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:21:50.208+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:21:50.210+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:21:50.210+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:22:20.223+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:22:20.216+0000] {timeout.py:68} ERROR - Process timed out, PID: 1070
[2024-05-04T17:22:20.235+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:22:20.227+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1070

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1070
[2024-05-04T17:22:20.237+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:22:20.265+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.061 seconds
[2024-05-04T17:22:50.616+0000] {processor.py:157} INFO - Started process (PID=1105) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:22:50.617+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:22:50.619+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:22:50.619+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:23:20.627+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:23:20.624+0000] {timeout.py:68} ERROR - Process timed out, PID: 1105
[2024-05-04T17:23:20.637+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:23:20.630+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1105

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1105
[2024-05-04T17:23:20.638+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:23:20.667+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.056 seconds
[2024-05-04T17:23:51.221+0000] {processor.py:157} INFO - Started process (PID=1140) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:23:51.221+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:23:51.225+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:23:51.224+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:24:21.239+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:24:21.232+0000] {timeout.py:68} ERROR - Process timed out, PID: 1140
[2024-05-04T17:24:21.253+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:24:21.245+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1140

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1140
[2024-05-04T17:24:21.256+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:24:21.288+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.071 seconds
[2024-05-04T17:24:51.493+0000] {processor.py:157} INFO - Started process (PID=1182) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:24:51.494+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:24:51.498+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:24:51.497+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:25:21.509+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:25:21.503+0000] {timeout.py:68} ERROR - Process timed out, PID: 1182
[2024-05-04T17:25:21.524+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:25:21.514+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1182

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1182
[2024-05-04T17:25:21.527+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:25:21.560+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.073 seconds
[2024-05-04T17:25:52.107+0000] {processor.py:157} INFO - Started process (PID=1218) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:25:52.108+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:25:52.111+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:25:52.110+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:26:22.118+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:26:22.111+0000] {timeout.py:68} ERROR - Process timed out, PID: 1218
[2024-05-04T17:26:22.127+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:26:22.121+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1218

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1218
[2024-05-04T17:26:22.129+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:26:22.154+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.055 seconds
[2024-05-04T17:26:52.260+0000] {processor.py:157} INFO - Started process (PID=1254) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:26:52.262+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:26:52.266+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:26:52.265+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:27:22.279+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:27:22.275+0000] {timeout.py:68} ERROR - Process timed out, PID: 1254
[2024-05-04T17:27:22.294+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:27:22.284+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1254

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1254
[2024-05-04T17:27:22.296+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:27:22.324+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.073 seconds
[2024-05-04T17:27:52.540+0000] {processor.py:157} INFO - Started process (PID=1290) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:27:52.542+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:27:52.546+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:27:52.546+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:28:22.570+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:28:22.566+0000] {timeout.py:68} ERROR - Process timed out, PID: 1290
[2024-05-04T17:28:22.584+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:28:22.573+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1290

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1290
[2024-05-04T17:28:22.586+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:28:22.621+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.088 seconds
[2024-05-04T17:28:52.710+0000] {processor.py:157} INFO - Started process (PID=1326) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:28:52.711+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:28:52.714+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:28:52.713+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:29:22.737+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:29:22.725+0000] {timeout.py:68} ERROR - Process timed out, PID: 1326
[2024-05-04T17:29:22.768+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:29:22.749+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1326

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1326
[2024-05-04T17:29:22.771+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:29:22.799+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.094 seconds
[2024-05-04T17:29:53.440+0000] {processor.py:157} INFO - Started process (PID=1362) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:29:53.440+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:29:53.443+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:29:53.442+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:31:20.712+0000] {processor.py:157} INFO - Started process (PID=60) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:31:20.713+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:31:20.718+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:31:20.718+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:31:50.730+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:31:50.722+0000] {timeout.py:68} ERROR - Process timed out, PID: 60
[2024-05-04T17:31:50.741+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:31:50.734+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 60

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 60
[2024-05-04T17:31:50.744+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:31:50.789+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.082 seconds
[2024-05-04T17:32:21.490+0000] {processor.py:157} INFO - Started process (PID=89) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:32:21.492+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:32:21.496+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:32:21.495+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:32:51.512+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:32:51.504+0000] {timeout.py:68} ERROR - Process timed out, PID: 89
[2024-05-04T17:32:51.534+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:32:51.528+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 89

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 89
[2024-05-04T17:32:51.536+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:32:51.582+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.098 seconds
[2024-05-04T17:33:21.962+0000] {processor.py:157} INFO - Started process (PID=124) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:33:21.963+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:33:21.968+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:33:21.967+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:33:51.998+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:33:51.979+0000] {timeout.py:68} ERROR - Process timed out, PID: 124
[2024-05-04T17:33:52.026+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:33:52.008+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 124

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 124
[2024-05-04T17:33:52.030+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:33:52.070+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.115 seconds
[2024-05-04T17:34:22.496+0000] {processor.py:157} INFO - Started process (PID=160) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:34:22.499+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:34:22.506+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:34:22.505+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:34:52.515+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:34:52.513+0000] {timeout.py:68} ERROR - Process timed out, PID: 160
[2024-05-04T17:34:52.524+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:34:52.518+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 160

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 160
[2024-05-04T17:34:52.526+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:34:52.553+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.066 seconds
[2024-05-04T17:35:23.107+0000] {processor.py:157} INFO - Started process (PID=196) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:35:23.108+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:35:23.110+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:35:23.109+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:35:53.117+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:35:53.115+0000] {timeout.py:68} ERROR - Process timed out, PID: 196
[2024-05-04T17:35:53.131+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:35:53.121+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 196

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 196
[2024-05-04T17:35:53.137+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:35:53.171+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.067 seconds
[2024-05-04T17:36:23.320+0000] {processor.py:157} INFO - Started process (PID=232) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:36:23.321+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:36:23.325+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:36:23.324+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:36:53.332+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:36:53.330+0000] {timeout.py:68} ERROR - Process timed out, PID: 232
[2024-05-04T17:36:53.339+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:36:53.334+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 232

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 232
[2024-05-04T17:36:53.340+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:36:53.364+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.049 seconds
[2024-05-04T17:37:23.500+0000] {processor.py:157} INFO - Started process (PID=268) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:37:23.501+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:37:23.504+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:37:23.503+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:37:53.509+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:37:53.509+0000] {timeout.py:68} ERROR - Process timed out, PID: 268
[2024-05-04T17:37:53.513+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:37:53.511+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 268

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 268
[2024-05-04T17:37:53.514+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:37:53.528+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.032 seconds
[2024-05-04T17:38:23.641+0000] {processor.py:157} INFO - Started process (PID=304) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:38:23.642+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:38:23.646+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:38:23.645+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:38:53.676+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:38:53.674+0000] {timeout.py:68} ERROR - Process timed out, PID: 304
[2024-05-04T17:38:53.683+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:38:53.679+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 304

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 304
[2024-05-04T17:38:53.685+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:38:53.709+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.073 seconds
[2024-05-04T17:39:24.066+0000] {processor.py:157} INFO - Started process (PID=340) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:39:24.067+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:39:24.071+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:39:24.071+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:39:54.082+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:39:54.078+0000] {timeout.py:68} ERROR - Process timed out, PID: 340
[2024-05-04T17:39:54.099+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:39:54.087+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 340

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 340
[2024-05-04T17:39:54.103+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:39:54.142+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.084 seconds
[2024-05-04T17:40:24.340+0000] {processor.py:157} INFO - Started process (PID=378) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:40:24.341+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:40:24.344+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:40:24.344+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:40:54.358+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:40:54.351+0000] {timeout.py:68} ERROR - Process timed out, PID: 378
[2024-05-04T17:40:54.384+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:40:54.376+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 378

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 378
[2024-05-04T17:40:54.386+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:40:54.416+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.082 seconds
[2024-05-04T17:41:24.627+0000] {processor.py:157} INFO - Started process (PID=419) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:41:24.628+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:41:24.630+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:41:24.630+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:41:54.638+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:41:54.635+0000] {timeout.py:68} ERROR - Process timed out, PID: 419
[2024-05-04T17:41:54.644+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:41:54.640+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 419

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 419
[2024-05-04T17:41:54.645+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:41:54.663+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.039 seconds
[2024-05-04T17:42:25.048+0000] {processor.py:157} INFO - Started process (PID=455) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:42:25.050+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:42:25.055+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:42:25.054+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:42:55.068+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:42:55.064+0000] {timeout.py:68} ERROR - Process timed out, PID: 455
[2024-05-04T17:42:55.090+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:42:55.073+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 455

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 455
[2024-05-04T17:42:55.096+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:42:55.130+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.088 seconds
[2024-05-04T17:43:25.662+0000] {processor.py:157} INFO - Started process (PID=491) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:43:25.665+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:43:25.670+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:43:25.670+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:43:55.677+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:43:55.675+0000] {timeout.py:68} ERROR - Process timed out, PID: 491
[2024-05-04T17:43:55.685+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:43:55.680+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 491

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 491
[2024-05-04T17:43:55.686+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:43:55.711+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.060 seconds
[2024-05-04T17:44:26.237+0000] {processor.py:157} INFO - Started process (PID=527) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:44:26.237+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:44:26.239+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:44:26.239+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:44:56.243+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:44:56.242+0000] {timeout.py:68} ERROR - Process timed out, PID: 527
[2024-05-04T17:44:56.248+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:44:56.244+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 527

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 527
[2024-05-04T17:44:56.248+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:44:56.263+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.030 seconds
[2024-05-04T17:45:26.414+0000] {processor.py:157} INFO - Started process (PID=562) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:45:26.416+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:45:26.419+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:45:26.419+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:45:56.434+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:45:56.428+0000] {timeout.py:68} ERROR - Process timed out, PID: 562
[2024-05-04T17:45:56.446+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:45:56.439+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 562

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 562
[2024-05-04T17:45:56.448+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:45:56.480+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.072 seconds
[2024-05-04T17:46:26.951+0000] {processor.py:157} INFO - Started process (PID=598) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:46:26.952+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:46:26.956+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:46:26.955+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:46:56.967+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:46:56.966+0000] {timeout.py:68} ERROR - Process timed out, PID: 598
[2024-05-04T17:46:56.971+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:46:56.968+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 598

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 598
[2024-05-04T17:46:56.972+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:46:56.986+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.038 seconds
[2024-05-04T17:47:27.202+0000] {processor.py:157} INFO - Started process (PID=634) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:47:27.203+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:47:27.205+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:47:27.204+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:47:57.209+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:47:57.207+0000] {timeout.py:68} ERROR - Process timed out, PID: 634
[2024-05-04T17:47:57.213+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:47:57.210+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 634

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 634
[2024-05-04T17:47:57.214+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:47:57.234+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.035 seconds
[2024-05-04T17:48:21.738+0000] {processor.py:157} INFO - Started process (PID=681) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:48:21.740+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:48:21.745+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:48:21.744+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:48:51.785+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:48:51.766+0000] {timeout.py:68} ERROR - Process timed out, PID: 681
[2024-05-04T17:48:51.810+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:48:51.799+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 681

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 681
[2024-05-04T17:48:51.813+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:48:51.868+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.136 seconds
[2024-05-04T17:49:22.549+0000] {processor.py:157} INFO - Started process (PID=711) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:49:22.551+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:49:22.555+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:49:22.554+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:49:52.576+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:49:52.567+0000] {timeout.py:68} ERROR - Process timed out, PID: 711
[2024-05-04T17:49:52.597+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:49:52.583+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 711

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 711
[2024-05-04T17:49:52.600+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:49:52.630+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.089 seconds
[2024-05-04T17:50:22.943+0000] {processor.py:157} INFO - Started process (PID=747) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:50:22.946+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:50:22.949+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:50:22.949+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:50:52.984+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:50:52.965+0000] {timeout.py:68} ERROR - Process timed out, PID: 747
[2024-05-04T17:50:53.005+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:50:52.992+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 747

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 747
[2024-05-04T17:50:53.010+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:50:53.056+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.118 seconds
[2024-05-04T17:51:23.777+0000] {processor.py:157} INFO - Started process (PID=783) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:51:23.778+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:51:23.780+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:51:23.779+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:51:53.784+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:51:53.783+0000] {timeout.py:68} ERROR - Process timed out, PID: 783
[2024-05-04T17:51:53.790+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:51:53.786+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 783

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 783
[2024-05-04T17:51:53.791+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:51:53.806+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.033 seconds
[2024-05-04T17:52:32.247+0000] {processor.py:157} INFO - Started process (PID=36) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:52:32.248+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:52:32.250+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:52:32.250+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:53:02.260+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:53:02.256+0000] {timeout.py:68} ERROR - Process timed out, PID: 36
[2024-05-04T17:53:02.268+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:53:02.264+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 36

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 36
[2024-05-04T17:53:02.270+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:53:02.291+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.047 seconds
[2024-05-04T17:53:33.219+0000] {processor.py:157} INFO - Started process (PID=71) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:53:33.221+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:53:33.226+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:53:33.225+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:54:03.235+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:54:03.232+0000] {timeout.py:68} ERROR - Process timed out, PID: 71
[2024-05-04T17:54:03.243+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:54:03.238+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 71

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 71
[2024-05-04T17:54:03.244+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:54:03.265+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.052 seconds
[2024-05-04T17:54:33.983+0000] {processor.py:157} INFO - Started process (PID=107) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:54:33.984+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:54:33.986+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:54:33.986+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:55:03.992+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:55:03.989+0000] {timeout.py:68} ERROR - Process timed out, PID: 107
[2024-05-04T17:55:04.013+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:55:03.999+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 107

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 107
[2024-05-04T17:55:04.014+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:55:04.043+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.063 seconds
[2024-05-04T17:55:34.572+0000] {processor.py:157} INFO - Started process (PID=143) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:55:34.572+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:55:34.576+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:55:34.576+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:56:04.586+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:56:04.582+0000] {timeout.py:68} ERROR - Process timed out, PID: 143
[2024-05-04T17:56:04.592+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:56:04.588+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 143

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 143
[2024-05-04T17:56:04.594+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:56:04.612+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.043 seconds
[2024-05-04T17:56:35.221+0000] {processor.py:157} INFO - Started process (PID=179) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:56:35.222+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:56:35.226+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:56:35.225+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:57:05.247+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:57:05.236+0000] {timeout.py:68} ERROR - Process timed out, PID: 179
[2024-05-04T17:57:05.269+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:57:05.256+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 179

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 179
[2024-05-04T17:57:05.274+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:57:05.308+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.092 seconds
[2024-05-04T17:57:35.693+0000] {processor.py:157} INFO - Started process (PID=221) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:57:35.695+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:57:35.698+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:57:35.697+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T17:58:05.710+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:58:05.704+0000] {timeout.py:68} ERROR - Process timed out, PID: 221
[2024-05-04T17:58:05.722+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:58:05.714+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 221

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 221
[2024-05-04T17:58:05.725+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T17:58:05.754+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.067 seconds
[2024-05-04T17:59:34.723+0000] {processor.py:157} INFO - Started process (PID=53) to work on /opt/airflow/dags/train_model.py
[2024-05-04T17:59:34.724+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T17:59:34.727+0000] {logging_mixin.py:151} INFO - [2024-05-04T17:59:34.727+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:00:04.736+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:00:04.731+0000] {timeout.py:68} ERROR - Process timed out, PID: 53
[2024-05-04T18:00:04.749+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:00:04.740+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 53

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 53
[2024-05-04T18:00:04.750+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:00:04.774+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.054 seconds
[2024-05-04T18:00:34.939+0000] {processor.py:157} INFO - Started process (PID=87) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:00:34.940+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:00:34.942+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:00:34.942+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:01:04.949+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:01:04.946+0000] {timeout.py:68} ERROR - Process timed out, PID: 87
[2024-05-04T18:01:04.954+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:01:04.951+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 87

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 87
[2024-05-04T18:01:04.956+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:01:04.975+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.040 seconds
[2024-05-04T18:01:35.724+0000] {processor.py:157} INFO - Started process (PID=123) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:01:35.726+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:01:35.729+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:01:35.729+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:02:05.752+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:02:05.739+0000] {timeout.py:68} ERROR - Process timed out, PID: 123
[2024-05-04T18:02:05.764+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:02:05.758+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 123

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 123
[2024-05-04T18:02:05.765+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:02:05.796+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.075 seconds
[2024-05-04T18:02:36.291+0000] {processor.py:157} INFO - Started process (PID=184) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:02:36.293+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:02:36.297+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:02:36.296+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:03:06.314+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:03:06.305+0000] {timeout.py:68} ERROR - Process timed out, PID: 184
[2024-05-04T18:03:06.333+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:03:06.322+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 184

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 184
[2024-05-04T18:03:06.336+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:03:06.371+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-05-04T18:03:36.556+0000] {processor.py:157} INFO - Started process (PID=232) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:03:36.558+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:03:36.562+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:03:36.561+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:04:06.588+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:04:06.581+0000] {timeout.py:68} ERROR - Process timed out, PID: 232
[2024-05-04T18:04:06.605+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:04:06.593+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 232

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 232
[2024-05-04T18:04:06.609+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:04:06.646+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.094 seconds
[2024-05-04T18:04:37.071+0000] {processor.py:157} INFO - Started process (PID=268) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:04:37.072+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:04:37.076+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:04:37.076+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:05:07.092+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:05:07.084+0000] {timeout.py:68} ERROR - Process timed out, PID: 268
[2024-05-04T18:05:07.106+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:05:07.097+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 268

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 268
[2024-05-04T18:05:07.108+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:05:07.148+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.082 seconds
[2024-05-04T18:06:24.389+0000] {processor.py:157} INFO - Started process (PID=36) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:06:24.390+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:06:24.392+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:06:24.392+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:06:54.404+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:06:54.398+0000] {timeout.py:68} ERROR - Process timed out, PID: 36
[2024-05-04T18:06:54.411+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:06:54.407+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 36

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 36
[2024-05-04T18:06:54.413+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:06:54.435+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.051 seconds
[2024-05-04T18:07:49.084+0000] {processor.py:157} INFO - Started process (PID=35) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:07:49.085+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:07:49.087+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:07:49.087+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:08:19.109+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:08:19.096+0000] {timeout.py:68} ERROR - Process timed out, PID: 35
[2024-05-04T18:08:19.133+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:08:19.119+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 35

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 35
[2024-05-04T18:08:19.137+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:08:19.177+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.096 seconds
[2024-05-04T18:08:49.409+0000] {processor.py:157} INFO - Started process (PID=70) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:08:49.409+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:08:49.411+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:08:49.411+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:09:19.422+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:09:19.418+0000] {timeout.py:68} ERROR - Process timed out, PID: 70
[2024-05-04T18:09:19.435+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:09:19.426+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 70

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 70
[2024-05-04T18:09:19.437+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:09:19.466+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.060 seconds
[2024-05-04T18:09:49.834+0000] {processor.py:157} INFO - Started process (PID=106) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:09:49.836+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:09:49.841+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:09:49.841+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:10:19.853+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:10:19.848+0000] {timeout.py:68} ERROR - Process timed out, PID: 106
[2024-05-04T18:10:19.863+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:10:19.856+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 106

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 106
[2024-05-04T18:10:19.864+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:10:19.883+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.056 seconds
[2024-05-04T18:10:50.139+0000] {processor.py:157} INFO - Started process (PID=143) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:10:50.140+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:10:50.142+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:10:50.142+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:11:20.153+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:11:20.147+0000] {timeout.py:68} ERROR - Process timed out, PID: 143
[2024-05-04T18:11:20.171+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:11:20.159+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 143

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 143
[2024-05-04T18:11:20.174+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:11:20.209+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.075 seconds
[2024-05-04T18:11:50.836+0000] {processor.py:157} INFO - Started process (PID=179) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:11:50.837+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:11:50.840+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:11:50.839+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:12:20.846+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:12:20.843+0000] {timeout.py:68} ERROR - Process timed out, PID: 179
[2024-05-04T18:12:20.852+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:12:20.848+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 179

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 179
[2024-05-04T18:12:20.854+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:12:20.880+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.050 seconds
[2024-05-04T18:12:51.345+0000] {processor.py:157} INFO - Started process (PID=216) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:12:51.346+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:12:51.349+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:12:51.348+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:13:21.352+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:13:21.351+0000] {timeout.py:68} ERROR - Process timed out, PID: 216
[2024-05-04T18:13:21.356+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:13:21.353+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 216

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 216
[2024-05-04T18:13:21.357+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:13:21.373+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.033 seconds
[2024-05-04T18:13:51.634+0000] {processor.py:157} INFO - Started process (PID=252) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:13:51.635+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:13:51.638+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:13:51.637+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:14:21.650+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:14:21.644+0000] {timeout.py:68} ERROR - Process timed out, PID: 252
[2024-05-04T18:14:21.669+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:14:21.658+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 252

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 252
[2024-05-04T18:14:21.671+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:14:21.706+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.076 seconds
[2024-05-04T18:14:51.930+0000] {processor.py:157} INFO - Started process (PID=288) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:14:51.931+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:14:51.936+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:14:51.936+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:15:21.945+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:15:21.942+0000] {timeout.py:68} ERROR - Process timed out, PID: 288
[2024-05-04T18:15:21.959+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:15:21.949+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 288

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 288
[2024-05-04T18:15:21.961+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:15:21.991+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.067 seconds
[2024-05-04T18:15:52.520+0000] {processor.py:157} INFO - Started process (PID=324) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:15:52.521+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:15:52.524+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:15:52.523+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:16:22.551+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:16:22.542+0000] {timeout.py:68} ERROR - Process timed out, PID: 324
[2024-05-04T18:16:22.569+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:16:22.556+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 324

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 324
[2024-05-04T18:16:22.572+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:16:22.611+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.089 seconds
[2024-05-04T18:16:53.337+0000] {processor.py:157} INFO - Started process (PID=360) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:16:53.338+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:16:53.342+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:16:53.342+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:17:23.369+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:17:23.353+0000] {timeout.py:68} ERROR - Process timed out, PID: 360
[2024-05-04T18:17:23.390+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:17:23.377+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 360

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 360
[2024-05-04T18:17:23.394+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:17:23.436+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.106 seconds
[2024-05-04T18:17:54.078+0000] {processor.py:157} INFO - Started process (PID=396) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:17:54.080+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:17:54.083+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:17:54.082+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:18:24.092+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:18:24.089+0000] {timeout.py:68} ERROR - Process timed out, PID: 396
[2024-05-04T18:18:24.139+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:18:24.132+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 396

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 396
[2024-05-04T18:18:24.141+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:18:24.171+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.098 seconds
[2024-05-04T18:18:54.763+0000] {processor.py:157} INFO - Started process (PID=432) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:18:54.765+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:18:54.768+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:18:54.767+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:19:24.790+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:19:24.780+0000] {timeout.py:68} ERROR - Process timed out, PID: 432
[2024-05-04T18:19:24.802+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:19:24.794+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 432

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 432
[2024-05-04T18:19:24.804+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:19:24.836+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.072 seconds
[2024-05-04T18:19:55.254+0000] {processor.py:157} INFO - Started process (PID=467) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:19:55.255+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:19:55.258+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:19:55.258+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:20:25.266+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:20:25.264+0000] {timeout.py:68} ERROR - Process timed out, PID: 467
[2024-05-04T18:20:25.273+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:20:25.268+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 467

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 467
[2024-05-04T18:20:25.274+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:20:25.296+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.048 seconds
[2024-05-04T18:20:55.585+0000] {processor.py:157} INFO - Started process (PID=504) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:20:55.587+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:20:55.590+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:20:55.589+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:21:25.595+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:21:25.594+0000] {timeout.py:68} ERROR - Process timed out, PID: 504
[2024-05-04T18:21:25.600+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:21:25.597+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 504

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 504
[2024-05-04T18:21:25.601+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:21:25.621+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.042 seconds
[2024-05-04T18:21:56.034+0000] {processor.py:157} INFO - Started process (PID=540) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:21:56.035+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:21:56.037+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:21:56.037+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:22:26.074+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:22:26.047+0000] {timeout.py:68} ERROR - Process timed out, PID: 540
[2024-05-04T18:22:26.086+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:22:26.079+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 540

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 540
[2024-05-04T18:22:26.089+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:22:26.117+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-05-04T18:22:56.560+0000] {processor.py:157} INFO - Started process (PID=576) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:22:56.561+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:22:56.564+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:22:56.563+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:23:26.571+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:23:26.569+0000] {timeout.py:68} ERROR - Process timed out, PID: 576
[2024-05-04T18:23:26.578+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:23:26.573+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 576

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 576
[2024-05-04T18:23:26.579+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:23:26.600+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.045 seconds
[2024-05-04T18:23:56.814+0000] {processor.py:157} INFO - Started process (PID=613) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:23:56.816+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:23:56.819+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:23:56.818+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:24:26.834+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:24:26.826+0000] {timeout.py:68} ERROR - Process timed out, PID: 613
[2024-05-04T18:24:26.848+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:24:26.839+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 613

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 613
[2024-05-04T18:24:26.850+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:24:26.894+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.085 seconds
[2024-05-04T18:24:57.130+0000] {processor.py:157} INFO - Started process (PID=649) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:24:57.131+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:24:57.134+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:24:57.133+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:25:27.149+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:25:27.141+0000] {timeout.py:68} ERROR - Process timed out, PID: 649
[2024-05-04T18:25:27.163+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:25:27.155+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 649

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 649
[2024-05-04T18:25:27.166+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:25:27.193+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.068 seconds
[2024-05-04T18:25:57.398+0000] {processor.py:157} INFO - Started process (PID=685) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:25:57.400+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:25:57.402+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:25:57.402+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:26:27.413+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:26:27.407+0000] {timeout.py:68} ERROR - Process timed out, PID: 685
[2024-05-04T18:26:27.423+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:26:27.417+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 685

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 685
[2024-05-04T18:26:27.425+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:26:27.474+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.080 seconds
[2024-05-04T18:26:58.106+0000] {processor.py:157} INFO - Started process (PID=721) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:26:58.107+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:26:58.109+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:26:58.109+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:27:28.117+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:27:28.112+0000] {timeout.py:68} ERROR - Process timed out, PID: 721
[2024-05-04T18:27:28.132+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:27:28.122+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 721

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 721
[2024-05-04T18:27:28.137+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:27:28.172+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.070 seconds
[2024-05-04T18:27:58.804+0000] {processor.py:157} INFO - Started process (PID=757) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:27:58.805+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:27:58.807+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:27:58.806+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:28:28.832+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:28:28.817+0000] {timeout.py:68} ERROR - Process timed out, PID: 757
[2024-05-04T18:28:28.854+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:28:28.841+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 757

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 757
[2024-05-04T18:28:28.859+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:28:28.905+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.101 seconds
[2024-05-04T18:28:58.958+0000] {processor.py:157} INFO - Started process (PID=793) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:28:58.959+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:28:58.962+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:28:58.962+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:29:28.972+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:29:28.967+0000] {timeout.py:68} ERROR - Process timed out, PID: 793
[2024-05-04T18:29:28.984+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:29:28.975+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 793

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 793
[2024-05-04T18:29:28.985+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:29:29.012+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.060 seconds
[2024-05-04T18:29:59.418+0000] {processor.py:157} INFO - Started process (PID=829) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:29:59.419+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:29:59.422+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:29:59.422+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:30:29.429+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:30:29.427+0000] {timeout.py:68} ERROR - Process timed out, PID: 829
[2024-05-04T18:30:29.433+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:30:29.430+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 829

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 829
[2024-05-04T18:30:29.434+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:30:29.452+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.039 seconds
[2024-05-04T18:30:59.529+0000] {processor.py:157} INFO - Started process (PID=865) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:30:59.530+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:30:59.534+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:30:59.533+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:31:29.557+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:31:29.555+0000] {timeout.py:68} ERROR - Process timed out, PID: 865
[2024-05-04T18:31:29.566+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:31:29.560+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 865

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 865
[2024-05-04T18:31:29.568+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:31:29.597+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.061 seconds
[2024-05-04T18:31:59.759+0000] {processor.py:157} INFO - Started process (PID=901) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:31:59.760+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:31:59.763+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:31:59.763+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:32:29.772+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:32:29.768+0000] {timeout.py:68} ERROR - Process timed out, PID: 901
[2024-05-04T18:32:29.783+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:32:29.776+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 901

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 901
[2024-05-04T18:32:29.785+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:32:29.811+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.059 seconds
[2024-05-04T18:33:00.571+0000] {processor.py:157} INFO - Started process (PID=937) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:33:00.572+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:33:00.576+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:33:00.575+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:33:30.601+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:33:30.588+0000] {timeout.py:68} ERROR - Process timed out, PID: 937
[2024-05-04T18:33:30.620+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:33:30.608+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 937

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 937
[2024-05-04T18:33:30.623+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:33:30.668+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.101 seconds
[2024-05-04T18:34:01.067+0000] {processor.py:157} INFO - Started process (PID=973) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:34:01.071+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:34:01.073+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:34:01.073+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:34:31.081+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:34:31.079+0000] {timeout.py:68} ERROR - Process timed out, PID: 973
[2024-05-04T18:34:31.088+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:34:31.083+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 973

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 973
[2024-05-04T18:34:31.089+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:34:31.127+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.066 seconds
[2024-05-04T18:35:01.209+0000] {processor.py:157} INFO - Started process (PID=1009) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:35:01.210+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:35:01.214+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:35:01.213+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:35:31.235+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:35:31.225+0000] {timeout.py:68} ERROR - Process timed out, PID: 1009
[2024-05-04T18:35:31.254+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:35:31.245+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1009

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1009
[2024-05-04T18:35:31.258+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:35:31.292+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.090 seconds
[2024-05-04T18:36:01.443+0000] {processor.py:157} INFO - Started process (PID=1051) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:36:01.444+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:36:01.447+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:36:01.446+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:36:31.459+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:36:31.453+0000] {timeout.py:68} ERROR - Process timed out, PID: 1051
[2024-05-04T18:36:31.477+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:36:31.465+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1051

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1051
[2024-05-04T18:36:31.480+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:36:31.514+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.076 seconds
[2024-05-04T18:37:02.104+0000] {processor.py:157} INFO - Started process (PID=1087) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:37:02.106+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:37:02.109+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:37:02.108+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:37:32.122+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:37:32.115+0000] {timeout.py:68} ERROR - Process timed out, PID: 1087
[2024-05-04T18:37:32.161+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:37:32.127+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1087

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1087
[2024-05-04T18:37:32.163+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:37:32.184+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-05-04T18:38:02.944+0000] {processor.py:157} INFO - Started process (PID=1124) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:38:02.945+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:38:02.947+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:38:02.946+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:38:32.954+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:38:32.950+0000] {timeout.py:68} ERROR - Process timed out, PID: 1124
[2024-05-04T18:38:32.967+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:38:32.958+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1124

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1124
[2024-05-04T18:38:32.969+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:38:33.001+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.061 seconds
[2024-05-04T18:39:03.629+0000] {processor.py:157} INFO - Started process (PID=1160) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:39:03.630+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:39:03.633+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:39:03.632+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:39:33.638+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:39:33.637+0000] {timeout.py:68} ERROR - Process timed out, PID: 1160
[2024-05-04T18:39:33.644+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:39:33.640+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1160

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1160
[2024-05-04T18:39:33.645+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:39:33.659+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.036 seconds
[2024-05-04T18:40:04.240+0000] {processor.py:157} INFO - Started process (PID=1194) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:40:04.244+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:40:04.248+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:40:04.247+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:40:34.259+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:40:34.258+0000] {timeout.py:68} ERROR - Process timed out, PID: 1194
[2024-05-04T18:40:34.266+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:40:34.261+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1194

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1194
[2024-05-04T18:40:34.267+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:40:34.288+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.053 seconds
[2024-05-04T18:41:04.529+0000] {processor.py:157} INFO - Started process (PID=1230) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:41:04.531+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:41:04.534+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:41:04.533+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:41:34.546+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:41:34.543+0000] {timeout.py:68} ERROR - Process timed out, PID: 1230
[2024-05-04T18:41:34.565+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:41:34.551+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1230

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1230
[2024-05-04T18:41:34.568+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:41:34.602+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.079 seconds
[2024-05-04T18:42:04.773+0000] {processor.py:157} INFO - Started process (PID=1266) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:42:04.774+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:42:04.776+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:42:04.776+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:42:34.792+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:42:34.784+0000] {timeout.py:68} ERROR - Process timed out, PID: 1266
[2024-05-04T18:42:34.809+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:42:34.798+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1266

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1266
[2024-05-04T18:42:34.812+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:42:34.841+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.072 seconds
[2024-05-04T18:43:04.971+0000] {processor.py:157} INFO - Started process (PID=1301) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:43:04.972+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:43:04.976+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:43:04.976+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:43:34.983+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:43:34.981+0000] {timeout.py:68} ERROR - Process timed out, PID: 1301
[2024-05-04T18:43:34.989+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:43:34.985+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1301

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1301
[2024-05-04T18:43:34.990+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:43:35.019+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.054 seconds
[2024-05-04T18:44:05.197+0000] {processor.py:157} INFO - Started process (PID=1337) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:44:05.198+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:44:05.202+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:44:05.201+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:44:35.227+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:44:35.219+0000] {timeout.py:68} ERROR - Process timed out, PID: 1337
[2024-05-04T18:44:35.236+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:44:35.231+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1337

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1337
[2024-05-04T18:44:35.238+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:44:35.270+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.079 seconds
[2024-05-04T18:45:05.780+0000] {processor.py:157} INFO - Started process (PID=1373) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:45:05.781+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:45:05.785+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:45:05.785+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:45:35.798+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:45:35.792+0000] {timeout.py:68} ERROR - Process timed out, PID: 1373
[2024-05-04T18:45:35.809+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:45:35.801+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1373

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1373
[2024-05-04T18:45:35.811+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:45:35.843+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.070 seconds
[2024-05-04T18:46:06.473+0000] {processor.py:157} INFO - Started process (PID=1408) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:46:06.474+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:46:06.477+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:46:06.477+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:46:36.489+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:46:36.485+0000] {timeout.py:68} ERROR - Process timed out, PID: 1408
[2024-05-04T18:46:36.499+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:46:36.492+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1408

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1408
[2024-05-04T18:46:36.500+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:46:36.530+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.060 seconds
[2024-05-04T18:47:07.070+0000] {processor.py:157} INFO - Started process (PID=1445) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:47:07.072+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:47:07.075+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:47:07.074+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:47:37.097+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:47:37.083+0000] {timeout.py:68} ERROR - Process timed out, PID: 1445
[2024-05-04T18:47:37.112+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:47:37.102+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1445

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1445
[2024-05-04T18:47:37.115+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:47:37.152+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.087 seconds
[2024-05-04T18:48:07.854+0000] {processor.py:157} INFO - Started process (PID=1481) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:48:07.855+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:48:07.858+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:48:07.858+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:48:37.867+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:48:37.866+0000] {timeout.py:68} ERROR - Process timed out, PID: 1481
[2024-05-04T18:48:37.874+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:48:37.871+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1481

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1481
[2024-05-04T18:48:37.875+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:48:37.892+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.041 seconds
[2024-05-04T18:49:08.022+0000] {processor.py:157} INFO - Started process (PID=1517) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:49:08.023+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:49:08.028+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:49:08.026+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:49:38.033+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:49:38.030+0000] {timeout.py:68} ERROR - Process timed out, PID: 1517
[2024-05-04T18:49:38.045+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:49:38.037+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1517

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1517
[2024-05-04T18:49:38.047+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:49:38.078+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.066 seconds
[2024-05-04T18:50:08.708+0000] {processor.py:157} INFO - Started process (PID=1553) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:50:08.709+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:50:08.713+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:50:08.712+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:50:38.734+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:50:38.723+0000] {timeout.py:68} ERROR - Process timed out, PID: 1553
[2024-05-04T18:50:38.755+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:50:38.743+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1553

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1553
[2024-05-04T18:50:38.759+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:50:38.800+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.097 seconds
[2024-05-04T18:51:08.963+0000] {processor.py:157} INFO - Started process (PID=1590) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:51:08.965+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:51:08.969+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:51:08.968+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:51:38.990+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:51:38.978+0000] {timeout.py:68} ERROR - Process timed out, PID: 1590
[2024-05-04T18:51:39.013+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:51:39.000+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1590

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1590
[2024-05-04T18:51:39.016+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:51:39.049+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.092 seconds
[2024-05-04T18:52:09.265+0000] {processor.py:157} INFO - Started process (PID=1626) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:52:09.266+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:52:09.270+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:52:09.269+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:52:39.300+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:52:39.285+0000] {timeout.py:68} ERROR - Process timed out, PID: 1626
[2024-05-04T18:52:39.316+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:52:39.305+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1626

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1626
[2024-05-04T18:52:39.319+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:52:39.371+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.112 seconds
[2024-05-04T18:53:09.558+0000] {processor.py:157} INFO - Started process (PID=1662) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:53:09.560+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:53:09.563+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:53:09.562+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:53:39.583+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:53:39.571+0000] {timeout.py:68} ERROR - Process timed out, PID: 1662
[2024-05-04T18:53:39.603+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:53:39.590+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1662

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1662
[2024-05-04T18:53:39.607+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:53:39.648+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.095 seconds
[2024-05-04T18:54:09.720+0000] {processor.py:157} INFO - Started process (PID=1698) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:54:09.721+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:54:09.726+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:54:09.724+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:54:39.748+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:54:39.741+0000] {timeout.py:68} ERROR - Process timed out, PID: 1698
[2024-05-04T18:54:39.765+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:54:39.753+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1698

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1698
[2024-05-04T18:54:39.767+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:54:39.812+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.096 seconds
[2024-05-04T18:55:10.333+0000] {processor.py:157} INFO - Started process (PID=1734) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:55:10.334+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:55:10.337+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:55:10.337+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:55:40.352+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:55:40.346+0000] {timeout.py:68} ERROR - Process timed out, PID: 1734
[2024-05-04T18:55:40.363+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:55:40.356+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1734

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1734
[2024-05-04T18:55:40.366+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:55:40.398+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.068 seconds
[2024-05-04T18:56:11.130+0000] {processor.py:157} INFO - Started process (PID=1769) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:56:11.132+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:56:11.136+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:56:11.136+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:56:41.165+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:56:41.148+0000] {timeout.py:68} ERROR - Process timed out, PID: 1769
[2024-05-04T18:56:41.176+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:56:41.170+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1769

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1769
[2024-05-04T18:56:41.179+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:56:41.222+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.098 seconds
[2024-05-04T18:57:11.683+0000] {processor.py:157} INFO - Started process (PID=1805) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:57:11.684+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:57:11.687+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:57:11.687+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:57:41.691+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:57:41.688+0000] {timeout.py:68} ERROR - Process timed out, PID: 1805
[2024-05-04T18:57:41.700+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:57:41.695+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1805

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1805
[2024-05-04T18:57:41.701+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:57:41.726+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.052 seconds
[2024-05-04T18:58:11.886+0000] {processor.py:157} INFO - Started process (PID=1841) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:58:11.887+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:58:11.890+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:58:11.890+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:58:41.900+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:58:41.896+0000] {timeout.py:68} ERROR - Process timed out, PID: 1841
[2024-05-04T18:58:41.911+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:58:41.905+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1841

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1841
[2024-05-04T18:58:41.914+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:58:41.948+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.066 seconds
[2024-05-04T18:59:12.556+0000] {processor.py:157} INFO - Started process (PID=1876) to work on /opt/airflow/dags/train_model.py
[2024-05-04T18:59:12.557+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T18:59:12.558+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:59:12.558+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T18:59:42.565+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:59:42.562+0000] {timeout.py:68} ERROR - Process timed out, PID: 1876
[2024-05-04T18:59:42.573+0000] {logging_mixin.py:151} INFO - [2024-05-04T18:59:42.568+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1876

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1876
[2024-05-04T18:59:42.575+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T18:59:42.597+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.044 seconds
[2024-05-04T19:00:12.659+0000] {processor.py:157} INFO - Started process (PID=1912) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:00:12.660+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:00:12.662+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:00:12.661+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:00:42.668+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:00:42.665+0000] {timeout.py:68} ERROR - Process timed out, PID: 1912
[2024-05-04T19:00:42.674+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:00:42.670+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1912

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1912
[2024-05-04T19:00:42.675+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:00:42.696+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.040 seconds
[2024-05-04T19:01:13.189+0000] {processor.py:157} INFO - Started process (PID=1947) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:01:13.190+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:01:13.192+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:01:13.191+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:01:43.210+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:01:43.201+0000] {timeout.py:68} ERROR - Process timed out, PID: 1947
[2024-05-04T19:01:43.229+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:01:43.220+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1947

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1947
[2024-05-04T19:01:43.231+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:01:43.261+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.075 seconds
[2024-05-04T19:02:13.418+0000] {processor.py:157} INFO - Started process (PID=1983) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:02:13.419+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:02:13.423+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:02:13.422+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:02:43.432+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:02:43.427+0000] {timeout.py:68} ERROR - Process timed out, PID: 1983
[2024-05-04T19:02:43.448+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:02:43.435+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1983

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 1983
[2024-05-04T19:02:43.456+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:02:43.488+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.074 seconds
[2024-05-04T19:03:13.906+0000] {processor.py:157} INFO - Started process (PID=2019) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:03:13.907+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:03:13.909+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:03:13.909+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:03:43.914+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:03:43.912+0000] {timeout.py:68} ERROR - Process timed out, PID: 2019
[2024-05-04T19:03:43.919+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:03:43.915+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2019

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2019
[2024-05-04T19:03:43.920+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:03:43.937+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.034 seconds
[2024-05-04T19:04:14.133+0000] {processor.py:157} INFO - Started process (PID=2054) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:04:14.134+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:04:14.135+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:04:14.135+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:04:44.148+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:04:44.144+0000] {timeout.py:68} ERROR - Process timed out, PID: 2054
[2024-05-04T19:04:44.162+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:04:44.152+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2054

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2054
[2024-05-04T19:04:44.163+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:04:44.193+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.062 seconds
[2024-05-04T19:05:14.646+0000] {processor.py:157} INFO - Started process (PID=2090) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:05:14.646+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:05:14.648+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:05:14.648+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:05:44.652+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:05:44.650+0000] {timeout.py:68} ERROR - Process timed out, PID: 2090
[2024-05-04T19:05:44.664+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:05:44.656+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2090

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2090
[2024-05-04T19:05:44.666+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:05:44.693+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.049 seconds
[2024-05-04T19:06:15.310+0000] {processor.py:157} INFO - Started process (PID=2126) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:06:15.312+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:06:15.315+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:06:15.314+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:06:45.322+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:06:45.320+0000] {timeout.py:68} ERROR - Process timed out, PID: 2126
[2024-05-04T19:06:45.328+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:06:45.323+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2126

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2126
[2024-05-04T19:06:45.329+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:06:45.347+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.043 seconds
[2024-05-04T19:07:15.627+0000] {processor.py:157} INFO - Started process (PID=2162) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:07:15.628+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:07:15.631+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:07:15.631+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:07:45.633+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:07:45.633+0000] {timeout.py:68} ERROR - Process timed out, PID: 2162
[2024-05-04T19:07:45.637+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:07:45.635+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2162

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2162
[2024-05-04T19:07:45.638+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:07:45.651+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.033 seconds
[2024-05-04T19:08:15.925+0000] {processor.py:157} INFO - Started process (PID=2193) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:08:15.926+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:08:15.927+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:08:15.927+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:08:45.933+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:08:45.931+0000] {timeout.py:68} ERROR - Process timed out, PID: 2193
[2024-05-04T19:08:45.937+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:08:45.934+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2193

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2193
[2024-05-04T19:08:45.939+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:08:45.966+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.043 seconds
[2024-05-04T19:09:16.096+0000] {processor.py:157} INFO - Started process (PID=2228) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:09:16.097+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:09:16.099+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:09:16.099+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:09:46.103+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:09:46.102+0000] {timeout.py:68} ERROR - Process timed out, PID: 2228
[2024-05-04T19:09:46.109+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:09:46.106+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2228

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2228
[2024-05-04T19:09:46.111+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:09:46.129+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.036 seconds
[2024-05-04T19:10:16.645+0000] {processor.py:157} INFO - Started process (PID=2264) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:10:16.646+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:10:16.647+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:10:16.647+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:10:46.656+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:10:46.651+0000] {timeout.py:68} ERROR - Process timed out, PID: 2264
[2024-05-04T19:10:46.668+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:10:46.660+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2264

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2264
[2024-05-04T19:10:46.670+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:10:46.698+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.056 seconds
[2024-05-04T19:11:16.801+0000] {processor.py:157} INFO - Started process (PID=2306) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:11:16.802+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:11:16.803+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:11:16.803+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:11:46.809+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:11:46.806+0000] {timeout.py:68} ERROR - Process timed out, PID: 2306
[2024-05-04T19:11:46.816+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:11:46.812+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2306

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2306
[2024-05-04T19:11:46.818+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:11:46.839+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.041 seconds
[2024-05-04T19:12:17.602+0000] {processor.py:157} INFO - Started process (PID=2342) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:12:17.602+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:12:17.605+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:12:17.605+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:12:47.611+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:12:47.608+0000] {timeout.py:68} ERROR - Process timed out, PID: 2342
[2024-05-04T19:12:47.617+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:12:47.613+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2342

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2342
[2024-05-04T19:12:47.619+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:12:47.640+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.041 seconds
[2024-05-04T19:13:17.766+0000] {processor.py:157} INFO - Started process (PID=2375) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:13:17.769+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:13:17.770+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:13:17.770+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:13:47.773+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:13:47.772+0000] {timeout.py:68} ERROR - Process timed out, PID: 2375
[2024-05-04T19:13:47.776+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:13:47.774+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2375

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2375
[2024-05-04T19:13:47.777+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:13:47.788+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.025 seconds
[2024-05-04T19:14:18.075+0000] {processor.py:157} INFO - Started process (PID=2410) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:14:18.076+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:14:18.077+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:14:18.077+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:14:48.082+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:14:48.081+0000] {timeout.py:68} ERROR - Process timed out, PID: 2410
[2024-05-04T19:14:48.088+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:14:48.084+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2410

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2410
[2024-05-04T19:14:48.089+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:14:48.108+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.034 seconds
[2024-05-04T19:15:18.579+0000] {processor.py:157} INFO - Started process (PID=2445) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:15:18.580+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:15:18.584+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:15:18.583+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:15:48.593+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:15:48.589+0000] {timeout.py:68} ERROR - Process timed out, PID: 2445
[2024-05-04T19:15:48.604+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:15:48.598+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2445

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2445
[2024-05-04T19:15:48.605+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:15:48.631+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.058 seconds
[2024-05-04T19:16:19.153+0000] {processor.py:157} INFO - Started process (PID=2481) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:16:19.154+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:16:19.156+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:16:19.156+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:16:49.166+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:16:49.162+0000] {timeout.py:68} ERROR - Process timed out, PID: 2481
[2024-05-04T19:16:49.174+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:16:49.169+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2481

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2481
[2024-05-04T19:16:49.176+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:16:49.200+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.049 seconds
[2024-05-04T19:17:19.417+0000] {processor.py:157} INFO - Started process (PID=2523) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:17:19.418+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:17:19.423+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:17:19.422+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:17:49.434+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:17:49.429+0000] {timeout.py:68} ERROR - Process timed out, PID: 2523
[2024-05-04T19:17:49.444+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:17:49.438+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2523

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2523
[2024-05-04T19:17:49.446+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:17:49.473+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.063 seconds
[2024-05-04T19:18:19.682+0000] {processor.py:157} INFO - Started process (PID=2565) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:18:19.683+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:18:19.686+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:18:19.686+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:18:49.705+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:18:49.695+0000] {timeout.py:68} ERROR - Process timed out, PID: 2565
[2024-05-04T19:18:49.724+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:18:49.711+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2565

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2565
[2024-05-04T19:18:49.727+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:18:49.771+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.097 seconds
[2024-05-04T19:19:19.883+0000] {processor.py:157} INFO - Started process (PID=2601) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:19:19.884+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:19:19.888+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:19:19.887+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:19:49.894+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:19:49.893+0000] {timeout.py:68} ERROR - Process timed out, PID: 2601
[2024-05-04T19:19:49.898+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:19:49.895+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2601

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2601
[2024-05-04T19:19:49.899+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:19:49.915+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.039 seconds
[2024-05-04T19:20:20.335+0000] {processor.py:157} INFO - Started process (PID=2632) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:20:20.336+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:20:20.340+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:20:20.339+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:20:50.349+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:20:50.344+0000] {timeout.py:68} ERROR - Process timed out, PID: 2632
[2024-05-04T19:20:50.360+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:20:50.353+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2632

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2632
[2024-05-04T19:20:50.362+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:20:50.399+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.068 seconds
[2024-05-04T19:21:20.600+0000] {processor.py:157} INFO - Started process (PID=2667) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:21:20.602+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:21:20.606+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:21:20.606+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:21:50.620+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:21:50.614+0000] {timeout.py:68} ERROR - Process timed out, PID: 2667
[2024-05-04T19:21:50.634+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:21:50.625+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2667

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2667
[2024-05-04T19:21:50.636+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:21:50.672+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.078 seconds
[2024-05-04T19:22:20.757+0000] {processor.py:157} INFO - Started process (PID=2703) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:22:20.758+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:22:20.762+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:22:20.762+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:22:50.779+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:22:50.771+0000] {timeout.py:68} ERROR - Process timed out, PID: 2703
[2024-05-04T19:22:50.792+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:22:50.783+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2703

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2703
[2024-05-04T19:22:50.796+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:22:50.837+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.087 seconds
[2024-05-04T19:23:21.075+0000] {processor.py:157} INFO - Started process (PID=2739) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:23:21.076+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:23:21.080+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:23:21.079+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:23:51.094+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:23:51.085+0000] {timeout.py:68} ERROR - Process timed out, PID: 2739
[2024-05-04T19:23:51.101+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:23:51.097+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2739

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2739
[2024-05-04T19:23:51.102+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:23:51.131+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.064 seconds
[2024-05-04T19:24:21.637+0000] {processor.py:157} INFO - Started process (PID=2781) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:24:21.638+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:24:21.641+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:24:21.641+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:24:51.654+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:24:51.648+0000] {timeout.py:68} ERROR - Process timed out, PID: 2781
[2024-05-04T19:24:51.670+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:24:51.660+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2781

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2781
[2024-05-04T19:24:51.674+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:24:51.706+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.075 seconds
[2024-05-04T19:25:21.977+0000] {processor.py:157} INFO - Started process (PID=2823) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:25:21.978+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:25:21.981+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:25:21.981+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:25:51.990+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:25:51.988+0000] {timeout.py:68} ERROR - Process timed out, PID: 2823
[2024-05-04T19:25:51.995+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:25:51.992+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2823

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2823
[2024-05-04T19:25:51.996+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:25:52.014+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.043 seconds
[2024-05-04T19:26:22.107+0000] {processor.py:157} INFO - Started process (PID=2865) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:26:22.108+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:26:22.110+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:26:22.110+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:26:52.118+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:26:52.115+0000] {timeout.py:68} ERROR - Process timed out, PID: 2865
[2024-05-04T19:26:52.123+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:26:52.120+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2865

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2865
[2024-05-04T19:26:52.124+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:26:52.140+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.038 seconds
[2024-05-04T19:27:22.460+0000] {processor.py:157} INFO - Started process (PID=2914) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:27:22.461+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:27:22.462+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:27:22.462+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:27:52.471+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:27:52.466+0000] {timeout.py:68} ERROR - Process timed out, PID: 2914
[2024-05-04T19:27:52.479+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:27:52.474+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2914

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2914
[2024-05-04T19:27:52.481+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:27:52.524+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.067 seconds
[2024-05-04T19:28:22.619+0000] {processor.py:157} INFO - Started process (PID=2950) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:28:22.620+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:28:22.622+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:28:22.622+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:28:52.636+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:28:52.631+0000] {timeout.py:68} ERROR - Process timed out, PID: 2950
[2024-05-04T19:28:52.643+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:28:52.638+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2950

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2950
[2024-05-04T19:28:52.645+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:28:52.669+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.053 seconds
[2024-05-04T19:29:22.831+0000] {processor.py:157} INFO - Started process (PID=2998) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:29:22.832+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:29:22.834+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:29:22.834+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:29:52.843+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:29:52.838+0000] {timeout.py:68} ERROR - Process timed out, PID: 2998
[2024-05-04T19:29:52.851+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:29:52.846+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2998

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 2998
[2024-05-04T19:29:52.852+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:29:52.881+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.052 seconds
[2024-05-04T19:30:23.140+0000] {processor.py:157} INFO - Started process (PID=3028) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:30:23.141+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:30:23.143+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:30:23.143+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:30:53.163+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:30:53.151+0000] {timeout.py:68} ERROR - Process timed out, PID: 3028
[2024-05-04T19:30:53.171+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:30:53.166+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3028

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3028
[2024-05-04T19:30:53.172+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:30:53.206+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.069 seconds
[2024-05-04T19:31:23.381+0000] {processor.py:157} INFO - Started process (PID=3064) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:31:23.382+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:31:23.386+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:31:23.385+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:31:53.386+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:31:53.372+0000] {timeout.py:68} ERROR - Process timed out, PID: 3064
[2024-05-04T19:31:53.405+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:31:53.394+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3064

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3064
[2024-05-04T19:31:53.436+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:31:53.473+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.123 seconds
[2024-05-04T19:32:23.758+0000] {processor.py:157} INFO - Started process (PID=3106) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:32:23.760+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:32:23.763+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:32:23.762+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:32:53.774+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:32:53.769+0000] {timeout.py:68} ERROR - Process timed out, PID: 3106
[2024-05-04T19:32:53.781+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:32:53.776+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3106

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3106
[2024-05-04T19:32:53.784+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:32:53.822+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.071 seconds
[2024-05-04T19:33:24.033+0000] {processor.py:157} INFO - Started process (PID=3142) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:33:24.034+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:33:24.036+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:33:24.036+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:33:54.063+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:33:54.045+0000] {timeout.py:68} ERROR - Process timed out, PID: 3142
[2024-05-04T19:33:54.087+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:33:54.074+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3142

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3142
[2024-05-04T19:33:54.092+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:33:54.140+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.114 seconds
[2024-05-04T19:34:24.380+0000] {processor.py:157} INFO - Started process (PID=3178) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:34:24.381+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:34:24.385+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:34:24.384+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:34:54.401+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:34:54.397+0000] {timeout.py:68} ERROR - Process timed out, PID: 3178
[2024-05-04T19:34:54.412+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:34:54.404+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3178

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3178
[2024-05-04T19:34:54.414+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:34:54.434+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.060 seconds
[2024-05-04T19:35:24.884+0000] {processor.py:157} INFO - Started process (PID=3214) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:35:24.886+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:35:24.889+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:35:24.889+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:35:54.908+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:35:54.900+0000] {timeout.py:68} ERROR - Process timed out, PID: 3214
[2024-05-04T19:35:54.923+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:35:54.919+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3214

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3214
[2024-05-04T19:35:54.925+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:35:54.952+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.076 seconds
[2024-05-04T19:36:25.174+0000] {processor.py:157} INFO - Started process (PID=3250) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:36:25.175+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:36:25.178+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:36:25.177+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:36:55.200+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:36:55.185+0000] {timeout.py:68} ERROR - Process timed out, PID: 3250
[2024-05-04T19:36:55.219+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:36:55.206+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3250

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3250
[2024-05-04T19:36:55.223+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:36:55.257+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.086 seconds
[2024-05-04T19:37:25.528+0000] {processor.py:157} INFO - Started process (PID=3286) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:37:25.529+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:37:25.530+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:37:25.530+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:37:55.531+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:37:55.529+0000] {timeout.py:68} ERROR - Process timed out, PID: 3286
[2024-05-04T19:37:55.536+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:37:55.532+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3286

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3286
[2024-05-04T19:37:55.537+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:37:55.552+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.032 seconds
[2024-05-04T19:38:26.301+0000] {processor.py:157} INFO - Started process (PID=3317) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:38:26.301+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:38:26.303+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:38:26.303+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:38:56.318+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:38:56.305+0000] {timeout.py:68} ERROR - Process timed out, PID: 3317
[2024-05-04T19:38:56.332+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:38:56.325+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3317

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3317
[2024-05-04T19:38:56.334+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:38:56.364+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.067 seconds
[2024-05-04T19:39:26.653+0000] {processor.py:157} INFO - Started process (PID=3352) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:39:26.654+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:39:26.658+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:39:26.658+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:39:56.683+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:39:56.670+0000] {timeout.py:68} ERROR - Process timed out, PID: 3352
[2024-05-04T19:39:56.713+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:39:56.703+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3352

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3352
[2024-05-04T19:39:56.716+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:39:56.755+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.105 seconds
[2024-05-04T19:40:27.436+0000] {processor.py:157} INFO - Started process (PID=3388) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:40:27.438+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:40:27.441+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:40:27.441+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:40:57.452+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:40:57.449+0000] {timeout.py:68} ERROR - Process timed out, PID: 3388
[2024-05-04T19:40:57.464+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:40:57.456+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3388

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3388
[2024-05-04T19:40:57.466+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:40:57.494+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.063 seconds
[2024-05-04T19:41:28.236+0000] {processor.py:157} INFO - Started process (PID=3424) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:41:28.238+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:41:28.241+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:41:28.240+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:41:58.263+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:41:58.251+0000] {timeout.py:68} ERROR - Process timed out, PID: 3424
[2024-05-04T19:41:58.275+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:41:58.268+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3424

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3424
[2024-05-04T19:41:58.278+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:41:58.328+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.096 seconds
[2024-05-04T19:42:28.661+0000] {processor.py:157} INFO - Started process (PID=3461) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:42:28.662+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:42:28.666+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:42:28.666+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:42:58.683+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:42:58.673+0000] {timeout.py:68} ERROR - Process timed out, PID: 3461
[2024-05-04T19:42:58.702+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:42:58.688+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3461

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3461
[2024-05-04T19:42:58.705+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:42:58.745+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.092 seconds
[2024-05-04T19:43:29.034+0000] {processor.py:157} INFO - Started process (PID=3503) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:43:29.035+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:43:29.038+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:43:29.037+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:43:59.060+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:43:59.047+0000] {timeout.py:68} ERROR - Process timed out, PID: 3503
[2024-05-04T19:43:59.073+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:43:59.066+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3503

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3503
[2024-05-04T19:43:59.077+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:43:59.119+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.089 seconds
[2024-05-04T19:44:29.457+0000] {processor.py:157} INFO - Started process (PID=3539) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:44:29.459+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:44:29.462+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:44:29.462+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:44:59.515+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:44:59.504+0000] {timeout.py:68} ERROR - Process timed out, PID: 3539
[2024-05-04T19:44:59.530+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:44:59.521+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3539

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3539
[2024-05-04T19:44:59.534+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:44:59.579+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.128 seconds
[2024-05-04T19:45:29.943+0000] {processor.py:157} INFO - Started process (PID=3575) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:45:29.944+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:45:29.949+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:45:29.948+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:45:59.964+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:45:59.959+0000] {timeout.py:68} ERROR - Process timed out, PID: 3575
[2024-05-04T19:45:59.972+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:45:59.967+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3575

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3575
[2024-05-04T19:45:59.980+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:46:00.023+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.084 seconds
[2024-05-04T19:46:30.435+0000] {processor.py:157} INFO - Started process (PID=3609) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:46:30.436+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:46:30.440+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:46:30.440+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:47:00.473+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:47:00.456+0000] {timeout.py:68} ERROR - Process timed out, PID: 3609
[2024-05-04T19:47:00.495+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:47:00.481+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3609

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3609
[2024-05-04T19:47:00.500+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:47:00.563+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.138 seconds
[2024-05-04T19:47:31.326+0000] {processor.py:157} INFO - Started process (PID=3645) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:47:31.331+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:47:31.336+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:47:31.336+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:48:01.394+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:48:01.383+0000] {timeout.py:68} ERROR - Process timed out, PID: 3645
[2024-05-04T19:48:01.405+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:48:01.398+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3645

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3645
[2024-05-04T19:48:01.408+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:48:01.458+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.139 seconds
[2024-05-04T19:48:32.333+0000] {processor.py:157} INFO - Started process (PID=3681) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:48:32.334+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:48:32.338+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:48:32.338+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:49:02.357+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:49:02.350+0000] {timeout.py:68} ERROR - Process timed out, PID: 3681
[2024-05-04T19:49:02.381+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:49:02.363+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3681

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3681
[2024-05-04T19:49:02.384+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:49:02.417+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.088 seconds
[2024-05-04T19:49:33.284+0000] {processor.py:157} INFO - Started process (PID=3717) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:49:33.285+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:49:33.288+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:49:33.287+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:50:03.302+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:50:03.296+0000] {timeout.py:68} ERROR - Process timed out, PID: 3717
[2024-05-04T19:50:03.325+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:50:03.314+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3717

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3717
[2024-05-04T19:50:03.327+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:50:03.366+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.085 seconds
[2024-05-04T19:50:33.527+0000] {processor.py:157} INFO - Started process (PID=3753) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:50:33.527+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:50:33.529+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:50:33.529+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:51:03.535+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:51:03.531+0000] {timeout.py:68} ERROR - Process timed out, PID: 3753
[2024-05-04T19:51:03.551+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:51:03.541+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3753

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3753
[2024-05-04T19:51:03.553+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:51:03.589+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.068 seconds
[2024-05-04T19:51:34.083+0000] {processor.py:157} INFO - Started process (PID=3783) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:51:34.084+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:51:34.088+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:51:34.087+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:52:04.098+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:52:04.096+0000] {timeout.py:68} ERROR - Process timed out, PID: 3783
[2024-05-04T19:52:04.105+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:52:04.103+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3783

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3783
[2024-05-04T19:52:04.109+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:52:04.130+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.049 seconds
[2024-05-04T19:52:34.998+0000] {processor.py:157} INFO - Started process (PID=3819) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:52:35.000+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:52:35.004+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:52:35.003+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:53:05.012+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:53:05.011+0000] {timeout.py:68} ERROR - Process timed out, PID: 3819
[2024-05-04T19:53:05.020+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:53:05.014+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3819

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3819
[2024-05-04T19:53:05.021+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:53:05.048+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.057 seconds
[2024-05-04T19:53:35.126+0000] {processor.py:157} INFO - Started process (PID=3855) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:53:35.127+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:53:35.130+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:53:35.130+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:54:05.137+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:54:05.136+0000] {timeout.py:68} ERROR - Process timed out, PID: 3855
[2024-05-04T19:54:05.151+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:54:05.141+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3855

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3855
[2024-05-04T19:54:05.153+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:54:05.175+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.055 seconds
[2024-05-04T19:54:35.573+0000] {processor.py:157} INFO - Started process (PID=3891) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:54:35.575+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:54:35.578+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:54:35.578+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:55:05.589+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:55:05.585+0000] {timeout.py:68} ERROR - Process timed out, PID: 3891
[2024-05-04T19:55:05.606+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:55:05.600+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3891

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3891
[2024-05-04T19:55:05.607+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:55:05.624+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.056 seconds
[2024-05-04T19:55:35.787+0000] {processor.py:157} INFO - Started process (PID=3927) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:55:35.789+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:55:35.792+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:55:35.792+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:56:05.799+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:56:05.798+0000] {timeout.py:68} ERROR - Process timed out, PID: 3927
[2024-05-04T19:56:05.808+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:56:05.802+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3927

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3927
[2024-05-04T19:56:05.810+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:56:05.835+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.053 seconds
[2024-05-04T19:56:36.183+0000] {processor.py:157} INFO - Started process (PID=3962) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:56:36.184+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:56:36.189+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:56:36.188+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:57:06.198+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:57:06.194+0000] {timeout.py:68} ERROR - Process timed out, PID: 3962
[2024-05-04T19:57:06.215+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:57:06.204+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3962

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3962
[2024-05-04T19:57:06.223+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:57:06.263+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.087 seconds
[2024-05-04T19:57:36.573+0000] {processor.py:157} INFO - Started process (PID=3998) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:57:36.575+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:57:36.578+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:57:36.578+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:58:06.585+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:58:06.582+0000] {timeout.py:68} ERROR - Process timed out, PID: 3998
[2024-05-04T19:58:06.596+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:58:06.590+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3998

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 3998
[2024-05-04T19:58:06.598+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:58:06.626+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.058 seconds
[2024-05-04T19:58:36.718+0000] {processor.py:157} INFO - Started process (PID=4034) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:58:36.719+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:58:36.722+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:58:36.722+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T19:59:06.729+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:59:06.727+0000] {timeout.py:68} ERROR - Process timed out, PID: 4034
[2024-05-04T19:59:06.735+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:59:06.731+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4034

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4034
[2024-05-04T19:59:06.735+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T19:59:06.750+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.038 seconds
[2024-05-04T19:59:37.171+0000] {processor.py:157} INFO - Started process (PID=4070) to work on /opt/airflow/dags/train_model.py
[2024-05-04T19:59:37.173+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T19:59:37.177+0000] {logging_mixin.py:151} INFO - [2024-05-04T19:59:37.176+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T20:00:07.197+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:00:07.190+0000] {timeout.py:68} ERROR - Process timed out, PID: 4070
[2024-05-04T20:00:07.220+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:00:07.208+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4070

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4070
[2024-05-04T20:00:07.223+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T20:00:07.269+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.104 seconds
[2024-05-04T20:00:38.293+0000] {processor.py:157} INFO - Started process (PID=4106) to work on /opt/airflow/dags/train_model.py
[2024-05-04T20:00:38.294+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T20:00:38.297+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:00:38.297+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T20:01:08.309+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:01:08.304+0000] {timeout.py:68} ERROR - Process timed out, PID: 4106
[2024-05-04T20:01:08.326+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:01:08.313+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4106

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4106
[2024-05-04T20:01:08.329+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T20:01:08.360+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.072 seconds
[2024-05-04T20:01:38.443+0000] {processor.py:157} INFO - Started process (PID=4142) to work on /opt/airflow/dags/train_model.py
[2024-05-04T20:01:38.446+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T20:01:38.450+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:01:38.450+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T20:02:08.460+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:02:08.457+0000] {timeout.py:68} ERROR - Process timed out, PID: 4142
[2024-05-04T20:02:08.483+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:02:08.470+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4142

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4142
[2024-05-04T20:02:08.485+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T20:02:08.521+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.085 seconds
[2024-05-04T20:02:38.921+0000] {processor.py:157} INFO - Started process (PID=4178) to work on /opt/airflow/dags/train_model.py
[2024-05-04T20:02:38.923+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T20:02:38.926+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:02:38.926+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T20:03:08.944+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:03:08.942+0000] {timeout.py:68} ERROR - Process timed out, PID: 4178
[2024-05-04T20:03:08.957+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:03:08.950+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4178

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4178
[2024-05-04T20:03:08.959+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T20:03:08.988+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.072 seconds
[2024-05-04T20:03:39.405+0000] {processor.py:157} INFO - Started process (PID=4214) to work on /opt/airflow/dags/train_model.py
[2024-05-04T20:03:39.407+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T20:03:39.410+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:03:39.409+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T20:04:09.419+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:04:09.415+0000] {timeout.py:68} ERROR - Process timed out, PID: 4214
[2024-05-04T20:04:09.437+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:04:09.423+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4214

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4214
[2024-05-04T20:04:09.440+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T20:04:09.483+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.084 seconds
[2024-05-04T20:04:39.551+0000] {processor.py:157} INFO - Started process (PID=4250) to work on /opt/airflow/dags/train_model.py
[2024-05-04T20:04:39.551+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T20:04:39.553+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:04:39.553+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T20:05:09.566+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:05:09.558+0000] {timeout.py:68} ERROR - Process timed out, PID: 4250
[2024-05-04T20:05:09.583+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:05:09.572+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4250

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4250
[2024-05-04T20:05:09.586+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T20:05:09.619+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.071 seconds
[2024-05-04T20:05:39.789+0000] {processor.py:157} INFO - Started process (PID=4286) to work on /opt/airflow/dags/train_model.py
[2024-05-04T20:05:39.790+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T20:05:39.793+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:05:39.792+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T20:06:09.804+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:06:09.800+0000] {timeout.py:68} ERROR - Process timed out, PID: 4286
[2024-05-04T20:06:09.813+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:06:09.807+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4286

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4286
[2024-05-04T20:06:09.815+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T20:06:09.847+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.063 seconds
[2024-05-04T20:06:40.848+0000] {processor.py:157} INFO - Started process (PID=4323) to work on /opt/airflow/dags/train_model.py
[2024-05-04T20:06:40.848+0000] {processor.py:829} INFO - Processing file /opt/airflow/dags/train_model.py for tasks to queue
[2024-05-04T20:06:40.850+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:06:40.850+0000] {dagbag.py:539} INFO - Filling up the DagBag from /opt/airflow/dags/train_model.py
[2024-05-04T20:07:10.862+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:07:10.855+0000] {timeout.py:68} ERROR - Process timed out, PID: 4323
[2024-05-04T20:07:10.884+0000] {logging_mixin.py:151} INFO - [2024-05-04T20:07:10.866+0000] {dagbag.py:347} ERROR - Failed to import: /opt/airflow/dags/train_model.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 174, in http_request
    return _get_http_response_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 105, in _get_http_response_with_retries
    return session.request(method, url, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 415, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1256, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1302, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1251, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1011, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.8/http/client.py", line 951, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4323

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 343, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/train_model.py", line 41, in <module>
    mlflow.set_experiment("mlflow_tracking_examples")
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 113, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 461, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 220, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 304, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py", line 56, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 283, in call_endpoint
    response = http_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py", line 192, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://10.43.101.151:8087/api/2.0/mlflow/experiments/get-by-name failed with exception DagBag import timeout for /opt/airflow/dags/train_model.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.7.0/best-practices.html#reducing-dag-complexity, PID: 4323
[2024-05-04T20:07:10.888+0000] {processor.py:841} WARNING - No viable dags retrieved from /opt/airflow/dags/train_model.py
[2024-05-04T20:07:10.959+0000] {processor.py:179} INFO - Processing /opt/airflow/dags/train_model.py took 30.114 seconds
